"use strict";(()=>{var Ne=Object.create;var yt=Object.defineProperty;var Bt=Object.getOwnPropertyDescriptor;var we=Object.getOwnPropertyNames;var ve=Object.getPrototypeOf,Ae=Object.prototype.hasOwnProperty;var Ce=(o,t)=>()=>(t||o((t={exports:{}}).exports,t),t.exports);var Ee=(o,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of we(t))!Ae.call(o,n)&&n!==e&&yt(o,n,{get:()=>t[n],enumerable:!(i=Bt(t,n))||i.enumerable});return o};var Oe=(o,t,e)=>(e=o!=null?Ne(ve(o)):{},Ee(t||!o||!o.__esModule?yt(e,"default",{value:o,enumerable:!0}):e,o));var B=(o,t,e,i)=>{for(var n=i>1?void 0:i?Bt(t,e):t,a=o.length-1,s;a>=0;a--)(s=o[a])&&(n=(i?s(t,e,n):s(n))||n);return i&&n&&yt(t,e,n),n};var $t=Ce(()=>{var Ut;(function(o){(function(t){var e=typeof globalThis=="object"?globalThis:typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:m(),i=n(o);typeof e.Reflect<"u"&&(i=n(e.Reflect,i)),t(i,e),typeof e.Reflect>"u"&&(e.Reflect=o);function n(h,f){return function(S,N){Object.defineProperty(h,S,{configurable:!0,writable:!0,value:N}),f&&f(S,N)}}function a(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function m(){return a()||s()}})(function(t,e){var i=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",a=n&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=n&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",m=typeof Object.create=="function",h={__proto__:[]}instanceof Array,f=!m&&!h,S={create:m?function(){return dt(Object.create(null))}:h?function(){return dt({__proto__:null})}:function(){return dt({})},has:f?function(u,l){return i.call(u,l)}:function(u,l){return l in u},get:f?function(u,l){return i.call(u,l)?u[l]:void 0}:function(u,l){return u[l]}},N=Object.getPrototypeOf(Function),C=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:be(),T=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:de(),I=typeof WeakMap=="function"?WeakMap:ye(),w=n?Symbol.for("@reflect-metadata:registry"):void 0,V=he(),z=pe(V);function G(u,l,c,p){if(v(c)){if(!qt(u))throw new TypeError;if(!Pt(l))throw new TypeError;return oe(u,l)}else{if(!qt(u))throw new TypeError;if(!q(l))throw new TypeError;if(!q(p)&&!v(p)&&!et(p))throw new TypeError;return et(p)&&(p=void 0),c=Z(c),se(u,l,c,p)}}t("decorate",G);function j(u,l){function c(p,M){if(!q(p))throw new TypeError;if(!v(M)&&!fe(M))throw new TypeError;Ft(u,l,p,M)}return c}t("metadata",j);function R(u,l,c,p){if(!q(c))throw new TypeError;return v(p)||(p=Z(p)),Ft(u,l,c,p)}t("defineMetadata",R);function Y(u,l,c){if(!q(l))throw new TypeError;return v(c)||(c=Z(c)),Et(u,l,c)}t("hasMetadata",Y);function X(u,l,c){if(!q(l))throw new TypeError;return v(c)||(c=Z(c)),pt(u,l,c)}t("hasOwnMetadata",X);function te(u,l,c){if(!q(l))throw new TypeError;return v(c)||(c=Z(c)),Ot(u,l,c)}t("getMetadata",te);function ee(u,l,c){if(!q(l))throw new TypeError;return v(c)||(c=Z(c)),Vt(u,l,c)}t("getOwnMetadata",ee);function re(u,l){if(!q(u))throw new TypeError;return v(l)||(l=Z(l)),It(u,l)}t("getMetadataKeys",re);function ie(u,l){if(!q(u))throw new TypeError;return v(l)||(l=Z(l)),Tt(u,l)}t("getOwnMetadataKeys",ie);function ne(u,l,c){if(!q(l))throw new TypeError;if(v(c)||(c=Z(c)),!q(l))throw new TypeError;v(c)||(c=Z(c));var p=ut(l,c,!1);return v(p)?!1:p.OrdinaryDeleteMetadata(u,l,c)}t("deleteMetadata",ne);function oe(u,l){for(var c=u.length-1;c>=0;--c){var p=u[c],M=p(l);if(!v(M)&&!et(M)){if(!Pt(M))throw new TypeError;l=M}}return l}function se(u,l,c,p){for(var M=u.length-1;M>=0;--M){var P=u[M],D=P(l,c,p);if(!v(D)&&!et(D)){if(!q(D))throw new TypeError;p=D}}return p}function Et(u,l,c){var p=pt(u,l,c);if(p)return!0;var M=bt(l);return et(M)?!1:Et(u,M,c)}function pt(u,l,c){var p=ut(l,c,!1);return v(p)?!1:kt(p.OrdinaryHasOwnMetadata(u,l,c))}function Ot(u,l,c){var p=pt(u,l,c);if(p)return Vt(u,l,c);var M=bt(l);if(!et(M))return Ot(u,M,c)}function Vt(u,l,c){var p=ut(l,c,!1);if(!v(p))return p.OrdinaryGetOwnMetadata(u,l,c)}function Ft(u,l,c,p){var M=ut(c,p,!0);M.OrdinaryDefineOwnMetadata(u,l,c,p)}function It(u,l){var c=Tt(u,l),p=bt(u);if(p===null)return c;var M=It(p,l);if(M.length<=0)return c;if(c.length<=0)return M;for(var P=new T,D=[],E=0,g=c;E<g.length;E++){var d=g[E],b=P.has(d);b||(P.add(d),D.push(d))}for(var y=0,F=M;y<F.length;y++){var d=F[y],b=P.has(d);b||(P.add(d),D.push(d))}return D}function Tt(u,l){var c=ut(u,l,!1);return c?c.OrdinaryOwnMetadataKeys(u,l):[]}function xt(u){if(u===null)return 1;switch(typeof u){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return u===null?1:6;default:return 6}}function v(u){return u===void 0}function et(u){return u===null}function ae(u){return typeof u=="symbol"}function q(u){return typeof u=="object"?u!==null:typeof u=="function"}function ue(u,l){switch(xt(u)){case 0:return u;case 1:return u;case 2:return u;case 3:return u;case 4:return u;case 5:return u}var c=l===3?"string":l===5?"number":"default",p=Lt(u,a);if(p!==void 0){var M=p.call(u,c);if(q(M))throw new TypeError;return M}return le(u,c==="default"?"number":c)}function le(u,l){if(l==="string"){var c=u.toString;if(rt(c)){var p=c.call(u);if(!q(p))return p}var M=u.valueOf;if(rt(M)){var p=M.call(u);if(!q(p))return p}}else{var M=u.valueOf;if(rt(M)){var p=M.call(u);if(!q(p))return p}var P=u.toString;if(rt(P)){var p=P.call(u);if(!q(p))return p}}throw new TypeError}function kt(u){return!!u}function ce(u){return""+u}function Z(u){var l=ue(u,3);return ae(l)?l:ce(l)}function qt(u){return Array.isArray?Array.isArray(u):u instanceof Object?u instanceof Array:Object.prototype.toString.call(u)==="[object Array]"}function rt(u){return typeof u=="function"}function Pt(u){return typeof u=="function"}function fe(u){switch(xt(u)){case 3:return!0;case 4:return!0;default:return!1}}function gt(u,l){return u===l||u!==u&&l!==l}function Lt(u,l){var c=u[l];if(c!=null){if(!rt(c))throw new TypeError;return c}}function Rt(u){var l=Lt(u,s);if(!rt(l))throw new TypeError;var c=l.call(u);if(!q(c))throw new TypeError;return c}function zt(u){return u.value}function Dt(u){var l=u.next();return l.done?!1:l}function jt(u){var l=u.return;l&&l.call(u)}function bt(u){var l=Object.getPrototypeOf(u);if(typeof u!="function"||u===N||l!==N)return l;var c=u.prototype,p=c&&Object.getPrototypeOf(c);if(p==null||p===Object.prototype)return l;var M=p.constructor;return typeof M!="function"||M===u?l:M}function me(){var u;!v(w)&&typeof e.Reflect<"u"&&!(w in e.Reflect)&&typeof e.Reflect.defineMetadata=="function"&&(u=ge(e.Reflect));var l,c,p,M=new I,P={registerProvider:D,getProvider:g,setProvider:b};return P;function D(y){if(!Object.isExtensible(P))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case u===y:break;case v(l):l=y;break;case l===y:break;case v(c):c=y;break;case c===y:break;default:p===void 0&&(p=new T),p.add(y);break}}function E(y,F){if(!v(l)){if(l.isProviderFor(y,F))return l;if(!v(c)){if(c.isProviderFor(y,F))return l;if(!v(p))for(var x=Rt(p);;){var L=Dt(x);if(!L)return;var $=zt(L);if($.isProviderFor(y,F))return jt(x),$}}}if(!v(u)&&u.isProviderFor(y,F))return u}function g(y,F){var x=M.get(y),L;return v(x)||(L=x.get(F)),v(L)&&(L=E(y,F),v(L)||(v(x)&&(x=new C,M.set(y,x)),x.set(F,L))),L}function d(y){if(v(y))throw new TypeError;return l===y||c===y||!v(p)&&p.has(y)}function b(y,F,x){if(!d(x))throw new Error("Metadata provider not registered.");var L=g(y,F);if(L!==x){if(!v(L))return!1;var $=M.get(y);v($)&&($=new C,M.set(y,$)),$.set(F,x)}return!0}}function he(){var u;return!v(w)&&q(e.Reflect)&&Object.isExtensible(e.Reflect)&&(u=e.Reflect[w]),v(u)&&(u=me()),!v(w)&&q(e.Reflect)&&Object.isExtensible(e.Reflect)&&Object.defineProperty(e.Reflect,w,{enumerable:!1,configurable:!1,writable:!1,value:u}),u}function pe(u){var l=new I,c={isProviderFor:function(d,b){var y=l.get(d);return v(y)?!1:y.has(b)},OrdinaryDefineOwnMetadata:D,OrdinaryHasOwnMetadata:M,OrdinaryGetOwnMetadata:P,OrdinaryOwnMetadataKeys:E,OrdinaryDeleteMetadata:g};return V.registerProvider(c),c;function p(d,b,y){var F=l.get(d),x=!1;if(v(F)){if(!y)return;F=new C,l.set(d,F),x=!0}var L=F.get(b);if(v(L)){if(!y)return;if(L=new C,F.set(b,L),!u.setProvider(d,b,c))throw F.delete(b),x&&l.delete(d),new Error("Wrong provider for target.")}return L}function M(d,b,y){var F=p(b,y,!1);return v(F)?!1:kt(F.has(d))}function P(d,b,y){var F=p(b,y,!1);if(!v(F))return F.get(d)}function D(d,b,y,F){var x=p(y,F,!0);x.set(d,b)}function E(d,b){var y=[],F=p(d,b,!1);if(v(F))return y;for(var x=F.keys(),L=Rt(x),$=0;;){var Gt=Dt(L);if(!Gt)return y.length=$,y;var Se=zt(Gt);try{y[$]=Se}catch(Me){try{jt(L)}finally{throw Me}}$++}}function g(d,b,y){var F=p(b,y,!1);if(v(F)||!F.delete(d))return!1;if(F.size===0){var x=l.get(b);v(x)||(x.delete(y),x.size===0&&l.delete(x))}return!0}}function ge(u){var l=u.defineMetadata,c=u.hasOwnMetadata,p=u.getOwnMetadata,M=u.getOwnMetadataKeys,P=u.deleteMetadata,D=new I,E={isProviderFor:function(g,d){var b=D.get(g);return v(b)?M(g,d).length?(v(b)&&(b=new T,D.set(g,b)),b.add(d),!0):!1:b.has(d)},OrdinaryDefineOwnMetadata:l,OrdinaryHasOwnMetadata:c,OrdinaryGetOwnMetadata:p,OrdinaryOwnMetadataKeys:M,OrdinaryDeleteMetadata:P};return E}function ut(u,l,c){var p=V.getProvider(u,l);if(!v(p))return p;if(c){if(V.setProvider(u,l,z))return z;throw new Error("Illegal state.")}}function be(){var u={},l=[],c=function(){function E(g,d,b){this._index=0,this._keys=g,this._values=d,this._selector=b}return E.prototype["@@iterator"]=function(){return this},E.prototype[s]=function(){return this},E.prototype.next=function(){var g=this._index;if(g>=0&&g<this._keys.length){var d=this._selector(this._keys[g],this._values[g]);return g+1>=this._keys.length?(this._index=-1,this._keys=l,this._values=l):this._index++,{value:d,done:!1}}return{value:void 0,done:!0}},E.prototype.throw=function(g){throw this._index>=0&&(this._index=-1,this._keys=l,this._values=l),g},E.prototype.return=function(g){return this._index>=0&&(this._index=-1,this._keys=l,this._values=l),{value:g,done:!0}},E}(),p=function(){function E(){this._keys=[],this._values=[],this._cacheKey=u,this._cacheIndex=-2}return Object.defineProperty(E.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),E.prototype.has=function(g){return this._find(g,!1)>=0},E.prototype.get=function(g){var d=this._find(g,!1);return d>=0?this._values[d]:void 0},E.prototype.set=function(g,d){var b=this._find(g,!0);return this._values[b]=d,this},E.prototype.delete=function(g){var d=this._find(g,!1);if(d>=0){for(var b=this._keys.length,y=d+1;y<b;y++)this._keys[y-1]=this._keys[y],this._values[y-1]=this._values[y];return this._keys.length--,this._values.length--,gt(g,this._cacheKey)&&(this._cacheKey=u,this._cacheIndex=-2),!0}return!1},E.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=u,this._cacheIndex=-2},E.prototype.keys=function(){return new c(this._keys,this._values,M)},E.prototype.values=function(){return new c(this._keys,this._values,P)},E.prototype.entries=function(){return new c(this._keys,this._values,D)},E.prototype["@@iterator"]=function(){return this.entries()},E.prototype[s]=function(){return this.entries()},E.prototype._find=function(g,d){if(!gt(this._cacheKey,g)){this._cacheIndex=-1;for(var b=0;b<this._keys.length;b++)if(gt(this._keys[b],g)){this._cacheIndex=b;break}}return this._cacheIndex<0&&d&&(this._cacheIndex=this._keys.length,this._keys.push(g),this._values.push(void 0)),this._cacheIndex},E}();return p;function M(E,g){return E}function P(E,g){return g}function D(E,g){return[E,g]}}function de(){var u=function(){function l(){this._map=new C}return Object.defineProperty(l.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),l.prototype.has=function(c){return this._map.has(c)},l.prototype.add=function(c){return this._map.set(c,c),this},l.prototype.delete=function(c){return this._map.delete(c)},l.prototype.clear=function(){this._map.clear()},l.prototype.keys=function(){return this._map.keys()},l.prototype.values=function(){return this._map.keys()},l.prototype.entries=function(){return this._map.entries()},l.prototype["@@iterator"]=function(){return this.keys()},l.prototype[s]=function(){return this.keys()},l}();return u}function ye(){var u=16,l=S.create(),c=p();return function(){function g(){this._key=p()}return g.prototype.has=function(d){var b=M(d,!1);return b!==void 0?S.has(b,this._key):!1},g.prototype.get=function(d){var b=M(d,!1);return b!==void 0?S.get(b,this._key):void 0},g.prototype.set=function(d,b){var y=M(d,!0);return y[this._key]=b,this},g.prototype.delete=function(d){var b=M(d,!1);return b!==void 0?delete b[this._key]:!1},g.prototype.clear=function(){this._key=p()},g}();function p(){var g;do g="@@WeakMap@@"+E();while(S.has(l,g));return l[g]=!0,g}function M(g,d){if(!i.call(g,c)){if(!d)return;Object.defineProperty(g,c,{value:S.create()})}return g[c]}function P(g,d){for(var b=0;b<d;++b)g[b]=Math.random()*255|0;return g}function D(g){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(g)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(g)):P(new Uint8Array(g),g):P(new Array(g),g)}function E(){var g=D(u);g[6]=g[6]&79|64,g[8]=g[8]&191|128;for(var d="",b=0;b<u;++b){var y=g[b];(b===4||b===6||b===8)&&(d+="-"),y<16&&(d+="0"),d+=y.toString(16).toLowerCase()}return d}}function dt(u){return u.__=void 0,delete u.__,u}})})(Ut||(Ut={}))});var _r=Oe($t());var ct=class{constructor(t){this.map=new Map;this.first=void 0;this.last=void 0;this.maxSize=t}get size(){return this.map.size}get(t){let e=this.map.get(t);if(e!==void 0)return e!==this.first&&(e===this.last?(this.last=e.prev,this.last.next=void 0):(e.prev.next=e.next,e.next.prev=e.prev),e.next=this.first,this.first.prev=e,this.first=e),e.value}set(t,e){if(this.maxSize<1)return;if(this.map.has(t))throw new Error("Cannot update existing keys in the cache");let i=new St(t,e);for(this.first===void 0?(this.first=i,this.last=i):(i.next=this.first,this.first.prev=i,this.first=i),this.map.set(t,i);this.map.size>this.maxSize;){let n=this.last;this.map.delete(n.key),this.last=n.prev,this.last.next=void 0}}},St=class{constructor(t,e){this.next=void 0;this.prev=void 0;this.key=t,this.value=e}};var U;(function(o){o[o.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",o[o.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",o[o.CLASS_TO_CLASS=2]="CLASS_TO_CLASS"})(U||(U={}));var Zt=function(){function o(){this._typeMetadatas=new Map,this._transformMetadatas=new Map,this._exposeMetadatas=new Map,this._excludeMetadatas=new Map,this._ancestorsMap=new Map}return o.prototype.addTypeMetadata=function(t){this._typeMetadatas.has(t.target)||this._typeMetadatas.set(t.target,new Map),this._typeMetadatas.get(t.target).set(t.propertyName,t)},o.prototype.addTransformMetadata=function(t){this._transformMetadatas.has(t.target)||this._transformMetadatas.set(t.target,new Map),this._transformMetadatas.get(t.target).has(t.propertyName)||this._transformMetadatas.get(t.target).set(t.propertyName,[]),this._transformMetadatas.get(t.target).get(t.propertyName).push(t)},o.prototype.addExposeMetadata=function(t){this._exposeMetadatas.has(t.target)||this._exposeMetadatas.set(t.target,new Map),this._exposeMetadatas.get(t.target).set(t.propertyName,t)},o.prototype.addExcludeMetadata=function(t){this._excludeMetadatas.has(t.target)||this._excludeMetadatas.set(t.target,new Map),this._excludeMetadatas.get(t.target).set(t.propertyName,t)},o.prototype.findTransformMetadatas=function(t,e,i){return this.findMetadatas(this._transformMetadatas,t,e).filter(function(n){return!n.options||n.options.toClassOnly===!0&&n.options.toPlainOnly===!0?!0:n.options.toClassOnly===!0?i===U.CLASS_TO_CLASS||i===U.PLAIN_TO_CLASS:n.options.toPlainOnly===!0?i===U.CLASS_TO_PLAIN:!0})},o.prototype.findExcludeMetadata=function(t,e){return this.findMetadata(this._excludeMetadatas,t,e)},o.prototype.findExposeMetadata=function(t,e){return this.findMetadata(this._exposeMetadatas,t,e)},o.prototype.findExposeMetadataByCustomName=function(t,e){return this.getExposedMetadatas(t).find(function(i){return i.options&&i.options.name===e})},o.prototype.findTypeMetadata=function(t,e){return this.findMetadata(this._typeMetadatas,t,e)},o.prototype.getStrategy=function(t){var e=this._excludeMetadatas.get(t),i=e&&e.get(void 0),n=this._exposeMetadatas.get(t),a=n&&n.get(void 0);return i&&a||!i&&!a?"none":i?"excludeAll":"exposeAll"},o.prototype.getExposedMetadatas=function(t){return this.getMetadata(this._exposeMetadatas,t)},o.prototype.getExcludedMetadatas=function(t){return this.getMetadata(this._excludeMetadatas,t)},o.prototype.getExposedProperties=function(t,e){return this.getExposedMetadatas(t).filter(function(i){return!i.options||i.options.toClassOnly===!0&&i.options.toPlainOnly===!0?!0:i.options.toClassOnly===!0?e===U.CLASS_TO_CLASS||e===U.PLAIN_TO_CLASS:i.options.toPlainOnly===!0?e===U.CLASS_TO_PLAIN:!0}).map(function(i){return i.propertyName})},o.prototype.getExcludedProperties=function(t,e){return this.getExcludedMetadatas(t).filter(function(i){return!i.options||i.options.toClassOnly===!0&&i.options.toPlainOnly===!0?!0:i.options.toClassOnly===!0?e===U.CLASS_TO_CLASS||e===U.PLAIN_TO_CLASS:i.options.toPlainOnly===!0?e===U.CLASS_TO_PLAIN:!0}).map(function(i){return i.propertyName})},o.prototype.clear=function(){this._typeMetadatas.clear(),this._exposeMetadatas.clear(),this._excludeMetadatas.clear(),this._ancestorsMap.clear()},o.prototype.getMetadata=function(t,e){var i=t.get(e),n;i&&(n=Array.from(i.values()).filter(function(N){return N.propertyName!==void 0}));for(var a=[],s=0,m=this.getAncestors(e);s<m.length;s++){var h=m[s],f=t.get(h);if(f){var S=Array.from(f.values()).filter(function(N){return N.propertyName!==void 0});a.push.apply(a,S)}}return a.concat(n||[])},o.prototype.findMetadata=function(t,e,i){var n=t.get(e);if(n){var a=n.get(i);if(a)return a}for(var s=0,m=this.getAncestors(e);s<m.length;s++){var h=m[s],f=t.get(h);if(f){var S=f.get(i);if(S)return S}}},o.prototype.findMetadatas=function(t,e,i){var n=t.get(e),a;n&&(a=n.get(i));for(var s=[],m=0,h=this.getAncestors(e);m<h.length;m++){var f=h[m],S=t.get(f);S&&S.has(i)&&s.push.apply(s,S.get(i))}return s.slice().reverse().concat((a||[]).slice().reverse())},o.prototype.getAncestors=function(t){if(!t)return[];if(!this._ancestorsMap.has(t)){for(var e=[],i=Object.getPrototypeOf(t.prototype.constructor);typeof i.prototype<"u";i=Object.getPrototypeOf(i.prototype.constructor))e.push(i);this._ancestorsMap.set(t,e)}return this._ancestorsMap.get(t)},o}();var it=new Zt;function _t(o){return o===void 0&&(o={}),function(t,e){it.addExcludeMetadata({target:t instanceof Function?t:t.constructor,propertyName:e,options:o})}}function nt(o){return o===void 0&&(o={}),function(t,e){it.addExposeMetadata({target:t instanceof Function?t:t.constructor,propertyName:e,options:o})}}function ot(o,t){return t===void 0&&(t={}),function(e,i){var n=Reflect.getMetadata("design:type",e,i);it.addTypeMetadata({target:e.constructor,propertyName:i,reflectedType:n,typeFunction:o,options:t})}}var Mt=17,Ve=9e15,Fe=Math.log10(9e15),Ie=1/9e15,Te=308,xe=-324,Ht=5,ke=1023,qe=!0,Pe=!1,Le=function(){let o=[];for(let e=xe+1;e<=Te;e++)o.push(+("1e"+e));let t=323;return function(e){return o[e+t]}}(),W=[2,Math.E,3,4,5,6,7,8,9,10],Re=[[1,1.0891180521811203,1.1789767925673957,1.2701455431742086,1.3632090180450092,1.4587818160364217,1.5575237916251419,1.6601571006859253,1.767485818836978,1.8804192098842727,2],[1,1.1121114330934079,1.231038924931609,1.3583836963111375,1.4960519303993531,1.6463542337511945,1.8121385357018724,1.996971324618307,2.2053895545527546,2.4432574483385254,Math.E],[1,1.1187738849693603,1.2464963939368214,1.38527004705667,1.5376664685821402,1.7068895236551784,1.897001227148399,2.1132403089001035,2.362480153784171,2.6539010333870774,3],[1,1.1367350847096405,1.2889510672956703,1.4606478703324786,1.6570295196661111,1.8850062585672889,2.1539465047453485,2.476829779693097,2.872061932789197,3.3664204535587183,4],[1,1.1494592900767588,1.319708228183931,1.5166291280087583,1.748171114438024,2.0253263297298045,2.3636668498288547,2.7858359149579424,3.3257226212448145,4.035730287722532,5],[1,1.159225940787673,1.343712473580932,1.5611293155111927,1.8221199554561318,2.14183924486326,2.542468319282638,3.0574682501653316,3.7390572020926873,4.6719550537360774,6],[1,1.1670905356972596,1.3632807444991446,1.5979222279405536,1.8842640123816674,2.2416069644878687,2.69893426559423,3.3012632110403577,4.121250340630164,5.281493033448316,7],[1,1.1736630594087796,1.379783782386201,1.6292821855668218,1.9378971836180754,2.3289975651071977,2.8384347394720835,3.5232708454565906,4.478242031114584,5.868592169644505,8],[1,1.1793017514670474,1.394054150657457,1.65664127441059,1.985170999970283,2.4069682290577457,2.9647310119960752,3.7278665320924946,4.814462547283592,6.436522247411611,9],[1,1.1840100246247336,1.4061375836156955,1.6802272208863964,2.026757028388619,2.4770056063449646,3.080525271755482,3.9191964192627284,5.135152840833187,6.989961179534715,10]],ze=[[-1,-.9194161097107025,-.8335625019330468,-.7425599821143978,-.6466611521029437,-.5462617907227869,-.4419033816638769,-.3342645487554494,-.224140440909962,-.11241087890006762,0],[-1,-.90603157029014,-.80786507256596,-.7064666939634,-.60294836853664,-.49849837513117,-.39430303318768,-.29147201034755,-.19097820800866,-.09361896280296,0],[-1,-.9021579584316141,-.8005762598234203,-.6964780623319391,-.5911906810998454,-.486050182576545,-.3823089430815083,-.28106046722897615,-.1831906535795894,-.08935809204418144,0],[-1,-.8917227442365535,-.781258746326964,-.6705130326902455,-.5612813129406509,-.4551067709033134,-.35319256652135966,-.2563741554088552,-.1651412821106526,-.0796919581982668,0],[-1,-.8843387974366064,-.7678744063886243,-.6529563724510552,-.5415870994657841,-.4352842206588936,-.33504449124791424,-.24138853420685147,-.15445285440944467,-.07409659641336663,0],[-1,-.8786709358426346,-.7577735191184886,-.6399546189952064,-.527284921869926,-.4211627631006314,-.3223479611761232,-.23107655627789858,-.1472057700818259,-.07035171210706326,0],[-1,-.8740862815291583,-.7497032990976209,-.6297119746181752,-.5161838335958787,-.41036238255751956,-.31277212146489963,-.2233976621705518,-.1418697367979619,-.06762117662323441,0],[-1,-.8702632331800649,-.7430366914122081,-.6213373075161548,-.5072025698095242,-.40171437727184167,-.30517930701410456,-.21736343968190863,-.137710238299109,-.06550774483471955,0],[-1,-.8670016295947213,-.7373984232432306,-.6143173985094293,-.49973884395492807,-.394584953527678,-.2989649949848695,-.21245647317021688,-.13434688362382652,-.0638072667348083,0],[-1,-.8641642839543857,-.732534623168535,-.6083127477059322,-.4934049257184696,-.3885773075899922,-.29376029055315767,-.2083678561173622,-.13155653399373268,-.062401588652553186,0]],_=function(t,e){let i=e+1,n=Math.ceil(Math.log10(Math.abs(t))),a=Math.round(t*Math.pow(10,i-n))*Math.pow(10,n-i);return parseFloat(a.toFixed(Math.max(i-n,0)))},Nt=function(o){return Math.sign(o)*Math.log10(Math.abs(o))},De=function(o){if(!isFinite(o))return o;if(o<-50)return o===Math.trunc(o)?Number.NEGATIVE_INFINITY:0;let t=1;for(;o<10;)t=t*o,++o;o-=1;let e=.9189385332046727;e=e+(o+.5)*Math.log(o),e=e-o;let i=o*o,n=o;return e=e+1/(12*n),n=n*i,e=e+1/(360*n),n=n*i,e=e+1/(1260*n),n=n*i,e=e+1/(1680*n),n=n*i,e=e+1/(1188*n),n=n*i,e=e+691/(360360*n),n=n*i,e=e+7/(1092*n),n=n*i,e=e+3617/(122400*n),Math.exp(e)/t};var je=.36787944117144233,Qt=.5671432904097838,Yt=function(o,t=1e-10){let e,i;if(!Number.isFinite(o)||o===0)return o;if(o===1)return Qt;o<10?e=0:e=Math.log(o)-Math.log(Math.log(o));for(let n=0;n<100;++n){if(i=(o*Math.exp(-e)+e*e)/(e+1),Math.abs(i-e)<t*Math.abs(i))return i;e=i}throw Error(`Iteration failed to converge: ${o.toString()}`)};function Xt(o,t=1e-10){let e,i,n,a;if(!Number.isFinite(o.mag)||o.eq(r.dZero))return o;if(o.eq(r.dOne))return r.fromNumber(Qt);e=r.ln(o);for(let s=0;s<100;++s){if(i=e.neg().exp(),n=e.sub(o.mul(i)),a=e.sub(n.div(e.add(1).sub(e.add(2).mul(n).div(r.mul(2,e).add(2))))),r.abs(a.sub(e)).lt(r.abs(a).mul(t)))return a;e=a}throw Error(`Iteration failed to converge: ${o.toString()}`)}var r=class{constructor(t){this.sign=0;this.mag=0;this.layer=0;t instanceof r?this.fromDecimal(t):typeof t=="number"?this.fromNumber(t):typeof t=="string"&&this.fromString(t)}get m(){if(this.sign===0)return 0;if(this.layer===0){let t=Math.floor(Math.log10(this.mag)),e;return this.mag===5e-324?e=5:e=this.mag/Le(t),this.sign*e}else if(this.layer===1){let t=this.mag-Math.floor(this.mag);return this.sign*Math.pow(10,t)}else return this.sign}set m(t){this.layer<=2?this.fromMantissaExponent(t,this.e):(this.sign=Math.sign(t),this.sign===0&&(this.layer=0,this.exponent=0))}get e(){return this.sign===0?0:this.layer===0?Math.floor(Math.log10(this.mag)):this.layer===1?Math.floor(this.mag):this.layer===2?Math.floor(Math.sign(this.mag)*Math.pow(10,Math.abs(this.mag))):this.mag*Number.POSITIVE_INFINITY}set e(t){this.fromMantissaExponent(this.m,t)}get s(){return this.sign}set s(t){t===0?(this.sign=0,this.layer=0,this.mag=0):this.sign=t}get mantissa(){return this.m}set mantissa(t){this.m=t}get exponent(){return this.e}set exponent(t){this.e=t}static fromComponents(t,e,i){return new r().fromComponents(t,e,i)}static fromComponents_noNormalize(t,e,i){return new r().fromComponents_noNormalize(t,e,i)}static fromMantissaExponent(t,e){return new r().fromMantissaExponent(t,e)}static fromMantissaExponent_noNormalize(t,e){return new r().fromMantissaExponent_noNormalize(t,e)}static fromDecimal(t){return new r().fromDecimal(t)}static fromNumber(t){return new r().fromNumber(t)}static fromString(t){return new r().fromString(t)}static fromValue(t){return new r().fromValue(t)}static fromValue_noAlloc(t){if(t instanceof r)return t;if(typeof t=="string"){let e=r.fromStringCache.get(t);return e!==void 0?e:r.fromString(t)}else return typeof t=="number"?r.fromNumber(t):r.dZero}static abs(t){return r.fromValue_noAlloc(t).abs()}static neg(t){return r.fromValue_noAlloc(t).neg()}static negate(t){return r.fromValue_noAlloc(t).neg()}static negated(t){return r.fromValue_noAlloc(t).neg()}static sign(t){return r.fromValue_noAlloc(t).sign}static sgn(t){return r.fromValue_noAlloc(t).sign}static round(t){return r.fromValue_noAlloc(t).round()}static floor(t){return r.fromValue_noAlloc(t).floor()}static ceil(t){return r.fromValue_noAlloc(t).ceil()}static trunc(t){return r.fromValue_noAlloc(t).trunc()}static add(t,e){return r.fromValue_noAlloc(t).add(e)}static plus(t,e){return r.fromValue_noAlloc(t).add(e)}static sub(t,e){return r.fromValue_noAlloc(t).sub(e)}static subtract(t,e){return r.fromValue_noAlloc(t).sub(e)}static minus(t,e){return r.fromValue_noAlloc(t).sub(e)}static mul(t,e){return r.fromValue_noAlloc(t).mul(e)}static multiply(t,e){return r.fromValue_noAlloc(t).mul(e)}static times(t,e){return r.fromValue_noAlloc(t).mul(e)}static div(t,e){return r.fromValue_noAlloc(t).div(e)}static divide(t,e){return r.fromValue_noAlloc(t).div(e)}static recip(t){return r.fromValue_noAlloc(t).recip()}static reciprocal(t){return r.fromValue_noAlloc(t).recip()}static reciprocate(t){return r.fromValue_noAlloc(t).reciprocate()}static mod(t,e){return r.fromValue_noAlloc(t).mod(e)}static modulo(t,e){return r.fromValue_noAlloc(t).modulo(e)}static modular(t,e){return r.fromValue_noAlloc(t).modular(e)}static cmp(t,e){return r.fromValue_noAlloc(t).cmp(e)}static cmpabs(t,e){return r.fromValue_noAlloc(t).cmpabs(e)}static compare(t,e){return r.fromValue_noAlloc(t).cmp(e)}static isNaN(t){return t=r.fromValue_noAlloc(t),isNaN(t.sign)||isNaN(t.layer)||isNaN(t.mag)}static isFinite(t){return t=r.fromValue_noAlloc(t),isFinite(t.sign)&&isFinite(t.layer)&&isFinite(t.mag)}static eq(t,e){return r.fromValue_noAlloc(t).eq(e)}static equals(t,e){return r.fromValue_noAlloc(t).eq(e)}static neq(t,e){return r.fromValue_noAlloc(t).neq(e)}static notEquals(t,e){return r.fromValue_noAlloc(t).notEquals(e)}static lt(t,e){return r.fromValue_noAlloc(t).lt(e)}static lte(t,e){return r.fromValue_noAlloc(t).lte(e)}static gt(t,e){return r.fromValue_noAlloc(t).gt(e)}static gte(t,e){return r.fromValue_noAlloc(t).gte(e)}static max(t,e){return r.fromValue_noAlloc(t).max(e)}static min(t,e){return r.fromValue_noAlloc(t).min(e)}static minabs(t,e){return r.fromValue_noAlloc(t).minabs(e)}static maxabs(t,e){return r.fromValue_noAlloc(t).maxabs(e)}static clamp(t,e,i){return r.fromValue_noAlloc(t).clamp(e,i)}static clampMin(t,e){return r.fromValue_noAlloc(t).clampMin(e)}static clampMax(t,e){return r.fromValue_noAlloc(t).clampMax(e)}static cmp_tolerance(t,e,i){return r.fromValue_noAlloc(t).cmp_tolerance(e,i)}static compare_tolerance(t,e,i){return r.fromValue_noAlloc(t).cmp_tolerance(e,i)}static eq_tolerance(t,e,i){return r.fromValue_noAlloc(t).eq_tolerance(e,i)}static equals_tolerance(t,e,i){return r.fromValue_noAlloc(t).eq_tolerance(e,i)}static neq_tolerance(t,e,i){return r.fromValue_noAlloc(t).neq_tolerance(e,i)}static notEquals_tolerance(t,e,i){return r.fromValue_noAlloc(t).notEquals_tolerance(e,i)}static lt_tolerance(t,e,i){return r.fromValue_noAlloc(t).lt_tolerance(e,i)}static lte_tolerance(t,e,i){return r.fromValue_noAlloc(t).lte_tolerance(e,i)}static gt_tolerance(t,e,i){return r.fromValue_noAlloc(t).gt_tolerance(e,i)}static gte_tolerance(t,e,i){return r.fromValue_noAlloc(t).gte_tolerance(e,i)}static pLog10(t){return r.fromValue_noAlloc(t).pLog10()}static absLog10(t){return r.fromValue_noAlloc(t).absLog10()}static log10(t){return r.fromValue_noAlloc(t).log10()}static log(t,e){return r.fromValue_noAlloc(t).log(e)}static log2(t){return r.fromValue_noAlloc(t).log2()}static ln(t){return r.fromValue_noAlloc(t).ln()}static logarithm(t,e){return r.fromValue_noAlloc(t).logarithm(e)}static pow(t,e){return r.fromValue_noAlloc(t).pow(e)}static pow10(t){return r.fromValue_noAlloc(t).pow10()}static root(t,e){return r.fromValue_noAlloc(t).root(e)}static factorial(t,e){return r.fromValue_noAlloc(t).factorial()}static gamma(t,e){return r.fromValue_noAlloc(t).gamma()}static lngamma(t,e){return r.fromValue_noAlloc(t).lngamma()}static exp(t){return r.fromValue_noAlloc(t).exp()}static sqr(t){return r.fromValue_noAlloc(t).sqr()}static sqrt(t){return r.fromValue_noAlloc(t).sqrt()}static cube(t){return r.fromValue_noAlloc(t).cube()}static cbrt(t){return r.fromValue_noAlloc(t).cbrt()}static tetrate(t,e=2,i=r.fromComponents_noNormalize(1,0,1),n=!1){return r.fromValue_noAlloc(t).tetrate(e,i,n)}static iteratedexp(t,e=2,i=r.fromComponents_noNormalize(1,0,1),n=!1){return r.fromValue_noAlloc(t).iteratedexp(e,i,n)}static iteratedlog(t,e=10,i=1,n=!1){return r.fromValue_noAlloc(t).iteratedlog(e,i,n)}static layeradd10(t,e,i=!1){return r.fromValue_noAlloc(t).layeradd10(e,i)}static layeradd(t,e,i=10,n=!1){return r.fromValue_noAlloc(t).layeradd(e,i,n)}static slog(t,e=10,i=!1){return r.fromValue_noAlloc(t).slog(e,100,i)}static lambertw(t){return r.fromValue_noAlloc(t).lambertw()}static ssqrt(t){return r.fromValue_noAlloc(t).ssqrt()}static linear_sroot(t,e){return r.fromValue_noAlloc(t).linear_sroot(e)}static pentate(t,e=2,i=r.fromComponents_noNormalize(1,0,1),n=!1){return r.fromValue_noAlloc(t).pentate(e,i,n)}static affordGeometricSeries(t,e,i,n){return this.affordGeometricSeries_core(r.fromValue_noAlloc(t),r.fromValue_noAlloc(e),r.fromValue_noAlloc(i),n)}static sumGeometricSeries(t,e,i,n){return this.sumGeometricSeries_core(t,r.fromValue_noAlloc(e),r.fromValue_noAlloc(i),n)}static affordArithmeticSeries(t,e,i,n){return this.affordArithmeticSeries_core(r.fromValue_noAlloc(t),r.fromValue_noAlloc(e),r.fromValue_noAlloc(i),r.fromValue_noAlloc(n))}static sumArithmeticSeries(t,e,i,n){return this.sumArithmeticSeries_core(r.fromValue_noAlloc(t),r.fromValue_noAlloc(e),r.fromValue_noAlloc(i),r.fromValue_noAlloc(n))}static efficiencyOfPurchase(t,e,i){return this.efficiencyOfPurchase_core(r.fromValue_noAlloc(t),r.fromValue_noAlloc(e),r.fromValue_noAlloc(i))}static randomDecimalForTesting(t){if(Math.random()*20<1)return r.fromComponents_noNormalize(0,0,0);let e=Math.random()>.5?1:-1;if(Math.random()*20<1)return r.fromComponents_noNormalize(e,0,1);let i=Math.floor(Math.random()*(t+1)),n=i===0?Math.random()*616-308:Math.random()*16;Math.random()>.9&&(n=Math.trunc(n));let a=Math.pow(10,n);return Math.random()>.9&&(a=Math.trunc(a)),r.fromComponents(e,i,a)}static affordGeometricSeries_core(t,e,i,n){let a=e.mul(i.pow(n));return r.floor(t.div(a).mul(i.sub(1)).add(1).log10().div(i.log10()))}static sumGeometricSeries_core(t,e,i,n){return e.mul(i.pow(n)).mul(r.sub(1,i.pow(t))).div(r.sub(1,i))}static affordArithmeticSeries_core(t,e,i,n){let s=e.add(n.mul(i)).sub(i.div(2)),m=s.pow(2);return s.neg().add(m.add(i.mul(t).mul(2)).sqrt()).div(i).floor()}static sumArithmeticSeries_core(t,e,i,n){let a=e.add(n.mul(i));return t.div(2).mul(a.mul(2).plus(t.sub(1).mul(i)))}static efficiencyOfPurchase_core(t,e,i){return t.div(e).add(t.div(i))}normalize(){if(this.sign===0||this.mag===0&&this.layer===0)return this.sign=0,this.mag=0,this.layer=0,this;if(this.layer===0&&this.mag<0&&(this.mag=-this.mag,this.sign=-this.sign),this.layer===0&&this.mag<Ie)return this.layer+=1,this.mag=Math.log10(this.mag),this;let t=Math.abs(this.mag),e=Math.sign(this.mag);if(t>=Ve)return this.layer+=1,this.mag=e*Math.log10(t),this;for(;t<Fe&&this.layer>0;)this.layer-=1,this.layer===0?this.mag=Math.pow(10,this.mag):(this.mag=e*Math.pow(10,t),t=Math.abs(this.mag),e=Math.sign(this.mag));return this.layer===0&&(this.mag<0?(this.mag=-this.mag,this.sign=-this.sign):this.mag===0&&(this.sign=0)),this}fromComponents(t,e,i){return this.sign=t,this.layer=e,this.mag=i,this.normalize(),this}fromComponents_noNormalize(t,e,i){return this.sign=t,this.layer=e,this.mag=i,this}fromMantissaExponent(t,e){return this.layer=1,this.sign=Math.sign(t),t=Math.abs(t),this.mag=e+Math.log10(t),this.normalize(),this}fromMantissaExponent_noNormalize(t,e){return this.fromMantissaExponent(t,e),this}fromDecimal(t){return this.sign=t.sign,this.layer=t.layer,this.mag=t.mag,this}fromNumber(t){return this.mag=Math.abs(t),this.sign=Math.sign(t),this.layer=0,this.normalize(),this}fromString(t){let e=t,i=r.fromStringCache.get(e);if(i!==void 0)return this.fromDecimal(i);qe?t=t.replace(",",""):Pe&&(t=t.replace(",","."));let n=t.split("^^^");if(n.length===2){let w=parseFloat(n[0]),V=parseFloat(n[1]),z=n[1].split(";"),G=1;if(z.length===2&&(G=parseFloat(z[1]),isFinite(G)||(G=1)),isFinite(w)&&isFinite(V)){let j=r.pentate(w,V,G);return this.sign=j.sign,this.layer=j.layer,this.mag=j.mag,r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this}}let a=t.split("^^");if(a.length===2){let w=parseFloat(a[0]),V=parseFloat(a[1]),z=a[1].split(";"),G=1;if(z.length===2&&(G=parseFloat(z[1]),isFinite(G)||(G=1)),isFinite(w)&&isFinite(V)){let j=r.tetrate(w,V,G);return this.sign=j.sign,this.layer=j.layer,this.mag=j.mag,r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this}}let s=t.split("^");if(s.length===2){let w=parseFloat(s[0]),V=parseFloat(s[1]);if(isFinite(w)&&isFinite(V)){let z=r.pow(w,V);return this.sign=z.sign,this.layer=z.layer,this.mag=z.mag,r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this}}t=t.trim().toLowerCase();let m,h,f=t.split("pt");if(f.length===2){m=10,h=parseFloat(f[0]),f[1]=f[1].replace("(",""),f[1]=f[1].replace(")","");let w=parseFloat(f[1]);if(isFinite(w)||(w=1),isFinite(m)&&isFinite(h)){let V=r.tetrate(m,h,w);return this.sign=V.sign,this.layer=V.layer,this.mag=V.mag,r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this}}if(f=t.split("p"),f.length===2){m=10,h=parseFloat(f[0]),f[1]=f[1].replace("(",""),f[1]=f[1].replace(")","");let w=parseFloat(f[1]);if(isFinite(w)||(w=1),isFinite(m)&&isFinite(h)){let V=r.tetrate(m,h,w);return this.sign=V.sign,this.layer=V.layer,this.mag=V.mag,r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this}}if(f=t.split("f"),f.length===2){m=10,f[0]=f[0].replace("(",""),f[0]=f[0].replace(")","");let w=parseFloat(f[0]);if(f[1]=f[1].replace("(",""),f[1]=f[1].replace(")",""),h=parseFloat(f[1]),isFinite(w)||(w=1),isFinite(m)&&isFinite(h)){let V=r.tetrate(m,h,w);return this.sign=V.sign,this.layer=V.layer,this.mag=V.mag,r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this}}let S=t.split("e"),N=S.length-1;if(N===0){let w=parseFloat(t);if(isFinite(w))return this.fromNumber(w),r.fromStringCache.size>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this}else if(N===1){let w=parseFloat(t);if(isFinite(w)&&w!==0)return this.fromNumber(w),r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this}let C=t.split("e^");if(C.length===2){this.sign=1,C[0].charAt(0)=="-"&&(this.sign=-1);let w="";for(let V=0;V<C[1].length;++V){let z=C[1].charCodeAt(V);if(z>=43&&z<=57||z===101)w+=C[1].charAt(V);else return this.layer=parseFloat(w),this.mag=parseFloat(C[1].substr(V+1)),this.normalize(),r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this}}if(N<1)return this.sign=0,this.layer=0,this.mag=0,r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this;let T=parseFloat(S[0]);if(T===0)return this.sign=0,this.layer=0,this.mag=0,r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this;let I=parseFloat(S[S.length-1]);if(N>=2){let w=parseFloat(S[S.length-2]);isFinite(w)&&(I*=Math.sign(w),I+=Nt(w))}if(!isFinite(T))this.sign=S[0]==="-"?-1:1,this.layer=N,this.mag=I;else if(N===1)this.sign=Math.sign(T),this.layer=1,this.mag=I+Math.log10(Math.abs(T));else if(this.sign=Math.sign(T),this.layer=N,N===2){let w=r.mul(r.fromComponents(1,2,I),r.fromValue_noAlloc(T));return this.sign=w.sign,this.layer=w.layer,this.mag=w.mag,r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this}else this.mag=I;return this.normalize(),r.fromStringCache.maxSize>=1&&r.fromStringCache.set(e,r.fromDecimal(this)),this}fromValue(t){return t instanceof r?this.fromDecimal(t):typeof t=="number"?this.fromNumber(t):typeof t=="string"?this.fromString(t):(this.sign=0,this.layer=0,this.mag=0,this)}toNumber(){return Number.isFinite(this.layer)?this.layer===0?this.sign*this.mag:this.layer===1?this.sign*Math.pow(10,this.mag):this.mag>0?this.sign>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:0:Number.NaN}mantissaWithDecimalPlaces(t){return isNaN(this.m)?Number.NaN:this.m===0?0:_(this.m,t)}magnitudeWithDecimalPlaces(t){return isNaN(this.mag)?Number.NaN:this.mag===0?0:_(this.mag,t)}toString(){return isNaN(this.layer)||isNaN(this.sign)||isNaN(this.mag)?"NaN":this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY?this.sign===1?"Infinity":"-Infinity":this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toString():this.m+"e"+this.e:this.layer===1?this.m+"e"+this.e:this.layer<=Ht?(this.sign===-1?"-":"")+"e".repeat(this.layer)+this.mag:(this.sign===-1?"-":"")+"(e^"+this.layer+")"+this.mag}toExponential(t){return this.layer===0?(this.sign*this.mag).toExponential(t):this.toStringWithDecimalPlaces(t)}toFixed(t){return this.layer===0?(this.sign*this.mag).toFixed(t):this.toStringWithDecimalPlaces(t)}toPrecision(t){return this.e<=-7?this.toExponential(t-1):t>this.e?this.toFixed(t-this.exponent-1):this.toExponential(t-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(t){return this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toFixed(t):_(this.m,t)+"e"+_(this.e,t):this.layer===1?_(this.m,t)+"e"+_(this.e,t):this.layer<=Ht?(this.sign===-1?"-":"")+"e".repeat(this.layer)+_(this.mag,t):(this.sign===-1?"-":"")+"(e^"+this.layer+")"+_(this.mag,t)}abs(){return r.fromComponents_noNormalize(this.sign===0?0:1,this.layer,this.mag)}neg(){return r.fromComponents_noNormalize(-this.sign,this.layer,this.mag)}negate(){return this.neg()}negated(){return this.neg()}sgn(){return this.sign}round(){return this.mag<0?r.dZero:this.layer===0?r.fromComponents(this.sign,0,Math.round(this.mag)):this}floor(){return this.mag<0?r.dZero:this.layer===0?r.fromComponents(this.sign,0,Math.floor(this.mag)):this}ceil(){return this.mag<0?r.dZero:this.layer===0?r.fromComponents(this.sign,0,Math.ceil(this.mag)):this}trunc(){return this.mag<0?r.dZero:this.layer===0?r.fromComponents(this.sign,0,Math.trunc(this.mag)):this}add(t){let e=r.fromValue_noAlloc(t);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(e.layer)||this.sign===0)return e;if(e.sign===0)return this;if(this.sign===-e.sign&&this.layer===e.layer&&this.mag===e.mag)return r.fromComponents_noNormalize(0,0,0);let i,n;if(this.layer>=2||e.layer>=2)return this.maxabs(e);if(r.cmpabs(this,e)>0?(i=this,n=e):(i=e,n=this),i.layer===0&&n.layer===0)return r.fromNumber(i.sign*i.mag+n.sign*n.mag);let a=i.layer*Math.sign(i.mag),s=n.layer*Math.sign(n.mag);if(a-s>=2)return i;if(a===0&&s===-1){if(Math.abs(n.mag-Math.log10(i.mag))>Mt)return i;{let m=Math.pow(10,Math.log10(i.mag)-n.mag),h=n.sign+i.sign*m;return r.fromComponents(Math.sign(h),1,n.mag+Math.log10(Math.abs(h)))}}if(a===1&&s===0){if(Math.abs(i.mag-Math.log10(n.mag))>Mt)return i;{let m=Math.pow(10,i.mag-Math.log10(n.mag)),h=n.sign+i.sign*m;return r.fromComponents(Math.sign(h),1,Math.log10(n.mag)+Math.log10(Math.abs(h)))}}if(Math.abs(i.mag-n.mag)>Mt)return i;{let m=Math.pow(10,i.mag-n.mag),h=n.sign+i.sign*m;return r.fromComponents(Math.sign(h),1,n.mag+Math.log10(Math.abs(h)))}throw Error("Bad arguments to add: "+this+", "+t)}plus(t){return this.add(t)}sub(t){return this.add(r.fromValue_noAlloc(t).neg())}subtract(t){return this.sub(t)}minus(t){return this.sub(t)}mul(t){let e=r.fromValue_noAlloc(t);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(e.layer))return e;if(this.sign===0||e.sign===0)return r.fromComponents_noNormalize(0,0,0);if(this.layer===e.layer&&this.mag===-e.mag)return r.fromComponents_noNormalize(this.sign*e.sign,0,1);let i,n;if(this.layer>e.layer||this.layer==e.layer&&Math.abs(this.mag)>Math.abs(e.mag)?(i=this,n=e):(i=e,n=this),i.layer===0&&n.layer===0)return r.fromNumber(i.sign*n.sign*i.mag*n.mag);if(i.layer>=3||i.layer-n.layer>=2)return r.fromComponents(i.sign*n.sign,i.layer,i.mag);if(i.layer===1&&n.layer===0)return r.fromComponents(i.sign*n.sign,1,i.mag+Math.log10(n.mag));if(i.layer===1&&n.layer===1)return r.fromComponents(i.sign*n.sign,1,i.mag+n.mag);if(i.layer===2&&n.layer===1){let a=r.fromComponents(Math.sign(i.mag),i.layer-1,Math.abs(i.mag)).add(r.fromComponents(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)));return r.fromComponents(i.sign*n.sign,a.layer+1,a.sign*a.mag)}if(i.layer===2&&n.layer===2){let a=r.fromComponents(Math.sign(i.mag),i.layer-1,Math.abs(i.mag)).add(r.fromComponents(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)));return r.fromComponents(i.sign*n.sign,a.layer+1,a.sign*a.mag)}throw Error("Bad arguments to mul: "+this+", "+t)}multiply(t){return this.mul(t)}times(t){return this.mul(t)}div(t){let e=r.fromValue_noAlloc(t);return this.mul(e.recip())}divide(t){return this.div(t)}divideBy(t){return this.div(t)}dividedBy(t){return this.div(t)}recip(){return this.mag===0?r.dNaN:this.layer===0?r.fromComponents(this.sign,0,1/this.mag):r.fromComponents(this.sign,this.layer,-this.mag)}reciprocal(){return this.recip()}reciprocate(){return this.recip()}cmp(t){let e=r.fromValue_noAlloc(t);return this.sign>e.sign?1:this.sign<e.sign?-1:this.sign*this.cmpabs(t)}cmpabs(t){let e=r.fromValue_noAlloc(t),i=this.mag>0?this.layer:-this.layer,n=e.mag>0?e.layer:-e.layer;return i>n?1:i<n?-1:this.mag>e.mag?1:this.mag<e.mag?-1:0}compare(t){return this.cmp(t)}isNan(){return isNaN(this.sign)||isNaN(this.layer)||isNaN(this.mag)}isFinite(){return isFinite(this.sign)&&isFinite(this.layer)&&isFinite(this.mag)}eq(t){let e=r.fromValue_noAlloc(t);return this.sign===e.sign&&this.layer===e.layer&&this.mag===e.mag}equals(t){return this.eq(t)}neq(t){return!this.eq(t)}notEquals(t){return this.neq(t)}lt(t){return this.cmp(t)===-1}lte(t){return!this.gt(t)}gt(t){return this.cmp(t)===1}gte(t){return!this.lt(t)}max(t){let e=r.fromValue_noAlloc(t);return this.lt(e)?e:this}min(t){let e=r.fromValue_noAlloc(t);return this.gt(e)?e:this}maxabs(t){let e=r.fromValue_noAlloc(t);return this.cmpabs(e)<0?e:this}minabs(t){let e=r.fromValue_noAlloc(t);return this.cmpabs(e)>0?e:this}clamp(t,e){return this.max(t).min(e)}clampMin(t){return this.max(t)}clampMax(t){return this.min(t)}cmp_tolerance(t,e){let i=r.fromValue_noAlloc(t);return this.eq_tolerance(i,e)?0:this.cmp(i)}compare_tolerance(t,e){return this.cmp_tolerance(t,e)}eq_tolerance(t,e){let i=r.fromValue_noAlloc(t);if(e==null&&(e=1e-7),this.sign!==i.sign||Math.abs(this.layer-i.layer)>1)return!1;let n=this.mag,a=i.mag;return this.layer>i.layer&&(a=Nt(a)),this.layer<i.layer&&(n=Nt(n)),Math.abs(n-a)<=e*Math.max(Math.abs(n),Math.abs(a))}equals_tolerance(t,e){return this.eq_tolerance(t,e)}neq_tolerance(t,e){return!this.eq_tolerance(t,e)}notEquals_tolerance(t,e){return this.neq_tolerance(t,e)}lt_tolerance(t,e){let i=r.fromValue_noAlloc(t);return!this.eq_tolerance(i,e)&&this.lt(i)}lte_tolerance(t,e){let i=r.fromValue_noAlloc(t);return this.eq_tolerance(i,e)||this.lt(i)}gt_tolerance(t,e){let i=r.fromValue_noAlloc(t);return!this.eq_tolerance(i,e)&&this.gt(i)}gte_tolerance(t,e){let i=r.fromValue_noAlloc(t);return this.eq_tolerance(i,e)||this.gt(i)}pLog10(){return this.lt(r.dZero)?r.dZero:this.log10()}absLog10(){return this.sign===0?r.dNaN:this.layer>0?r.fromComponents(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):r.fromComponents(1,0,Math.log10(this.mag))}log10(){return this.sign<=0?r.dNaN:this.layer>0?r.fromComponents(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):r.fromComponents(this.sign,0,Math.log10(this.mag))}log(t){return t=r.fromValue_noAlloc(t),this.sign<=0||t.sign<=0||t.sign===1&&t.layer===0&&t.mag===1?r.dNaN:this.layer===0&&t.layer===0?r.fromComponents(this.sign,0,Math.log(this.mag)/Math.log(t.mag)):r.div(this.log10(),t.log10())}log2(){return this.sign<=0?r.dNaN:this.layer===0?r.fromComponents(this.sign,0,Math.log2(this.mag)):this.layer===1?r.fromComponents(Math.sign(this.mag),0,Math.abs(this.mag)*3.321928094887362):this.layer===2?r.fromComponents(Math.sign(this.mag),1,Math.abs(this.mag)+.5213902276543247):r.fromComponents(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}ln(){return this.sign<=0?r.dNaN:this.layer===0?r.fromComponents(this.sign,0,Math.log(this.mag)):this.layer===1?r.fromComponents(Math.sign(this.mag),0,Math.abs(this.mag)*2.302585092994046):this.layer===2?r.fromComponents(Math.sign(this.mag),1,Math.abs(this.mag)+.36221568869946325):r.fromComponents(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}logarithm(t){return this.log(t)}pow(t){let e=r.fromValue_noAlloc(t),i=this,n=e;if(i.sign===0)return n.eq(0)?r.fromComponents_noNormalize(1,0,1):i;if(i.sign===1&&i.layer===0&&i.mag===1)return i;if(n.sign===0)return r.fromComponents_noNormalize(1,0,1);if(n.sign===1&&n.layer===0&&n.mag===1)return i;let a=i.absLog10().mul(n).pow10();return this.sign===-1?Math.abs(n.toNumber()%2)%2===1?a.neg():Math.abs(n.toNumber()%2)%2===0?a:r.dNaN:a}pow10(){if(!Number.isFinite(this.layer)||!Number.isFinite(this.mag))return r.dNaN;let t=this;if(t.layer===0){let e=Math.pow(10,t.sign*t.mag);if(Number.isFinite(e)&&Math.abs(e)>=.1)return r.fromComponents(1,0,e);if(t.sign===0)return r.dOne;t=r.fromComponents_noNormalize(t.sign,t.layer+1,Math.log10(t.mag))}return t.sign>0&&t.mag>=0?r.fromComponents(t.sign,t.layer+1,t.mag):t.sign<0&&t.mag>=0?r.fromComponents(-t.sign,t.layer+1,-t.mag):r.dOne}pow_base(t){return r.fromValue_noAlloc(t).pow(this)}root(t){let e=r.fromValue_noAlloc(t);return this.pow(e.recip())}factorial(){return this.mag<0?this.add(1).gamma():this.layer===0?this.add(1).gamma():this.layer===1?r.exp(r.mul(this,r.ln(this).sub(1))):r.exp(this)}gamma(){if(this.mag<0)return this.recip();if(this.layer===0){if(this.lt(r.fromComponents_noNormalize(1,0,24)))return r.fromNumber(De(this.sign*this.mag));let t=this.mag-1,e=.9189385332046727;e=e+(t+.5)*Math.log(t),e=e-t;let i=t*t,n=t,a=12*n,s=1/a,m=e+s;if(m===e||(e=m,n=n*i,a=360*n,s=1/a,m=e-s,m===e))return r.exp(e);e=m,n=n*i,a=1260*n;let h=1/a;return e=e+h,n=n*i,a=1680*n,h=1/a,e=e-h,r.exp(e)}else return this.layer===1?r.exp(r.mul(this,r.ln(this).sub(1))):r.exp(this)}lngamma(){return this.gamma().ln()}exp(){return this.mag<0?r.dOne:this.layer===0&&this.mag<=709.7?r.fromNumber(Math.exp(this.sign*this.mag)):this.layer===0?r.fromComponents(1,1,this.sign*Math.log10(Math.E)*this.mag):this.layer===1?r.fromComponents(1,2,this.sign*(Math.log10(.4342944819032518)+this.mag)):r.fromComponents(1,this.layer+1,this.sign*this.mag)}sqr(){return this.pow(2)}sqrt(){if(this.layer===0)return r.fromNumber(Math.sqrt(this.sign*this.mag));if(this.layer===1)return r.fromComponents(1,2,Math.log10(this.mag)-.3010299956639812);{let t=r.div(r.fromComponents_noNormalize(this.sign,this.layer-1,this.mag),r.fromComponents_noNormalize(1,0,2));return t.layer+=1,t.normalize(),t}}cube(){return this.pow(3)}cbrt(){return this.pow(1/3)}tetrate(t=2,e=r.fromComponents_noNormalize(1,0,1),i=!1){if(t===1)return r.pow(this,e);if(t===0)return new r(e);if(this.eq(r.dOne))return r.dOne;if(this.eq(-1))return r.pow(this,e);if(t===Number.POSITIVE_INFINITY){let s=this.toNumber();if(s<=1.444667861009766&&s>=.06598803584531254){if(s>1.444667861009099)return r.fromNumber(Math.E);let m=r.ln(this).neg();return m.lambertw().div(m)}else return s>1.444667861009766?r.fromNumber(Number.POSITIVE_INFINITY):r.dNaN}if(this.eq(r.dZero)){let s=Math.abs((t+1)%2);return s>1&&(s=2-s),r.fromNumber(s)}if(t<0)return r.iteratedlog(e,this,-t,i);e=r.fromValue_noAlloc(e);let n=t;t=Math.trunc(t);let a=n-t;if(this.gt(r.dZero)&&this.lte(1.444667861009766)&&(n>1e4||!i)){t=Math.min(1e4,t);for(let s=0;s<t;++s){let m=e;if(e=this.pow(e),m.eq(e))return e}if(a!=0||n>1e4){let s=this.pow(e);return n<=1e4||Math.ceil(n)%2==0?e.mul(1-a).add(s.mul(a)):e.mul(a).add(s.mul(1-a))}return e}a!==0&&(e.eq(r.dOne)?this.gt(10)||i?e=this.pow(a):(e=r.fromNumber(r.tetrate_critical(this.toNumber(),a)),this.lt(2)&&(e=e.sub(1).mul(this.minus(1)).plus(1))):this.eq(10)?e=e.layeradd10(a,i):e=e.layeradd(a,this,i));for(let s=0;s<t;++s){if(e=this.pow(e),!isFinite(e.layer)||!isFinite(e.mag))return e.normalize();if(e.layer-this.layer>3)return r.fromComponents_noNormalize(e.sign,e.layer+(t-s-1),e.mag);if(s>1e4)return e}return e}iteratedexp(t=2,e=r.fromComponents_noNormalize(1,0,1),i=!1){return this.tetrate(t,e,i)}iteratedlog(t=10,e=1,i=!1){if(e<0)return r.tetrate(t,-e,this,i);t=r.fromValue_noAlloc(t);let n=r.fromDecimal(this),a=e;e=Math.trunc(e);let s=a-e;if(n.layer-t.layer>3){let m=Math.min(e,n.layer-t.layer-3);e-=m,n.layer-=m}for(let m=0;m<e;++m){if(n=n.log(t),!isFinite(n.layer)||!isFinite(n.mag))return n.normalize();if(m>1e4)return n}return s>0&&s<1&&(t.eq(10)?n=n.layeradd10(-s,i):n=n.layeradd(-s,t,i)),n}slog(t=10,e=100,i=!1){let n=.001,a=!1,s=!1,m=this.slog_internal(t,i).toNumber();for(let h=1;h<e;++h){let S=new r(t).tetrate(m,r.dOne,i).gt(this);if(h>1&&s!=S&&(a=!0),s=S,a?n/=2:n*=2,n=Math.abs(n)*(S?-1:1),m+=n,n===0)break}return r.fromNumber(m)}slog_internal(t=10,e=!1){if(t=r.fromValue_noAlloc(t),t.lte(r.dZero)||t.eq(r.dOne))return r.dNaN;if(t.lt(r.dOne))return this.eq(r.dOne)?r.dZero:this.eq(r.dZero)?r.dNegOne:r.dNaN;if(this.mag<0||this.eq(r.dZero))return r.dNegOne;let i=0,n=r.fromDecimal(this);if(n.layer-t.layer>3){let a=n.layer-t.layer-3;i+=a,n.layer-=a}for(let a=0;a<100;++a)if(n.lt(r.dZero))n=r.pow(t,n),i-=1;else{if(n.lte(r.dOne))return e?r.fromNumber(i+n.toNumber()-1):r.fromNumber(i+r.slog_critical(t.toNumber(),n.toNumber()));i+=1,n=r.log(n,t)}return r.fromNumber(i)}static slog_critical(t,e){return t>10?e-1:r.critical_section(t,e,ze)}static tetrate_critical(t,e){return r.critical_section(t,e,Re)}static critical_section(t,e,i,n=!1){e*=10,e<0&&(e=0),e>10&&(e=10),t<2&&(t=2),t>10&&(t=10);let a=0,s=0;for(let h=0;h<W.length;++h)if(W[h]==t){a=i[h][Math.floor(e)],s=i[h][Math.ceil(e)];break}else if(W[h]<t&&W[h+1]>t){let f=(t-W[h])/(W[h+1]-W[h]);a=i[h][Math.floor(e)]*(1-f)+i[h+1][Math.floor(e)]*f,s=i[h][Math.ceil(e)]*(1-f)+i[h+1][Math.ceil(e)]*f;break}let m=e-Math.floor(e);return a<=0||s<=0?a*(1-m)+s*m:Math.pow(t,Math.log(a)/Math.log(t)*(1-m)+Math.log(s)/Math.log(t)*m)}layeradd10(t,e=!1){t=r.fromValue_noAlloc(t).toNumber();let i=r.fromDecimal(this);if(t>=1){i.mag<0&&i.layer>0?(i.sign=0,i.mag=0,i.layer=0):i.sign===-1&&i.layer==0&&(i.sign=1,i.mag=-i.mag);let n=Math.trunc(t);t-=n,i.layer+=n}if(t<=-1){let n=Math.trunc(t);if(t-=n,i.layer+=n,i.layer<0)for(let a=0;a<100;++a){if(i.layer++,i.mag=Math.log10(i.mag),!isFinite(i.mag))return i.sign===0&&(i.sign=1),i.layer<0&&(i.layer=0),i.normalize();if(i.layer>=0)break}}for(;i.layer<0;)i.layer++,i.mag=Math.log10(i.mag);return i.sign===0&&(i.sign=1,i.mag===0&&i.layer>=1&&(i.layer-=1,i.mag=1)),i.normalize(),t!==0?i.layeradd(t,10,e):i}layeradd(t,e,i=!1){let a=this.slog(e).toNumber()+t;return a>=0?r.tetrate(e,a,r.dOne,i):Number.isFinite(a)?a>=-1?r.log(r.tetrate(e,a+1,r.dOne,i),e):r.log(r.log(r.tetrate(e,a+2,r.dOne,i),e),e):r.dNaN}lambertw(){if(this.lt(-.3678794411710499))throw Error("lambertw is unimplemented for results less than -1, sorry!");if(this.mag<0)return r.fromNumber(Yt(this.toNumber()));if(this.layer===0)return r.fromNumber(Yt(this.sign*this.mag));if(this.layer===1)return Xt(this);if(this.layer===2)return Xt(this);if(this.layer>=3)return r.fromComponents_noNormalize(this.sign,this.layer-1,this.mag);throw"Unhandled behavior in lambertw()"}ssqrt(){if(this.sign==1&&this.layer>=3)return r.fromComponents_noNormalize(this.sign,this.layer-1,this.mag);let t=this.ln();return t.div(t.lambertw())}linear_sroot(t){if(t==1)return this;if(this.eq(r.dInf))return r.dInf;if(!this.isFinite())return r.dNaN;if(t==2)try{return this.ssqrt()}catch{return r.dNaN}if(t>0&&t<1)return this.root(t);if(t>-2&&t<-1)return r.fromNumber(t).add(2).pow(this.recip());if(t<=0)return r.dNaN;if(t==Number.POSITIVE_INFINITY){let e=this.toNumber();return e<Math.E&&e>je?this.pow(this.recip()):r.dNaN}if(this.eq(1))return r.dOne;if(this.lt(0))return r.dNaN;if(this.lte("1ee-16"))return t%2==1?this:r.dNaN;if(this.gt(1)){let e=r.dTen;this.gte(r.tetrate(10,t,1,!0))&&(e=this.iteratedlog(10,t-1,!0)),t<=1&&(e=this.root(t));let i=r.dZero,n=e.layer,a=e.iteratedlog(10,n,!0),s=a,m=a.div(2),h=!0;for(;h;)m=i.add(a).div(2),r.iteratedexp(10,n,m,!0).tetrate(t,1,!0).gt(this)?a=m:i=m,m.eq(s)?h=!1:s=m;return r.iteratedexp(10,n,m,!0)}else{let e=1,i=r.fromComponents(1,10,1),n=r.fromComponents(1,10,1),a=r.fromComponents(1,10,1),s=r.fromComponents(1,1,-16),m=r.dZero,h=r.fromComponents(1,10,1),f=s.pow10().recip(),S=r.dZero,N=f,C=f,T=Math.ceil(t)%2==0,I=0,w=r.fromComponents(1,10,1),V=!1,z=r.dZero,G=!1;for(;e<4;){if(e==2){if(T)break;a=r.fromComponents(1,10,1),s=i,e=3,h=r.fromComponents(1,10,1),w=r.fromComponents(1,10,1)}for(V=!1;s.neq(a);){if(z=s,s.pow10().recip().tetrate(t,1,!0).eq(1)&&s.pow10().recip().lt(.4))f=s.pow10().recip(),N=s.pow10().recip(),C=s.pow10().recip(),S=r.dZero,I=-1,e==3&&(w=s);else if(s.pow10().recip().tetrate(t,1,!0).eq(s.pow10().recip())&&!T&&s.pow10().recip().lt(.4))f=s.pow10().recip(),N=s.pow10().recip(),C=s.pow10().recip(),S=r.dZero,I=0;else if(s.pow10().recip().tetrate(t,1,!0).eq(s.pow10().recip().mul(2).tetrate(t,1,!0)))f=s.pow10().recip(),N=r.dZero,C=f.mul(2),S=f,T?I=-1:I=0;else{for(m=s.mul(12e-17),f=s.pow10().recip(),N=s.add(m).pow10().recip(),S=f.sub(N),C=f.add(S);N.tetrate(t,1,!0).eq(f.tetrate(t,1,!0))||C.tetrate(t,1,!0).eq(f.tetrate(t,1,!0))||N.gte(f)||C.lte(f);)m=m.mul(2),N=s.add(m).pow10().recip(),S=f.sub(N),C=f.add(S);if((e==1&&C.tetrate(t,1,!0).gt(f.tetrate(t,1,!0))&&N.tetrate(t,1,!0).gt(f.tetrate(t,1,!0))||e==3&&C.tetrate(t,1,!0).lt(f.tetrate(t,1,!0))&&N.tetrate(t,1,!0).lt(f.tetrate(t,1,!0)))&&(w=s),C.tetrate(t,1,!0).lt(f.tetrate(t,1,!0)))I=-1;else if(T)I=1;else if(e==3&&s.gt_tolerance(i,1e-8))I=0;else{for(;N.tetrate(t,1,!0).eq_tolerance(f.tetrate(t,1,!0),1e-8)||C.tetrate(t,1,!0).eq_tolerance(f.tetrate(t,1,!0),1e-8)||N.gte(f)||C.lte(f);)m=m.mul(2),N=s.add(m).pow10().recip(),S=f.sub(N),C=f.add(S);C.tetrate(t,1,!0).sub(f.tetrate(t,1,!0)).lt(f.tetrate(t,1,!0).sub(N.tetrate(t,1,!0)))?I=0:I=1}}if(I==-1&&(G=!0),e==1&&I==1||e==3&&I!=0)if(a.eq(r.fromComponents(1,10,1)))s=s.mul(2);else{let X=!1;if(V&&(I==1&&e==1||I==-1&&e==3)&&(X=!0),s=s.add(a).div(2),X)break}else if(a.eq(r.fromComponents(1,10,1)))a=s,s=s.div(2);else{let X=!1;if(V&&(I==1&&e==1||I==-1&&e==3)&&(X=!0),a=a.sub(h),s=s.sub(h),X)break}if(a.sub(s).div(2).abs().gt(h.mul(1.5))&&(V=!0),h=a.sub(s).div(2).abs(),s.gt("1e18")||s.eq(z))break}if(s.gt("1e18")||!G||w==r.fromComponents(1,10,1))break;e==1?i=w:e==3&&(n=w),e++}a=i,s=r.fromComponents(1,1,-18);let j=s,R=r.dZero,Y=!0;for(;Y;)if(a.eq(r.fromComponents(1,10,1))?R=s.mul(2):R=a.add(s).div(2),r.pow(10,R).recip().tetrate(t,1,!0).gt(this)?s=R:a=R,R.eq(j)?Y=!1:j=R,s.gt("1e18"))return r.dNaN;if(R.eq_tolerance(i,1e-15)){if(n.eq(r.fromComponents(1,10,1)))return r.dNaN;for(a=r.fromComponents(1,10,1),s=n,j=s,R=r.dZero,Y=!0;Y;)if(a.eq(r.fromComponents(1,10,1))?R=s.mul(2):R=a.add(s).div(2),r.pow(10,R).recip().tetrate(t,1,!0).gt(this)?s=R:a=R,R.eq(j)?Y=!1:j=R,s.gt("1e18"))return r.dNaN;return R.pow10().recip()}else return R.pow10().recip()}}pentate(t=2,e=r.fromComponents_noNormalize(1,0,1),i=!1){e=r.fromValue_noAlloc(e);let n=t;t=Math.trunc(t);let a=n-t;a!==0&&(e.eq(r.dOne)?(++t,e=r.fromNumber(a)):this.eq(10)?e=e.layeradd10(a,i):e=e.layeradd(a,this,i));for(let s=0;s<t;++s){if(e=this.tetrate(e.toNumber(),r.dOne,i),!isFinite(e.layer)||!isFinite(e.mag))return e.normalize();if(s>10)return e}return e}sin(){return this.mag<0?this:this.layer===0?r.fromNumber(Math.sin(this.sign*this.mag)):r.fromComponents_noNormalize(0,0,0)}cos(){return this.mag<0?r.dOne:this.layer===0?r.fromNumber(Math.cos(this.sign*this.mag)):r.fromComponents_noNormalize(0,0,0)}tan(){return this.mag<0?this:this.layer===0?r.fromNumber(Math.tan(this.sign*this.mag)):r.fromComponents_noNormalize(0,0,0)}asin(){return this.mag<0?this:this.layer===0?r.fromNumber(Math.asin(this.sign*this.mag)):r.fromComponents_noNormalize(Number.NaN,Number.NaN,Number.NaN)}acos(){return this.mag<0?r.fromNumber(Math.acos(this.toNumber())):this.layer===0?r.fromNumber(Math.acos(this.sign*this.mag)):r.fromComponents_noNormalize(Number.NaN,Number.NaN,Number.NaN)}atan(){return this.mag<0?this:this.layer===0?r.fromNumber(Math.atan(this.sign*this.mag)):r.fromNumber(Math.atan(this.sign*(1/0)))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return r.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return r.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?r.fromComponents_noNormalize(Number.NaN,Number.NaN,Number.NaN):r.ln(this.add(1).div(r.fromNumber(1).sub(this))).div(2)}ascensionPenalty(t){return t===0?this:this.root(r.pow(10,t))}egg(){return this.add(9)}lessThanOrEqualTo(t){return this.cmp(t)<1}lessThan(t){return this.cmp(t)<0}greaterThanOrEqualTo(t){return this.cmp(t)>-1}greaterThan(t){return this.cmp(t)>0}static smoothDamp(t,e,i,n){return new r(t).add(new r(e).minus(new r(t)).times(new r(i)).times(new r(n)))}clone(){return this}static clone(t){return r.fromComponents(t.sign,t.layer,t.mag)}mod(t){let e=r.fromValue_noAlloc(t).abs();if(e.eq(r.dZero))return r.dZero;let i=this.toNumber(),n=e.toNumber();return isFinite(i)&&isFinite(n)&&i!=0&&n!=0?new r(i%n):this.sub(e).eq(this)?r.dZero:e.sub(this).eq(e)?this:this.sign==-1?this.abs().mod(e).neg():this.sub(this.div(e).floor().mul(e))}modulo(t){return this.mod(t)}modular(t){return this.mod(t)}softcap(t,e,i){let n=this.clone();return n.gte(t)&&([0,"pow"].includes(i)&&(n=n.div(t).pow(e).mul(t)),[1,"mul"].includes(i)&&(n=n.sub(t).div(e).add(t))),n}static softcap(t,e,i,n){return new r(t).softcap(e,i,n)}scale(t,e,i,n=!1){t=new r(t),e=new r(e);let a=this.clone();return a.gte(t)&&([0,"pow"].includes(i)&&(a=n?a.mul(t.pow(e.sub(1))).root(e):a.pow(e).div(t.pow(e.sub(1)))),[1,"exp"].includes(i)&&(a=n?a.div(t).max(1).log(e).add(t):r.pow(e,a.sub(t)).mul(t))),a}static scale(t,e,i,n,a=!1){return new r(t).scale(e,i,n,a)}format(t=2,e=9,i="mixed_sc"){return K.format(this.clone(),t,e,i)}static format(t,e=2,i=9,n="mixed_sc"){return K.format(new r(t),e,i,n)}formatST(t=2,e=9,i="st"){return K.format(this.clone(),t,e,i)}static formatST(t,e=2,i=9,n="st"){return K.format(new r(t),e,i,n)}formatGain(t,e="mixed_sc"){return K.formatGain(this.clone(),t,e)}static formatGain(t,e,i="mixed_sc"){return K.formatGain(new r(t),e,i)}toRoman(t=5e3){t=new r(t);let e=this.clone();if(e.gte(t)||e.lt(1))return e;let i=e.toNumber(),n={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},a="";for(let s of Object.keys(n)){let m=Math.floor(i/n[s]);i-=m*n[s],a+=s.repeat(m)}return a}static toRoman(t,e){return new r(t).toRoman(e)}};r.dZero=r.fromComponents_noNormalize(0,0,0),r.dOne=r.fromComponents_noNormalize(1,0,1),r.dNegOne=r.fromComponents_noNormalize(-1,0,1),r.dTwo=r.fromComponents_noNormalize(1,0,2),r.dTen=r.fromComponents_noNormalize(1,0,10),r.dNaN=r.fromComponents_noNormalize(Number.NaN,Number.NaN,Number.NaN),r.dInf=r.fromComponents_noNormalize(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),r.dNegInf=r.fromComponents_noNormalize(-1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),r.dNumberMax=r.fromComponents(1,0,Number.MAX_VALUE),r.dNumberMin=r.fromComponents(1,0,Number.MIN_VALUE),r.fromStringCache=new ct(ke),B([nt()],r.prototype,"sign",2),B([nt()],r.prototype,"mag",2),B([nt()],r.prototype,"layer",2),r=B([_t()],r);var Q=[[["","U","D","T","Qa","Qt","Sx","Sp","Oc","No"],["","Dc","Vg","Tg","Qag","Qtg","Sxg","Spg","Ocg","Nog"],["","Ce","De","Te","Qae","Qte","Sxe","Spe","Oce","Noe"]],[["","Mi","Mc","Na","Pc","Fm","At","Zp","Yc","Xn"],["","Me","Du","Tr","Te","Pe","He","Hp","Ot","En"],["","c","Ic","TCn","TeC","PCn","HCn","HpC","OCn","ECn"],["","Hc","DHe","THt","TeH","PHc","HHe","HpH","OHt","EHc"]]],Ge=["st","sc","scientific","omega","omega_short","elemental","old_sc","eng","mixed_sc","layer","standard","inf"],O={omega:{config:{greek:"\u03B2\u03B6\u03BB\u03C8\u03A3\u0398\u03A8\u03C9",infinity:"\u03A9"},format(o){o=new r(o);let t=r.floor(o.div(1e3)),e=r.floor(t.div(O.omega.config.greek.length)),i=O.omega.config.greek[t.toNumber()%O.omega.config.greek.length]+wt(o.toNumber()%1e3);(O.omega.config.greek[t.toNumber()%O.omega.config.greek.length]===void 0||t.toNumber()>Number.MAX_SAFE_INTEGER)&&(i="\u03C9");let a=r.log(o,8e3).toNumber();if(e.equals(0))return i;if(e.gt(0)&&e.lte(3)){let h=[];for(let f=0;f<e.toNumber();f++)h.push("\u03C9");return`${h.join("^")}^${i}`}else{if(e.gt(3)&&e.lt(10))return`\u03C9(${e.toFixed(0)})^${i}`;if(a<3)return`\u03C9(${O.omega.format(e)})^${i}`;if(a<6)return`\u03C9(${O.omega.format(e)})`}let s=r.pow(8e3,a%1);return`\u03C9[${a<100?Math.floor(a).toFixed(0):O.omega.format(r.floor(a))}](${O.omega.format(s)})`}},omega_short:{config:{greek:"\u03B2\u03B6\u03BB\u03C8\u03A3\u0398\u03A8\u03C9",infinity:"\u03A9"},format(o){o=new r(o);let t=r.floor(o.div(1e3)),e=r.floor(t.div(O.omega_short.config.greek.length)),i=O.omega_short.config.greek[t.toNumber()%O.omega_short.config.greek.length]+wt(o.toNumber()%1e3);(O.omega_short.config.greek[t.toNumber()%O.omega_short.config.greek.length]===void 0||t.toNumber()>Number.MAX_SAFE_INTEGER)&&(i="\u03C9");let a=r.log(o,8e3).toNumber();if(e.equals(0))return i;if(e.gt(0)&&e.lte(2)){let h=[];for(let f=0;f<e.toNumber();f++)h.push("\u03C9");return`${h.join("^")}^${i}`}else if(e.gt(2)&&e.lt(10))return`\u03C9(${e.toFixed(0)})^${i}`;let s=r.pow(8e3,a%1);return`\u03C9[${a<100?Math.floor(a).toFixed(0):O.omega_short.format(r.floor(a))}](${O.omega_short.format(s)})`}},elemental:{config:{element_lists:[["H"],["He","Li","Be","B","C","N","O","F"],["Ne","Na","Mg","Al","Si","P","S","Cl"],["Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br"],["Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I"],["Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At"],["Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Nh","Fl","Mc","Lv","Ts"],["Og"]]},getOffset(o){if(o==1)return 1;let t=Math.floor(o/2),e=2*t*(t+1)*(2*t+1)/3-2;return o%2==1&&(e+=2*Math.pow(t+1,2)),e},getAbbreviation(o,t){let e=O.elemental.abbreviationLength(o),i=Math.floor(e*t),n=i+O.elemental.getOffset(o);return n>118?O.elemental.beyondOg(n):O.elemental.config.element_lists[o-1][i]},beyondOg(o){let t=Math.floor(Math.log10(o)),e=["n","u","b","t","q","p","h","s","o","e"],i="";for(let n=t;n>=0;n--){let a=Math.floor(o/Math.pow(10,n))%10;i==""?i=e[a].toUpperCase():i+=e[a]}return i},abbreviationLength(o){return o==1?1:Math.pow(Math.floor(o/2)+1,2)*2},getAbbreviationAndValue(o){let t=o.log(118).toNumber(),e=Math.floor(t)+1,i=O.elemental.abbreviationLength(e),n=t-e+1,a=Math.floor(n*i),s=O.elemental.getAbbreviation(e,n),m=new r(118).pow(e+a/i-1);return[s,m]},formatElementalPart(o,t){return t.eq(1)?o:`${t} ${o}`},format(o,t){if(o.gt(new r(118).pow(new r(118).pow(new r(118).pow(4)))))return"e"+O.elemental.format(o.log10(),t);let e=o.log(118),n=e.log(118).log(118).toNumber(),a=Math.max(4-n*2,1),s=[];for(;e.gte(1)&&s.length<a;){let[h,f]=O.elemental.getAbbreviationAndValue(e),S=e.div(f).floor();e=e.sub(S.mul(f)),s.unshift([h,S])}if(s.length>=a)return s.map(h=>O.elemental.formatElementalPart(h[0],h[1])).join(" + ");let m=new r(118).pow(e).toFixed(s.length===1?3:t);return s.length===0?m:s.length===1?`${m} \xD7 ${O.elemental.formatElementalPart(s[0][0],s[0][1])}`:`${m} \xD7 (${s.map(h=>O.elemental.formatElementalPart(h[0],h[1])).join(" + ")})`}},old_sc:{format(o,t){o=new r(o);let e=o.log10().floor();if(e.lt(9))return e.lt(3)?o.toFixed(t):o.floor().toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");{if(o.gte("eeee10")){let n=o.slog();return(n.gte(1e9)?"":new r(10).pow(n.sub(n.floor())).toFixed(4))+"F"+O.old_sc.format(n.floor(),0)}let i=o.div(new r(10).pow(e));return(e.log10().gte(9)?"":i.toFixed(4))+"e"+O.old_sc.format(e,0)}}},eng:{format(o,t){o=new r(o);let e=o.log10().floor();if(e.lt(9))return e.lt(3)?o.toFixed(t):o.floor().toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");{if(o.gte("eeee10")){let n=o.slog();return(n.gte(1e9)?"":new r(10).pow(n.sub(n.floor())).toFixed(4))+"F"+O.eng.format(n.floor(),0)}let i=o.div(new r(1e3).pow(e.div(3).floor()));return(e.log10().gte(9)?"":i.toFixed(new r(4).sub(e.sub(e.div(3).floor().mul(3)))))+"e"+O.eng.format(e.div(3).floor().mul(3),0)}}},mixed_sc:{format(o,t,e){o=new r(o);let i=o.log10().floor();return i.lt(303)&&i.gte(e)?k(o,t,e,"st"):k(o,t,e,"sc")}},layer:{layers:["infinity","eternity","reality","equality","affinity","celerity","identity","vitality","immunity","atrocity"],format(o,t,e){o=new r(o);let i=o.max(1).log10().max(1).log(Wt.log10()).floor();if(i.lte(0))return k(o,t,e,"sc");o=new r(10).pow(o.max(1).log10().div(Wt.log10().pow(i)).sub(i.gte(1)?1:0));let n=i.div(10).floor(),a=i.toNumber()%10-1;return k(o,Math.max(4,t),e,"sc")+" "+(n.gte(1)?"meta"+(n.gte(2)?"^"+k(n,0,e,"sc"):"")+"-":"")+(isNaN(a)?"nanity":O.layer.layers[a])}},standard:{tier1(o){return Q[0][0][o%10]+Q[0][1][Math.floor(o/10)%10]+Q[0][2][Math.floor(o/100)]},tier2(o){let t=o%10,e=Math.floor(o/10)%10,i=Math.floor(o/100)%10,n="";return o<10?Q[1][0][o]:(e==1&&t==0?n+="Vec":n+=Q[1][1][t]+Q[1][2][e],n+=Q[1][3][i],n)}},inf:{format(o,t,e){o=new r(o);let i=0,n=new r(Number.MAX_VALUE),a=["","\u221E","\u03A9","\u03A8","\u028A"],s=["","","m","mm","mmm"];for(;o.gte(n);)o=o.log(n),i++;return i==0?k(o,t,e,"sc"):o.gte(3)?s[i]+a[i]+"\u03C9^"+k(o.sub(1),t,e,"sc"):o.gte(2)?s[i]+"\u03C9"+a[i]+"-"+k(n.pow(o.sub(2)),t,e,"sc"):s[i]+a[i]+"-"+k(n.pow(o.sub(1)),t,e,"sc")}}},Wt=new r(2).pow(1024),Be="\u2080\u2081\u2082\u2083\u2084\u2085\u2086\u2087\u2088\u2089",Ue="\u2070\xB9\xB2\xB3\u2074\u2075\u2076\u2077\u2078\u2079";function wt(o){return o.toFixed(0).split("").map(t=>t==="-"?"\u208B":Be[parseInt(t,10)]).join("")}function $e(o){return o.toFixed(0).split("").map(t=>t==="-"?"\u208B":Ue[parseInt(t,10)]).join("")}function Ze(o,t=2,e=9,i="st"){return k(o,t,e,i)}function k(o,t=2,e=9,i="mixed_sc"){o=new r(o);let n=o.lt(0)?"-":"";if(o.mag==1/0)return n+"Infinity";if(Number.isNaN(o.mag))return n+"NaN";if(o.lt(0)&&(o=o.mul(-1)),o.eq(0))return o.toFixed(t);let a=o.log10().floor();switch(i){case"sc":case"scientific":if(o.log10().lt(Math.min(-t,0))&&t>1){let s=o.log10().ceil(),m=o.div(s.eq(-1)?new r(.1):new r(10).pow(s)),h=s.mul(-1).max(1).log10().gte(9);return n+(h?"":m.toFixed(2))+"e"+k(s,0,e,"mixed_sc")}else if(a.lt(e)){let s=Math.max(Math.min(t-a.toNumber(),t),0);return n+(s>0?o.toFixed(s):o.toFixed(s).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"))}else{if(o.gte("eeee10")){let h=o.slog();return(h.gte(1e9)?"":new r(10).pow(h.sub(h.floor())).toFixed(2))+"F"+k(h.floor(),0)}let s=o.div(new r(10).pow(a)),m=a.log10().gte(9);return n+(m?"":s.toFixed(2))+"e"+k(a,0,e,"mixed_sc")}case"st":case"standard":{let s=o.log(1e3).floor();if(s.lt(1))return n+o.toFixed(Math.max(Math.min(t-a.toNumber(),t),0));{let m=s.mul(3),h=s.log10().floor();if(h.gte(3e3))return"e"+k(a,t,e,"st");let f="";if(s.lt(4))f=["","K","M","B"][Math.round(s.toNumber())];else{let N=Math.floor(s.log(1e3).toNumber());for(N<100&&(N=Math.max(N-1,0)),s=s.sub(1).div(new r(10).pow(N*3));s.gt(0);){let C=s.div(1e3).floor(),T=s.sub(C.mul(1e3)).floor().toNumber();T>0&&(T==1&&!N&&(f="U"),N&&(f=O.standard.tier2(N)+(f?"-"+f:"")),T>1&&(f=O.standard.tier1(T)+f)),s=C,N++}}let S=o.div(new r(10).pow(m));return n+(h.gte(10)?"":S.toFixed(new r(2).sub(a.sub(m)).add(1).toNumber())+" ")+f}}default:return n+O[i].format(o,t,e)}}function _e(o,t,e="mixed_sc"){o=new r(o),t=new r(t);let i=o.add(t),n,a=i.div(o);return a.gte(10)&&o.gte(1e100)?(a=a.log10().mul(20),n="(+"+k(a,2,9,e)+" OoMs/sec)"):n="(+"+k(t,2,9,e)+"/sec)",n}function ft(o,t=2,e="s"){return o=new r(o),o.gte(86400)?k(o.div(86400).floor(),0,12,"sc")+":"+ft(o.mod(86400),t,"d"):o.gte(3600)||e=="d"?(o.div(3600).gte(10)||e!="d"?"":"0")+k(o.div(3600).floor(),0,12,"sc")+":"+ft(o.mod(3600),t,"h"):o.gte(60)||e=="h"?(o.div(60).gte(10)||e!="h"?"":"0")+k(o.div(60).floor(),0,12,"sc")+":"+ft(o.mod(60),t,"m"):(o.gte(10)||e!="m"?"":"0")+k(o,t,12,"sc")}function He(o){return o=new r(o),k(new r(1).sub(o).mul(100))+"%"}function Ye(o){return o=new r(o),k(o.mul(100))+"%"}function Xe(o,t=2){return o=new r(o),o.gte(1)?"\xD7"+o.format(t):"/"+o.pow(-1).format(t)}function We(o,t,e=10){return r.gte(o,10)?r.pow(e,r.log(o,e).pow(t)):new r(o)}function vt(o,t){o=new r(o);let e=(n=>n.map((a,s)=>({name:a.name,altName:a.altName,value:r.pow(1e3,new r(s).add(1))})))([{name:"K",altName:"Kilo"},{name:"M",altName:"Mega"},{name:"G",altName:"Giga"},{name:"T",altName:"Tera"},{name:"P",altName:"Peta"},{name:"E",altName:"Exa"},{name:"Z",altName:"Zetta"},{name:"Y",altName:"Yotta"},{name:"R",altName:"Ronna"},{name:"Q",altName:"Quetta"}]),i="";for(let n=0;n<e.length;n++)if(o.greaterThanOrEqualTo(e[n].value)){if(n==e.length-1)switch(t){case 1:i=e[n].name;break;case 2:i=`${o.divide(e[n].value).format()}`;break;case 3:i=e[n].altName;break;case 0:default:i=`${o.divide(e[n].value).format()} ${e[n].name}`;break}continue}else if(n==0)switch(t){case 1:i="";break;case 2:case 0:default:i=o.format();break}else switch(t){case 1:i=e[n-1].name;break;case 2:i=`${o.divide(e[n-1].value).format()}`;break;case 3:i=e[n-1].altName;break;case 0:default:i=`${o.divide(e[n-1].value).format()} ${e[n-1].name}`;break}return i}function Qe(o,t=!1){return`${vt(o,2)} ${vt(o,1)}eV${t?"/c^2":""}`}var K={...O,toSubscript:wt,toSuperscript:$e,formatST:Ze,format:k,formatGain:_e,formatTime:ft,formatReduction:He,formatPercent:Ye,formatMult:Xe,expMult:We,metric:vt,ev:Qe};r.formats=K;var A=(()=>{let o=t=>new r(t);return Object.getOwnPropertyNames(r).filter(t=>!Object.getOwnPropertyNames(class{}).includes(t)).forEach(t=>{o[t]=r[t]}),o})();var J=class{constructor(t){this.id=t.id,this.name=t.name??"",this.desc=t.desc??"",this.value=t.value,this.order=t.order??99}},H=class{constructor(t=1,e){this.addBoost=this.setBoost;e=e?Array.isArray(e)?e:[e]:void 0,this.baseEffect=A(t),this.boostArray=[],e&&e.forEach(i=>{this.boostArray.push(new J(i))})}getBoosts(t,e){let i=[],n=[];for(let a=0;a<this.boostArray.length;a++)(typeof t=="string"&&t===this.boostArray[a].id||t instanceof RegExp&&t.test(this.boostArray[a].id))&&(i.push(this.boostArray[a]),n.push(a));return e?[i,n]:i}getBoost(t){return this.getBoosts(t)[0]??null}removeBoost(t){for(let e=0;e<this.boostArray.length;e++)if(t===this.boostArray[e].id){this.boostArray.splice(e,1);break}}setBoost(t,e,i,n,a){if(t)if(typeof t=="string"){let s=t,m=e??"",h=i??"",f=n??(C=>C),S=a,N=this.getBoosts(s,!0);N[0][0]?this.boostArray[N[1][0]]=new J({id:s,name:m,desc:h,value:f,order:S}):this.boostArray.push(new J({id:s,name:m,desc:h,value:f,order:S}))}else{t=Array.isArray(t)?t:[t];for(let s=0;s<t.length;s++){let m=this.getBoosts(t[s].id,!0);m[0][0]?this.boostArray[m[1][0]]=new J(t[s]):this.boostArray=this.boostArray.concat(new J(t[s]))}}}calculate(t=this.baseEffect){let e=A(t),i=this.boostArray;i=i.sort((n,a)=>n.order-a.order);for(let n=0;n<i.length;n++)e=i[n].value(e);return e}};function At(o,t,e=1,i=!1){if(e=A(e),e.lte(0))return[A(0),A(0)];if(i=t.el??i,e.eq(1)){if(i){let h=t.cost(t.level),f=o.gte(h);return[f?A(1):A(0),f?h:A(0)]}let s=t.cost(t.level),m=o.gte(s);return[m?A(1):A(0),m?s:A(0)]}if(t.costBulk){let[s,m]=t.costBulk(t.level,e),h=o.gte(s);return[h?m:A(0),h?s:A(0)]}function n(s,m){let h=A();for(let f=A(0);f.lte(m);f=f.add(1))h=h.add(s(f));return h}function a(s,m){if(i){let S=A(0),N=e,C=A(0);for(;S.lessThanOrEqualTo(N);){let T=S.plus(N).dividedBy(2).floor();s(T).lte(m)?(C=T,S=T.plus(1)):N=T.minus(1)}return[C,C.gt(0)?s(C):A(0)]}let h=A(0),f=A(1);for(;n(s,f).lt(m);)f=f.mul(2);for(;h.lt(f);){let S=A.floor(h.add(f).div(2));n(s,S).lt(m)?h=S.add(1):f=S}return[h,h.gt(0)?n(s,h.sub(1)):A(0)]}return a(s=>t.cost(t.level.add(s)),o)}var st=class{constructor(t){t=t??{},this.id=t.id??-1,this.level=t.level?A(t.level):A(1)}};B([nt()],st.prototype,"id",2),B([ot(()=>r)],st.prototype,"level",2);var Ct=class{get data(){return this.dataPointerFn()}constructor(t,e){let i=typeof e=="function"?e():e;this.dataPointerFn=typeof e=="function"?e:()=>i,this.id=t.id,this.name=t.name??t.id,this.description=t.description??"",this.cost=t.cost,this.costBulk=t.costBulk,this.maxLevel=t.maxLevel??A(1),this.effect=t.effect,this.el=t.el}get level(){return this.data.level}set level(t){this.data.level=A(t)}},tt=class{constructor(){this.value=A(0),this.upgrades=[]}};B([ot(()=>r)],tt.prototype,"value",2),B([ot(()=>st)],tt.prototype,"upgrades",2);var mt=class{get pointer(){return this.pointerFn()}onLoadData(){this.upgrades.forEach(t=>{t.effect&&t.effect(t.level,t)})}constructor(t=new tt,e=A(0),i=A(1)){this.defaultVal=A(e),this.defaultBoost=A(i),this.upgrades=[],this.pointerFn=typeof t=="function"?t:()=>t,this.boost=new H(i),this.pointer.value=this.defaultVal}get value(){return this.pointer.value}set value(t){this.pointer.value=t}reset(t=!0,e=!0){t&&(this.value=this.defaultVal),e&&this.upgrades.forEach(i=>{i.level=A(0)})}gain(t=1e3){let e=this.boost.calculate().mul(A(t).div(1e3));return this.pointer.value=this.pointer.value.add(e),e}pointerAddUpgrade(t){let e=new st(t);return this.pointer.upgrades.push(e),t}pointerGetUpgrade(t){let e=null;if(t===void 0)return null;for(let i=0;i<this.pointer.upgrades.length;i++)if(this.pointer.upgrades[i].id===t){e=this.pointer.upgrades[i];break}return e}getUpgrade(t){let e=null;if(t===void 0)return null;if(typeof t=="string"){for(let i=0;i<this.upgrades.length;i++)if(this.upgrades[i].id===t){e=this.upgrades[i];break}}return e}addUpgrade(t,e=!0){Array.isArray(t)||(t=[t]);let i=[];for(let n=0;n<t.length;n++){this.pointerAddUpgrade(t[n]);let a=this.pointer.upgrades.length,s=new Ct(t[n],()=>this.pointerGetUpgrade(t[n].id)??this.pointer.upgrades[a-1]);s.effect&&e&&s.effect(s.level,s),i.push(s)}this.upgrades=this.upgrades.concat(i)}updateUpgrade(t,e){let i=this.getUpgrade(t);i!==null&&(i.name=e.name??i.name,i.cost=e.cost??i.cost,i.maxLevel=e.maxLevel??i.maxLevel,i.effect=e.effect??i.effect)}calculateUpgrade(t,e=1,i=!1){let n=this.getUpgrade(t);return n===null?(console.warn(`Upgrade "${t}" not found.`),[A(0),A(0)]):At(this.value,n,e,i)}getNextCost(t,e=0,i=!1){let n=this.getUpgrade(t);if(n===null)return console.warn(`Upgrade "${t}" not found.`),A(0);let a=At(this.value,n,e,i)[1];return n.cost(n.level.add(a))}buyUpgrade(t,e=1){let i=this.getUpgrade(t);if(i===null)return!1;e=A(e);let n=At(this.value,i,e);return n[0].lte(0)?!1:(this.pointer.value=this.pointer.value.sub(n[1]),i.level=i.level.add(n[0]),typeof i.effect=="function"&&i.effect(i.level,i),!0)}};var at=class{constructor(t=0){this.value=A(t)}};B([ot(()=>r)],at.prototype,"value",2);var Kt=class{get pointer(){return this.pointerFn}constructor(t,e=!0,i=0){this.initial=A(i),t=t??new at(this.initial),this.pointerFn=typeof t=="function"?t():t,e&&(this.boost=new H(this.initial))}update(){this.boost&&(this.pointer.value=this.boost.calculate())}get value(){return this.boost&&(this.pointer.value=this.boost.calculate()),this.pointer.value}set value(t){if(this.boost)throw new Error("Cannot set value of attributeStatic when boost is enabled.");this.pointer.value=t}};var lt=class{constructor(t,e,i){this.x=t,this.y=e,this.properties=i||{}}setValue(t,e){return this.properties[t]=e,e}getValue(t){return this.properties[t]}},ht=class{constructor(t,e,i){this.x_size=t,this.y_size=e,this.cells=[];for(let n=0;n<e;n++){this.cells[n]=[];for(let a=0;a<t;a++)this.cells[n][a]=new lt(a,n,i)}}getAll(){let t=[];for(let e=0;e<this.y_size;e++)for(let i=0;i<this.x_size;i++)t.push(this.cells[e][i]);return t}all(){return this.getAll()}getAllX(t){let e=[];for(let i=0;i<this.y_size;i++)e.push(this.cells[i][t]);return e}allX(t){return this.getAllX(t)}getAllY(t){let e=[];for(let i=0;this.x_size;i++)e.push(this.cells[t][i]);return e}allY(t){return this.getAllY(t)}getCell(t,e){return this.cells[e][t]}setCell(t,e,i){this.cells[e][t]=i}getAdjacent(t,e){let i=[];return i[0]=this.getCell(t,e+1),i[1]=this.getCell(t+1,e),i[2]=this.getCell(t,e-1),i[3]=this.getCell(t-1,e+1),i}getDiagonal(t,e){let i=[];return i[0]=this.getCell(t-1,e+1),i[1]=this.getCell(t+1,e+1),i[2]=this.getCell(t+1,e-1),i[3]=this.getCell(t-1,e-1),i}getEncircling(t,e){return this.getAdjacent(t,e).concat(this.getDiagonal(t,e))}static getDistance(t,e,i,n){return Math.abs(Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2)))}};var Ke={E:A,classes:{boost:H,currency:tt,currencyStatic:mt,attribute:at,grid:ht,gridCell:lt}};function Jt(){typeof process!="object"&&typeof window<"u"&&(window.eMath=Ke)}Jt();})();
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)
*/
