!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).eMathGame={})}(this,(function(t){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var i,n,a,o={};!function(){return i||(i=1,r=t||(t={}),function(){var t="object"==typeof globalThis?globalThis:"object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:function(){try{return Function("return this;")()}catch(t){}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch(t){}}(),i=n(r);function n(t,e){return function(r,i){Object.defineProperty(t,r,{configurable:!0,writable:!0,value:i}),e&&e(r,i)}}void 0!==t.Reflect&&(i=n(t.Reflect,i)),function(t,e){var r,i=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,a=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,l={__proto__:[]}instanceof Array,u=!s&&!l,h={create:s?function(){return j(Object.create(null))}:l?function(){return j({__proto__:null})}:function(){return j({})},has:u?function(t,e){return i.call(t,e)}:function(t,e){return e in t},get:u?function(t,e){return i.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},c=Object.getPrototypeOf(Function),f="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:function(){var t={},e=[],r=function(){function t(t,e,r){this._index=0,this._keys=t,this._values=e,this._selector=r}return t.prototype["@@iterator"]=function(){return this},t.prototype[o]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var r=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var r=this._find(t,!0);return this._values[r]=e,this},e.prototype.delete=function(e){var r=this._find(e,!1);if(r>=0){for(var i=this._keys.length,n=r+1;n<i;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,E(e,this._cacheKey)&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new r(this._keys,this._values,i)},e.prototype.values=function(){return new r(this._keys,this._values,n)},e.prototype.entries=function(){return new r(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[o]=function(){return this.entries()},e.prototype._find=function(t,e){if(!E(this._cacheKey,t)){this._cacheIndex=-1;for(var r=0;r<this._keys.length;r++)if(E(this._keys[r],t)){this._cacheIndex=r;break}}return this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function i(t,e){return t}function n(t,e){return e}function a(t,e){return[t,e]}}(),m="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:function(){function t(){this._map=new f}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.keys()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[o]=function(){return this.keys()},t}(),d="function"==typeof WeakMap?WeakMap:function(){var t=h.create(),e=r();return function(){function t(){this._key=r()}return t.prototype.has=function(t){var e=n(t,!1);return void 0!==e&&h.has(e,this._key)},t.prototype.get=function(t){var e=n(t,!1);return void 0!==e?h.get(e,this._key):void 0},t.prototype.set=function(t,e){return n(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=n(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=r()},t}();function r(){var e;do{e="@@WeakMap@@"+function(){var t=function(t){if("function"==typeof Uint8Array){var e=new Uint8Array(16);return"undefined"!=typeof crypto?crypto.getRandomValues(e):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(e):a(e,16),e}return a(Array(16),t)}(16);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var e="",r=0;r<16;++r){var i=t[r];(4===r||6===r||8===r)&&(e+="-"),i<16&&(e+="0"),e+=i.toString(16).toLowerCase()}return e}()}while(h.has(t,e));return t[e]=!0,e}function n(t,r){if(!i.call(t,e)){if(!r)return;Object.defineProperty(t,e,{value:h.create()})}return t[e]}function a(t,e){for(var r=0;r<e;++r)t[r]=255*Math.random()|0;return t}}(),p=n?Symbol.for("@reflect-metadata:registry"):void 0,g=(!_(p)&&T(e.Reflect)&&Object.isExtensible(e.Reflect)&&(r=e.Reflect[p]),_(r)&&(r=function(){_(p)||void 0===e.Reflect||p in e.Reflect||"function"!=typeof e.Reflect.defineMetadata||(r=(t=e.Reflect).defineMetadata,i=t.hasOwnMetadata,n=t.getOwnMetadata,a=t.getOwnMetadataKeys,o=t.deleteMetadata,s=new d,l={isProviderFor:function(t,e){var r=s.get(t);return!(_(r)||!r.has(e))||!!a(t,e).length&&(_(r)&&(r=new m,s.set(t,r)),r.add(e),!0)},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:a,OrdinaryDeleteMetadata:o});var t,r,i,n,a,o,s,l,u,h,c,g=new d,y={registerProvider:function(t){if(!Object.isExtensible(y))throw Error("Cannot add provider to a frozen registry.");switch(!0){case l===t:break;case _(u):u=t;break;case u===t:break;case _(h):h=t;break;case h===t:break;default:void 0===c&&(c=new m),c.add(t)}},getProvider:N,setProvider:function(t,e,r){if(!function(t){if(_(t))throw TypeError();return u===t||h===t||!_(c)&&c.has(t)}(r))throw Error("Metadata provider not registered.");var i=N(t,e);if(i!==r){if(!_(i))return!1;var n=g.get(t);_(n)&&(n=new f,g.set(t,n)),n.set(e,r)}return!0}};return y;function N(t,e){var r,i=g.get(t);return _(i)||(r=i.get(e)),_(r)&&(r=function(t,e){if(!_(u)){if(u.isProviderFor(t,e))return u;if(!_(h)){if(h.isProviderFor(t,e))return u;if(!_(c))for(var r=C(c);;){var i=P(r);if(!i)return;var n=i.value;if(n.isProviderFor(t,e))return k(r),n}}}if(!_(l)&&l.isProviderFor(t,e))return l}(t,e),_(r)||(_(i)&&(i=new f,g.set(t,i)),i.set(e,r))),r}}()),!_(p)&&T(e.Reflect)&&Object.isExtensible(e.Reflect)&&Object.defineProperty(e.Reflect,p,{enumerable:!1,configurable:!1,writable:!1,value:r}),r),y=function(t){var e=new d,r={isProviderFor:function(t,r){var i=e.get(t);return!_(i)&&i.has(r)},OrdinaryDefineOwnMetadata:function(t,e,r,n){i(r,n,!0).set(t,e)},OrdinaryHasOwnMetadata:function(t,e,r){var n=i(e,r,!1);return!_(n)&&!!n.has(t)},OrdinaryGetOwnMetadata:function(t,e,r){var n=i(e,r,!1);if(!_(n))return n.get(t)},OrdinaryOwnMetadataKeys:function(t,e){var r=[],n=i(t,e,!1);if(_(n))return r;for(var a=C(n.keys()),o=0;;){var s=P(a);if(!s)return r.length=o,r;var l=s.value;try{r[o]=l}catch(t){try{k(a)}finally{throw t}}o++}},OrdinaryDeleteMetadata:function(t,r,n){var a=i(r,n,!1);if(_(a)||!a.delete(t))return!1;if(0===a.size){var o=e.get(r);_(o)||(o.delete(n),0===o.size&&e.delete(o))}return!0}};return g.registerProvider(r),r;function i(i,n,a){var o=e.get(i),s=!1;if(_(o)){if(!a)return;o=new f,e.set(i,o),s=!0}var l=o.get(n);if(_(l)){if(!a)return;if(l=new f,o.set(n,l),!t.setProvider(i,n,r))throw o.delete(n),s&&e.delete(i),Error("Wrong provider for target.")}return l}}(g);function N(t,e,r){var i=q(e,r,!1);return!_(i)&&!!i.OrdinaryHasOwnMetadata(t,e,r)}function b(t,e,r){var i=q(e,r,!1);if(!_(i))return i.OrdinaryGetOwnMetadata(t,e,r)}function v(t,e,r,i){q(r,i,!0).OrdinaryDefineOwnMetadata(t,e,r,i)}function w(t,e){var r=q(t,e,!1);return r?r.OrdinaryOwnMetadataKeys(t,e):[]}function M(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function _(t){return void 0===t}function I(t){return null===t}function T(t){return"object"==typeof t?null!==t:"function"==typeof t}function S(t){var e=function(t){switch(M(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var e="string",r=F(t,a);if(void 0!==r){var i=r.call(t,e);if(T(i))throw TypeError();return i}return function(t){var e,r,i=t.toString;if(x(i)&&!T(r=i.call(t)))return r;if(x(e=t.valueOf)&&!T(r=e.call(t)))return r;throw TypeError()}(t)}(t);return"symbol"==typeof e?e:""+e}function O(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function x(t){return"function"==typeof t}function A(t){return"function"==typeof t}function E(t,e){return t===e||t!=t&&e!=e}function F(t,e){var r=t[e];if(null!=r){if(!x(r))throw TypeError();return r}}function C(t){var e=F(t,o);if(!x(e))throw TypeError();var r=e.call(t);if(!T(r))throw TypeError();return r}function P(t){var e=t.next();return!e.done&&e}function k(t){var e=t.return;e&&e.call(t)}function L(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===c||e!==c)return e;var r=t.prototype,i=r&&Object.getPrototypeOf(r);if(null==i||i===Object.prototype)return e;var n=i.constructor;return"function"!=typeof n||n===t?e:n}function q(t,e,r){var i=g.getProvider(t,e);if(!_(i))return i;if(r){if(g.setProvider(t,e,y))return y;throw Error("Illegal state.")}}function j(t){return t.__=void 0,delete t.__,t}t("decorate",(function(t,e,r,i){if(_(r)){if(!O(t)||!A(e))throw TypeError();return function(t,e){for(var r=t.length-1;r>=0;--r){var i=(0,t[r])(e);if(!_(i)&&!I(i)){if(!A(i))throw TypeError();e=i}}return e}(t,e)}if(!O(t)||!T(e)||!T(i)&&!_(i)&&!I(i))throw TypeError();return I(i)&&(i=void 0),function(t,e,r,i){for(var n=t.length-1;n>=0;--n){var a=(0,t[n])(e,r,i);if(!_(a)&&!I(a)){if(!T(a))throw TypeError();i=a}}return i}(t,e,r=S(r),i)})),t("metadata",(function(t,e){return function(r,i){if(!T(r)||!_(i)&&!function(t){switch(M(t)){case 3:case 4:return!0;default:return!1}}(i))throw TypeError();v(t,e,r,i)}})),t("defineMetadata",(function(t,e,r,i){if(!T(r))throw TypeError();return _(i)||(i=S(i)),v(t,e,r,i)})),t("hasMetadata",(function(t,e,r){if(!T(e))throw TypeError();return _(r)||(r=S(r)),function t(e,r,i){if(N(e,r,i))return!0;var n=L(r);return!I(n)&&t(e,n,i)}(t,e,r)})),t("hasOwnMetadata",(function(t,e,r){if(!T(e))throw TypeError();return _(r)||(r=S(r)),N(t,e,r)})),t("getMetadata",(function(t,e,r){if(!T(e))throw TypeError();return _(r)||(r=S(r)),function t(e,r,i){if(N(e,r,i))return b(e,r,i);var n=L(r);return I(n)?void 0:t(e,n,i)}(t,e,r)})),t("getOwnMetadata",(function(t,e,r){if(!T(e))throw TypeError();return _(r)||(r=S(r)),b(t,e,r)})),t("getMetadataKeys",(function(t,e){if(!T(t))throw TypeError();return _(e)||(e=S(e)),function t(e,r){var i=w(e,r),n=L(e);if(null===n)return i;var a=t(n,r);if(a.length<=0)return i;if(i.length<=0)return a;for(var o=new m,s=[],l=0;l<i.length;l++){var u=i[l];o.has(u)||(o.add(u),s.push(u))}for(var h=0;h<a.length;h++){u=a[h];o.has(u)||(o.add(u),s.push(u))}return s}(t,e)})),t("getOwnMetadataKeys",(function(t,e){if(!T(t))throw TypeError();return _(e)||(e=S(e)),w(t,e)})),t("deleteMetadata",(function(t,e,r){if(!T(e)||(_(r)||(r=S(r)),!T(e)))throw TypeError();_(r)||(r=S(r));var i=q(e,r,!1);return!_(i)&&i.OrdinaryDeleteMetadata(t,e,r)}))}(i,t),void 0===t.Reflect&&(t.Reflect=r)}()),o;var t,r}(),(n=a||(a={}))[n.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",n[n.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",n[n.CLASS_TO_CLASS=2]="CLASS_TO_CLASS";var s=new(function(){function t(){this._typeMetadatas=new Map,this._transformMetadatas=new Map,this._exposeMetadatas=new Map,this._excludeMetadatas=new Map,this._ancestorsMap=new Map}return t.prototype.addTypeMetadata=function(t){this._typeMetadatas.has(t.target)||this._typeMetadatas.set(t.target,new Map),this._typeMetadatas.get(t.target).set(t.propertyName,t)},t.prototype.addTransformMetadata=function(t){this._transformMetadatas.has(t.target)||this._transformMetadatas.set(t.target,new Map),this._transformMetadatas.get(t.target).has(t.propertyName)||this._transformMetadatas.get(t.target).set(t.propertyName,[]),this._transformMetadatas.get(t.target).get(t.propertyName).push(t)},t.prototype.addExposeMetadata=function(t){this._exposeMetadatas.has(t.target)||this._exposeMetadatas.set(t.target,new Map),this._exposeMetadatas.get(t.target).set(t.propertyName,t)},t.prototype.addExcludeMetadata=function(t){this._excludeMetadatas.has(t.target)||this._excludeMetadatas.set(t.target,new Map),this._excludeMetadatas.get(t.target).set(t.propertyName,t)},t.prototype.findTransformMetadatas=function(t,e,r){return this.findMetadatas(this._transformMetadatas,t,e).filter((function(t){return!t.options||!0===t.options.toClassOnly&&!0===t.options.toPlainOnly||(!0===t.options.toClassOnly?r===a.CLASS_TO_CLASS||r===a.PLAIN_TO_CLASS:!0!==t.options.toPlainOnly||r===a.CLASS_TO_PLAIN)}))},t.prototype.findExcludeMetadata=function(t,e){return this.findMetadata(this._excludeMetadatas,t,e)},t.prototype.findExposeMetadata=function(t,e){return this.findMetadata(this._exposeMetadatas,t,e)},t.prototype.findExposeMetadataByCustomName=function(t,e){return this.getExposedMetadatas(t).find((function(t){return t.options&&t.options.name===e}))},t.prototype.findTypeMetadata=function(t,e){return this.findMetadata(this._typeMetadatas,t,e)},t.prototype.getStrategy=function(t){var e=this._excludeMetadatas.get(t),r=e&&e.get(void 0),i=this._exposeMetadatas.get(t),n=i&&i.get(void 0);return r&&n||!r&&!n?"none":r?"excludeAll":"exposeAll"},t.prototype.getExposedMetadatas=function(t){return this.getMetadata(this._exposeMetadatas,t)},t.prototype.getExcludedMetadatas=function(t){return this.getMetadata(this._excludeMetadatas,t)},t.prototype.getExposedProperties=function(t,e){return this.getExposedMetadatas(t).filter((function(t){return!t.options||!0===t.options.toClassOnly&&!0===t.options.toPlainOnly||(!0===t.options.toClassOnly?e===a.CLASS_TO_CLASS||e===a.PLAIN_TO_CLASS:!0!==t.options.toPlainOnly||e===a.CLASS_TO_PLAIN)})).map((function(t){return t.propertyName}))},t.prototype.getExcludedProperties=function(t,e){return this.getExcludedMetadatas(t).filter((function(t){return!t.options||!0===t.options.toClassOnly&&!0===t.options.toPlainOnly||(!0===t.options.toClassOnly?e===a.CLASS_TO_CLASS||e===a.PLAIN_TO_CLASS:!0!==t.options.toPlainOnly||e===a.CLASS_TO_PLAIN)})).map((function(t){return t.propertyName}))},t.prototype.clear=function(){this._typeMetadatas.clear(),this._exposeMetadatas.clear(),this._excludeMetadatas.clear(),this._ancestorsMap.clear()},t.prototype.getMetadata=function(t,e){var r,i=t.get(e);i&&(r=Array.from(i.values()).filter((function(t){return void 0!==t.propertyName})));for(var n=[],a=0,o=this.getAncestors(e);a<o.length;a++){var s=o[a],l=t.get(s);if(l){var u=Array.from(l.values()).filter((function(t){return void 0!==t.propertyName}));n.push.apply(n,u)}}return n.concat(r||[])},t.prototype.findMetadata=function(t,e,r){var i=t.get(e);if(i){var n=i.get(r);if(n)return n}for(var a=0,o=this.getAncestors(e);a<o.length;a++){var s=o[a],l=t.get(s);if(l){var u=l.get(r);if(u)return u}}},t.prototype.findMetadatas=function(t,e,r){var i,n=t.get(e);n&&(i=n.get(r));for(var a=[],o=0,s=this.getAncestors(e);o<s.length;o++){var l=s[o],u=t.get(l);u&&u.has(r)&&a.push.apply(a,u.get(r))}return a.slice().reverse().concat((i||[]).slice().reverse())},t.prototype.getAncestors=function(t){if(!t)return[];if(!this._ancestorsMap.has(t)){for(var e=[],r=Object.getPrototypeOf(t.prototype.constructor);void 0!==r.prototype;r=Object.getPrototypeOf(r.prototype.constructor))e.push(r);this._ancestorsMap.set(t,e)}return this._ancestorsMap.get(t)},t}());var l=function(t,e,r){if(r||2==arguments.length)for(var i,n=0,a=e.length;n<a;n++)!i&&n in e||(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))},u=function(){function t(t,e){this.transformationType=t,this.options=e,this.recursionStack=new Set}return t.prototype.transform=function(t,e,r,i,n,o){var l,u=this;if(void 0===o&&(o=0),Array.isArray(e)||e instanceof Set){var h,c=i&&this.transformationType===a.PLAIN_TO_CLASS&&((h=new i)instanceof Set||"push"in h)?h:[];return e.forEach((function(e,i){var n=t?t[i]:void 0;if(u.options.enableCircularCheck&&u.isCircular(e))u.transformationType===a.CLASS_TO_CLASS&&(c instanceof Set?c.add(e):c.push(e));else{var s=void 0;if("function"!=typeof r&&r&&r.options&&r.options.discriminator&&r.options.discriminator.property&&r.options.discriminator.subTypes){if(u.transformationType===a.PLAIN_TO_CLASS){s=r.options.discriminator.subTypes.find((function(t){return t.name===e[r.options.discriminator.property]}));var l=r.typeFunction({newObject:c,object:e,property:void 0});s=void 0===s?l:s.value,r.options.keepDiscriminatorProperty||delete e[r.options.discriminator.property]}u.transformationType===a.CLASS_TO_CLASS&&(s=e.constructor),u.transformationType===a.CLASS_TO_PLAIN&&(e[r.options.discriminator.property]=r.options.discriminator.subTypes.find((function(t){return t.value===e.constructor})).name)}else s=r;var h=u.transform(n,e,s,void 0,e instanceof Map,o+1);c instanceof Set?c.add(h):c.push(h)}})),c}if(r!==String||n){if(r===Number&&!n)return null==e?e:Number(e);if(r===Boolean&&!n)return null==e?e:!!e;if((r===Date||e instanceof Date)&&!n)return e instanceof Date?new Date(e.valueOf()):null==e?e:new Date(e);if(("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0).Buffer&&(r===Buffer||e instanceof Buffer)&&!n)return null==e?e:Buffer.from(e);if(null!==(l=e)&&"object"==typeof l&&"function"==typeof l.then&&!n)return new Promise((function(t,i){e.then((function(e){return t(u.transform(void 0,e,r,void 0,void 0,o+1))}),i)}));if(!n&&null!==e&&"object"==typeof e&&"function"==typeof e.then||"object"!=typeof e||null===e)return e;!r&&e.constructor!==Object&&(Array.isArray(e)||e.constructor!==Array)&&(r=e.constructor),!r&&t&&(r=t.constructor),this.options.enableCircularCheck&&this.recursionStack.add(e);var f=this.getKeys(r,e,n),m=t||{};t||this.transformationType!==a.PLAIN_TO_CLASS&&this.transformationType!==a.CLASS_TO_CLASS||(m=n?new Map:r?new r:{});for(var d=this,p=0;p<f.length;p++)!function(i){if("__proto__"!==i&&"constructor"!==i){var l=i,u=i;if(!d.options.ignoreDecorators&&r)if(d.transformationType===a.PLAIN_TO_CLASS)(h=s.findExposeMetadataByCustomName(r,i))&&(u=h.propertyName,l=h.propertyName);else if(d.transformationType===a.CLASS_TO_PLAIN||d.transformationType===a.CLASS_TO_CLASS){var h;(h=s.findExposeMetadata(r,i))&&h.options&&h.options.name&&(l=h.options.name)}var c=void 0;c=d.transformationType===a.PLAIN_TO_CLASS?e[i]:e instanceof Map?e.get(i):e[i]instanceof Function?e[i]():e[i];var f=void 0,p=c instanceof Map;if(r&&n)f=r;else if(r){var g=s.findTypeMetadata(r,u);if(g){var y={newObject:m,object:e,property:u},N=g.typeFunction?g.typeFunction(y):g.reflectedType;g.options&&g.options.discriminator&&g.options.discriminator.property&&g.options.discriminator.subTypes?e[i]instanceof Array?f=g:(d.transformationType===a.PLAIN_TO_CLASS&&(f=void 0===(f=g.options.discriminator.subTypes.find((function(t){if(c&&c instanceof Object&&g.options.discriminator.property in c)return t.name===c[g.options.discriminator.property]})))?N:f.value,!g.options.keepDiscriminatorProperty&&c&&c instanceof Object&&g.options.discriminator.property in c&&delete c[g.options.discriminator.property]),d.transformationType===a.CLASS_TO_CLASS&&(f=c.constructor),d.transformationType===a.CLASS_TO_PLAIN&&c&&(c[g.options.discriminator.property]=g.options.discriminator.subTypes.find((function(t){return t.value===c.constructor})).name)):f=N,p=p||g.reflectedType===Map}else if(d.options.targetMaps)d.options.targetMaps.filter((function(t){return t.target===r&&!!t.properties[u]})).forEach((function(t){return f=t.properties[u]}));else if(d.options.enableImplicitConversion&&d.transformationType===a.PLAIN_TO_CLASS){var b=Reflect.getMetadata("design:type",r.prototype,u);b&&(f=b)}}var v=Array.isArray(e[i])?d.getReflectedType(r,u):void 0,w=t?t[i]:void 0;if(m.constructor.prototype){var M=Object.getOwnPropertyDescriptor(m.constructor.prototype,l);if((d.transformationType===a.PLAIN_TO_CLASS||d.transformationType===a.CLASS_TO_CLASS)&&(M&&!M.set||m[l]instanceof Function))return}if(d.options.enableCircularCheck&&d.isCircular(c)){if(d.transformationType===a.CLASS_TO_CLASS){var _=c;(void 0!==(_=d.applyCustomTransformations(_,r,i,e,d.transformationType))||d.options.exposeUnsetFields)&&(m instanceof Map?m.set(l,_):m[l]=_)}}else{var I=d.transformationType===a.PLAIN_TO_CLASS?l:i;_=void 0;d.transformationType===a.CLASS_TO_PLAIN?(_=e[I],_=d.applyCustomTransformations(_,r,I,e,d.transformationType),_=e[I]===_?c:_,_=d.transform(w,_,f,v,p,o+1)):void 0===c&&d.options.exposeDefaultValues?_=m[l]:(_=d.transform(w,c,f,v,p,o+1),_=d.applyCustomTransformations(_,r,I,e,d.transformationType)),(void 0!==_||d.options.exposeUnsetFields)&&(m instanceof Map?m.set(l,_):m[l]=_)}}}(f[p]);return this.options.enableCircularCheck&&this.recursionStack.delete(e),m}return null==e?e:String(e)},t.prototype.applyCustomTransformations=function(t,e,r,i,n){var a=this,o=s.findTransformMetadatas(e,r,this.transformationType);return void 0!==this.options.version&&(o=o.filter((function(t){return!t.options||a.checkVersion(t.options.since,t.options.until)}))),(o=this.options.groups&&this.options.groups.length?o.filter((function(t){return!t.options||a.checkGroups(t.options.groups)})):o.filter((function(t){return!t.options||!t.options.groups||!t.options.groups.length}))).forEach((function(e){t=e.transformFn({value:t,key:r,obj:i,type:n,options:a.options})})),t},t.prototype.isCircular=function(t){return this.recursionStack.has(t)},t.prototype.getReflectedType=function(t,e){if(t){var r=s.findTypeMetadata(t,e);return r?r.reflectedType:void 0}},t.prototype.getKeys=function(t,e,r){var i=this,n=s.getStrategy(t);"none"===n&&(n=this.options.strategy||"exposeAll");var o=[];if(("exposeAll"===n||r)&&(o=e instanceof Map?Array.from(e.keys()):Object.keys(e)),r)return o;if(this.options.ignoreDecorators&&this.options.excludeExtraneousValues&&t){var u=s.getExposedProperties(t,this.transformationType),h=s.getExcludedProperties(t,this.transformationType);o=l(l([],u,!0),h,!0)}if(!this.options.ignoreDecorators&&t){u=s.getExposedProperties(t,this.transformationType);this.transformationType===a.PLAIN_TO_CLASS&&(u=u.map((function(e){var r=s.findExposeMetadata(t,e);return r&&r.options&&r.options.name?r.options.name:e}))),o=this.options.excludeExtraneousValues?u:o.concat(u);var c=s.getExcludedProperties(t,this.transformationType);c.length>0&&(o=o.filter((function(t){return!c.includes(t)}))),void 0!==this.options.version&&(o=o.filter((function(e){var r=s.findExposeMetadata(t,e);return!r||!r.options||i.checkVersion(r.options.since,r.options.until)}))),o=this.options.groups&&this.options.groups.length?o.filter((function(e){var r=s.findExposeMetadata(t,e);return!r||!r.options||i.checkGroups(r.options.groups)})):o.filter((function(e){var r=s.findExposeMetadata(t,e);return!(r&&r.options&&r.options.groups&&r.options.groups.length)}))}return this.options.excludePrefixes&&this.options.excludePrefixes.length&&(o=o.filter((function(t){return i.options.excludePrefixes.every((function(e){return t.substr(0,e.length)!==e}))}))),o.filter((function(t,e,r){return r.indexOf(t)===e}))},t.prototype.checkVersion=function(t,e){var r=!0;return t&&(r=this.options.version>=t),r&&e&&(r=this.options.version<e),r},t.prototype.checkGroups=function(t){return!t||this.options.groups.some((function(e){return t.includes(e)}))},t}(),h={enableCircularCheck:!1,enableImplicitConversion:!1,excludeExtraneousValues:!1,excludePrefixes:void 0,exposeDefaultValues:!1,exposeUnsetFields:!0,groups:void 0,ignoreDecorators:!1,strategy:void 0,targetMaps:void 0,version:void 0},c=function(){return(c=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},f=function(){function t(){}return t.prototype.instanceToPlain=function(t,e){return new u(a.CLASS_TO_PLAIN,c(c({},h),e)).transform(void 0,t,void 0,void 0,void 0,void 0)},t.prototype.classToPlainFromExist=function(t,e,r){return new u(a.CLASS_TO_PLAIN,c(c({},h),r)).transform(e,t,void 0,void 0,void 0,void 0)},t.prototype.plainToInstance=function(t,e,r){return new u(a.PLAIN_TO_CLASS,c(c({},h),r)).transform(void 0,e,t,void 0,void 0,void 0)},t.prototype.plainToClassFromExist=function(t,e,r){return new u(a.PLAIN_TO_CLASS,c(c({},h),r)).transform(t,e,void 0,void 0,void 0,void 0)},t.prototype.instanceToInstance=function(t,e){return new u(a.CLASS_TO_CLASS,c(c({},h),e)).transform(void 0,t,void 0,void 0,void 0,void 0)},t.prototype.classToClassFromExist=function(t,e,r){return new u(a.CLASS_TO_CLASS,c(c({},h),r)).transform(e,t,void 0,void 0,void 0,void 0)},t.prototype.serialize=function(t,e){return JSON.stringify(this.instanceToPlain(t,e))},t.prototype.deserialize=function(t,e,r){var i=JSON.parse(e);return this.plainToInstance(t,i,r)},t.prototype.deserializeArray=function(t,e,r){var i=JSON.parse(e);return this.plainToInstance(t,i,r)},t}();function m(t){return void 0===t&&(t={}),function(e,r){s.addExposeMetadata({target:e instanceof Function?e:e.constructor,propertyName:r,options:t})}}function d(t,e){return void 0===e&&(e={}),function(r,i){var n=Reflect.getMetadata("design:type",r,i);s.addTypeMetadata({target:r.constructor,propertyName:i,reflectedType:n,typeFunction:t,options:e})}}var p=new f;function g(t,e){return p.instanceToPlain(t,e)}function y(t,e,r){return p.plainToInstance(t,e,r)}class N{get size(){return this.map.size}get(t){let e=this.map.get(t);if(void 0!==e)return e!==this.first&&(e===this.last?(this.last=e.prev,this.last.next=void 0):(e.prev.next=e.next,e.next.prev=e.prev),e.next=this.first,this.first.prev=e,this.first=e),e.value}set(t,e){if(this.maxSize<1)return;if(this.map.has(t))throw Error("Cannot update existing keys in the cache");let r=new b(t,e);for(void 0===this.first?(this.first=r,this.last=r):(r.next=this.first,this.first.prev=r,this.first=r),this.map.set(t,r);this.map.size>this.maxSize;){let t=this.last;this.map.delete(t.key),this.last=t.prev,this.last.next=void 0}}constructor(t){this.map=new Map,this.first=void 0,this.last=void 0,this.maxSize=t}}class b{constructor(t,e){this.next=void 0,this.prev=void 0,this.key=t,this.value=e}}let v=[[["","U","D","T","Qa","Qt","Sx","Sp","Oc","No"],["","Dc","Vg","Tg","Qag","Qtg","Sxg","Spg","Ocg","Nog"],["","Ce","De","Te","Qae","Qte","Sxe","Spe","Oce","Noe"]],[["","Mi","Mc","Na","Pc","Fm","At","Zp","Yc","Xn"],["","Me","Du","Tr","Te","Pe","He","Hp","Ot","En"],["","c","Ic","TCn","TeC","PCn","HCn","HpC","OCn","ECn"],["","Hc","DHe","THt","TeH","PHc","HHe","HpH","OHt","EHc"]]];function w(t,e,r,i){var n,a=arguments.length,o=a<3?e:i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(o=(a<3?n(o):a>3?n(e,r,o):n(e,r))||o);return a>3&&o&&Object.defineProperty(e,r,o),o}function M(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}let _=Math.log10(9e15),I=1/9e15,T=function(){let t=[];for(let e=-323;e<=308;e++)t.push(Number("1e"+e));return function(e){return t[e+323]}}(),S=[2,Math.E,3,4,5,6,7,8,9,10],O=[[1,1.0891180521811203,1.1789767925673957,1.2701455431742086,1.3632090180450092,1.4587818160364217,1.5575237916251419,1.6601571006859253,1.767485818836978,1.8804192098842727,2],[1,1.1121114330934079,1.231038924931609,1.3583836963111375,1.4960519303993531,1.6463542337511945,1.8121385357018724,1.996971324618307,2.2053895545527546,2.4432574483385254,Math.E],[1,1.1187738849693603,1.2464963939368214,1.38527004705667,1.5376664685821402,1.7068895236551784,1.897001227148399,2.1132403089001035,2.362480153784171,2.6539010333870774,3],[1,1.1367350847096405,1.2889510672956703,1.4606478703324786,1.6570295196661111,1.8850062585672889,2.1539465047453485,2.476829779693097,2.872061932789197,3.3664204535587183,4],[1,1.1494592900767588,1.319708228183931,1.5166291280087583,1.748171114438024,2.0253263297298045,2.3636668498288547,2.7858359149579424,3.3257226212448145,4.035730287722532,5],[1,1.159225940787673,1.343712473580932,1.5611293155111927,1.8221199554561318,2.14183924486326,2.542468319282638,3.0574682501653316,3.7390572020926873,4.6719550537360774,6],[1,1.1670905356972596,1.3632807444991446,1.5979222279405536,1.8842640123816674,2.2416069644878687,2.69893426559423,3.3012632110403577,4.121250340630164,5.281493033448316,7],[1,1.1736630594087796,1.379783782386201,1.6292821855668218,1.9378971836180754,2.3289975651071977,2.8384347394720835,3.5232708454565906,4.478242031114584,5.868592169644505,8],[1,1.1793017514670474,1.394054150657457,1.65664127441059,1.985170999970283,2.4069682290577457,2.9647310119960752,3.7278665320924946,4.814462547283592,6.436522247411611,9],[1,1.1840100246247336,1.4061375836156955,1.6802272208863964,2.026757028388619,2.4770056063449646,3.080525271755482,3.9191964192627284,5.135152840833187,6.989961179534715,10]],x=[[-1,-.9194161097107025,-.8335625019330468,-.7425599821143978,-.6466611521029437,-.5462617907227869,-.4419033816638769,-.3342645487554494,-.224140440909962,-.11241087890006762,0],[-1,-.90603157029014,-.80786507256596,-.7064666939634,-.60294836853664,-.49849837513117,-.39430303318768,-.29147201034755,-.19097820800866,-.09361896280296,0],[-1,-.9021579584316141,-.8005762598234203,-.6964780623319391,-.5911906810998454,-.486050182576545,-.3823089430815083,-.28106046722897615,-.1831906535795894,-.08935809204418144,0],[-1,-.8917227442365535,-.781258746326964,-.6705130326902455,-.5612813129406509,-.4551067709033134,-.35319256652135966,-.2563741554088552,-.1651412821106526,-.0796919581982668,0],[-1,-.8843387974366064,-.7678744063886243,-.6529563724510552,-.5415870994657841,-.4352842206588936,-.33504449124791424,-.24138853420685147,-.15445285440944467,-.07409659641336663,0],[-1,-.8786709358426346,-.7577735191184886,-.6399546189952064,-.527284921869926,-.4211627631006314,-.3223479611761232,-.23107655627789858,-.1472057700818259,-.07035171210706326,0],[-1,-.8740862815291583,-.7497032990976209,-.6297119746181752,-.5161838335958787,-.41036238255751956,-.31277212146489963,-.2233976621705518,-.1418697367979619,-.06762117662323441,0],[-1,-.8702632331800649,-.7430366914122081,-.6213373075161548,-.5072025698095242,-.40171437727184167,-.30517930701410456,-.21736343968190863,-.137710238299109,-.06550774483471955,0],[-1,-.8670016295947213,-.7373984232432306,-.6143173985094293,-.49973884395492807,-.394584953527678,-.2989649949848695,-.21245647317021688,-.13434688362382652,-.0638072667348083,0],[-1,-.8641642839543857,-.732534623168535,-.6083127477059322,-.4934049257184696,-.3885773075899922,-.29376029055315767,-.2083678561173622,-.13155653399373268,-.062401588652553186,0]],A=function(t){return q.fromValue_noAlloc(t)},E=function(t,e,r){return q.fromComponents(t,e,r)},F=function(t,e,r){return q.fromComponents_noNormalize(t,e,r)},C=function(t,e){let r=e+1,i=Math.ceil(Math.log10(Math.abs(t)));return parseFloat((Math.round(t*Math.pow(10,r-i))*Math.pow(10,i-r)).toFixed(Math.max(r-i,0)))},P=function(t){return Math.sign(t)*Math.log10(Math.abs(t))},k=function(t,e=1e-10,r=!0){let i,n;if(!Number.isFinite(t))return t;if(r){if(0===t)return t;if(1===t)return.5671432904097838;i=t<10?0:Math.log(t)-Math.log(Math.log(t))}else{if(0===t)return-1/0;i=t<=-.1?-2:Math.log(-t)-Math.log(-Math.log(-t))}for(let r=0;r<100;++r){if(Math.abs((n=(t*Math.exp(-i)+i*i)/(i+1))-i)<e*Math.abs(n))return n;i=n}throw Error(`Iteration failed to converge: ${t.toString()}`)};function L(t,e=1e-10,r=!0){let i,n,a,o;if(!Number.isFinite(t.mag))return new q(t);if(r){if(t.eq(q.dZero))return F(0,0,0);if(t.eq(q.dOne))return q.fromNumber(.5671432904097838);i=q.ln(t)}else{if(t.eq(q.dZero))return F(-1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);i=q.ln(t.neg())}for(let r=0;r<100;++r){if(n=i.neg().exp(),a=i.sub(t.mul(n)),o=i.sub(a.div(i.add(1).sub(i.add(2).mul(a).div(q.mul(2,i).add(2))))),q.abs(o.sub(i)).lt(q.abs(o).mul(e)))return o;i=o}throw Error(`Iteration failed to converge: ${t.toString()}`)}class q{get m(){if(0===this.sign)return 0;if(0===this.layer){let t,e=Math.floor(Math.log10(this.mag));return t=5e-324===this.mag?5:this.mag/T(e),this.sign*t}if(1!==this.layer)return this.sign;{let t=this.mag-Math.floor(this.mag);return this.sign*Math.pow(10,t)}}set m(t){this.layer<=2?this.fromMantissaExponent(t,this.e):(this.sign=Math.sign(t),0===this.sign&&(this.layer=0,this.exponent=0))}get e(){return 0===this.sign?0:0===this.layer?Math.floor(Math.log10(this.mag)):1===this.layer?Math.floor(this.mag):2===this.layer?Math.floor(Math.sign(this.mag)*Math.pow(10,Math.abs(this.mag))):this.mag*Number.POSITIVE_INFINITY}set e(t){this.fromMantissaExponent(this.m,t)}get s(){return this.sign}set s(t){0===t?(this.sign=0,this.layer=0,this.mag=0):this.sign=t}get mantissa(){return this.m}set mantissa(t){this.m=t}get exponent(){return this.e}set exponent(t){this.e=t}static fromComponents(t,e,r){return(new q).fromComponents(t,e,r)}static fromComponents_noNormalize(t,e,r){return(new q).fromComponents_noNormalize(t,e,r)}static fromMantissaExponent(t,e){return(new q).fromMantissaExponent(t,e)}static fromMantissaExponent_noNormalize(t,e){return(new q).fromMantissaExponent_noNormalize(t,e)}static fromDecimal(t){return(new q).fromDecimal(t)}static fromNumber(t){return(new q).fromNumber(t)}static fromString(t,e=!1){return(new q).fromString(t,e)}static fromValue(t){return(new q).fromValue(t)}static fromValue_noAlloc(t){if(t instanceof q)return t;if("string"==typeof t){let e=q.fromStringCache.get(t);return void 0!==e?e:q.fromString(t)}return"number"==typeof t?q.fromNumber(t):F(0,0,0)}static abs(t){return A(t).abs()}static neg(t){return A(t).neg()}static negate(t){return A(t).neg()}static negated(t){return A(t).neg()}static sign(t){return A(t).sign}static sgn(t){return A(t).sign}static round(t){return A(t).round()}static floor(t){return A(t).floor()}static ceil(t){return A(t).ceil()}static trunc(t){return A(t).trunc()}static add(t,e){return A(t).add(e)}static plus(t,e){return A(t).add(e)}static sub(t,e){return A(t).sub(e)}static subtract(t,e){return A(t).sub(e)}static minus(t,e){return A(t).sub(e)}static mul(t,e){return A(t).mul(e)}static multiply(t,e){return A(t).mul(e)}static times(t,e){return A(t).mul(e)}static div(t,e){return A(t).div(e)}static divide(t,e){return A(t).div(e)}static recip(t){return A(t).recip()}static reciprocal(t){return A(t).recip()}static reciprocate(t){return A(t).reciprocate()}static mod(t,e,r=!1){return A(t).mod(e,r)}static modulo(t,e,r=!1){return A(t).modulo(e,r)}static modular(t,e,r=!1){return A(t).modular(e,r)}static cmp(t,e){return A(t).cmp(e)}static cmpabs(t,e){return A(t).cmpabs(e)}static compare(t,e){return A(t).cmp(e)}static isNaN(t){return isNaN((t=A(t)).sign)||isNaN(t.layer)||isNaN(t.mag)}static isFinite(t){return isFinite((t=A(t)).sign)&&isFinite(t.layer)&&isFinite(t.mag)}static eq(t,e){return A(t).eq(e)}static equals(t,e){return A(t).eq(e)}static neq(t,e){return A(t).neq(e)}static notEquals(t,e){return A(t).notEquals(e)}static lt(t,e){return A(t).lt(e)}static lte(t,e){return A(t).lte(e)}static gt(t,e){return A(t).gt(e)}static gte(t,e){return A(t).gte(e)}static max(t,e){return A(t).max(e)}static min(t,e){return A(t).min(e)}static minabs(t,e){return A(t).minabs(e)}static maxabs(t,e){return A(t).maxabs(e)}static clamp(t,e,r){return A(t).clamp(e,r)}static clampMin(t,e){return A(t).clampMin(e)}static clampMax(t,e){return A(t).clampMax(e)}static cmp_tolerance(t,e,r){return A(t).cmp_tolerance(e,r)}static compare_tolerance(t,e,r){return A(t).cmp_tolerance(e,r)}static eq_tolerance(t,e,r){return A(t).eq_tolerance(e,r)}static equals_tolerance(t,e,r){return A(t).eq_tolerance(e,r)}static neq_tolerance(t,e,r){return A(t).neq_tolerance(e,r)}static notEquals_tolerance(t,e,r){return A(t).notEquals_tolerance(e,r)}static lt_tolerance(t,e,r){return A(t).lt_tolerance(e,r)}static lte_tolerance(t,e,r){return A(t).lte_tolerance(e,r)}static gt_tolerance(t,e,r){return A(t).gt_tolerance(e,r)}static gte_tolerance(t,e,r){return A(t).gte_tolerance(e,r)}static pLog10(t){return A(t).pLog10()}static absLog10(t){return A(t).absLog10()}static log10(t){return A(t).log10()}static log(t,e){return A(t).log(e)}static log2(t){return A(t).log2()}static ln(t){return A(t).ln()}static logarithm(t,e){return A(t).logarithm(e)}static pow(t,e){return A(t).pow(e)}static pow10(t){return A(t).pow10()}static root(t,e){return A(t).root(e)}static factorial(t,e){return A(t).factorial()}static gamma(t,e){return A(t).gamma()}static lngamma(t,e){return A(t).lngamma()}static exp(t){return A(t).exp()}static sqr(t){return A(t).sqr()}static sqrt(t){return A(t).sqrt()}static cube(t){return A(t).cube()}static cbrt(t){return A(t).cbrt()}static tetrate(t,e=2,r=F(1,0,1),i=!1){return A(t).tetrate(e,r,i)}static iteratedexp(t,e=2,r=F(1,0,1),i=!1){return A(t).iteratedexp(e,r,i)}static iteratedlog(t,e=10,r=1,i=!1){return A(t).iteratedlog(e,r,i)}static layeradd10(t,e,r=!1){return A(t).layeradd10(e,r)}static layeradd(t,e,r=10,i=!1){return A(t).layeradd(e,r,i)}static slog(t,e=10,r=!1){return A(t).slog(e,100,r)}static lambertw(t,e){return A(t).lambertw(e)}static ssqrt(t){return A(t).ssqrt()}static linear_sroot(t,e){return A(t).linear_sroot(e)}static pentate(t,e=2,r=F(1,0,1),i=!1){return A(t).pentate(e,r,i)}static penta_log(t,e=10,r=!1){return A(t).penta_log(e,100,r)}static linear_penta_root(t,e){return A(t).linear_penta_root(e)}static sin(t){return A(t).sin()}static cos(t){return A(t).cos()}static tan(t){return A(t).tan()}static asin(t){return A(t).asin()}static acos(t){return A(t).acos()}static atan(t){return A(t).atan()}static sinh(t){return A(t).sinh()}static cosh(t){return A(t).cosh()}static tanh(t){return A(t).tanh()}static asinh(t){return A(t).asinh()}static acosh(t){return A(t).acosh()}static atanh(t){return A(t).atanh()}static affordGeometricSeries(t,e,r,i){return this.affordGeometricSeries_core(A(t),A(e),A(r),i)}static sumGeometricSeries(t,e,r,i){return this.sumGeometricSeries_core(t,A(e),A(r),i)}static affordArithmeticSeries(t,e,r,i){return this.affordArithmeticSeries_core(A(t),A(e),A(r),A(i))}static sumArithmeticSeries(t,e,r,i){return this.sumArithmeticSeries_core(A(t),A(e),A(r),A(i))}static efficiencyOfPurchase(t,e,r){return this.efficiencyOfPurchase_core(A(t),A(e),A(r))}static randomDecimalForTesting(t){if(20*Math.random()<1)return F(0,0,0);let e=Math.random()>.5?1:-1;if(20*Math.random()<1)return F(e,0,1);let r=Math.floor(Math.random()*(t+1)),i=0===r?616*Math.random()-308:16*Math.random();Math.random()>.9&&(i=Math.trunc(i));let n=Math.pow(10,i);return Math.random()>.9&&(n=Math.trunc(n)),E(e,r,n)}static affordGeometricSeries_core(t,e,r,i){let n=e.mul(r.pow(i));return q.floor(t.div(n).mul(r.sub(1)).add(1).log10().div(r.log10()))}static sumGeometricSeries_core(t,e,r,i){return e.mul(r.pow(i)).mul(q.sub(1,r.pow(t))).div(q.sub(1,r))}static affordArithmeticSeries_core(t,e,r,i){let n=e.add(i.mul(r)).sub(r.div(2)),a=n.pow(2);return n.neg().add(a.add(r.mul(t).mul(2)).sqrt()).div(r).floor()}static sumArithmeticSeries_core(t,e,r,i){let n=e.add(i.mul(r));return t.div(2).mul(n.mul(2).plus(t.sub(1).mul(r)))}static efficiencyOfPurchase_core(t,e,r){return t.div(e).add(t.div(r))}normalize(){if(0===this.sign||0===this.mag&&0===this.layer||this.mag===Number.NEGATIVE_INFINITY&&this.layer>0&&Number.isFinite(this.layer))return this.sign=0,this.mag=0,this.layer=0,this;if(0===this.layer&&this.mag<0&&(this.mag=-this.mag,this.sign=-this.sign),this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY||this.mag===Number.NEGATIVE_INFINITY||this.layer===Number.NEGATIVE_INFINITY)return this.mag=Number.POSITIVE_INFINITY,this.layer=Number.POSITIVE_INFINITY,this;if(0===this.layer&&this.mag<I)return this.layer+=1,this.mag=Math.log10(this.mag),this;let t=Math.abs(this.mag),e=Math.sign(this.mag);if(t>=9e15)return this.layer+=1,this.mag=e*Math.log10(t),this;for(;t<_&&this.layer>0;)this.layer-=1,0===this.layer?this.mag=Math.pow(10,this.mag):(this.mag=e*Math.pow(10,t),t=Math.abs(this.mag),e=Math.sign(this.mag));return 0===this.layer&&(this.mag<0?(this.mag=-this.mag,this.sign=-this.sign):0===this.mag&&(this.sign=0)),(Number.isNaN(this.sign)||Number.isNaN(this.layer)||Number.isNaN(this.mag))&&(this.sign=Number.NaN,this.layer=Number.NaN,this.mag=Number.NaN),this}fromComponents(t,e,r){return this.sign=t,this.layer=e,this.mag=r,this.normalize(),this}fromComponents_noNormalize(t,e,r){return this.sign=t,this.layer=e,this.mag=r,this}fromMantissaExponent(t,e){return this.layer=1,this.sign=Math.sign(t),t=Math.abs(t),this.mag=e+Math.log10(t),this.normalize(),this}fromMantissaExponent_noNormalize(t,e){return this.fromMantissaExponent(t,e),this}fromDecimal(t){return this.sign=t.sign,this.layer=t.layer,this.mag=t.mag,this}fromNumber(t){return this.mag=Math.abs(t),this.sign=Math.sign(t),this.layer=0,this.normalize(),this}fromString(t,e=!1){let r,i,n=t,a=q.fromStringCache.get(n);if(void 0!==a)return this.fromDecimal(a);let o=(t=t.replace(",","")).split("^^^");if(2===o.length){let t=parseFloat(o[0]),r=parseFloat(o[1]),i=o[1].split(";"),a=1;if(2!==i.length||isFinite(a=parseFloat(i[1]))||(a=1),isFinite(t)&&isFinite(r)){let i=q.pentate(t,r,a,e);return this.sign=i.sign,this.layer=i.layer,this.mag=i.mag,q.fromStringCache.maxSize>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),this}}let s=t.split("^^");if(2===s.length){let t=parseFloat(s[0]),r=parseFloat(s[1]),i=s[1].split(";"),a=1;if(2!==i.length||isFinite(a=parseFloat(i[1]))||(a=1),isFinite(t)&&isFinite(r)){let i=q.tetrate(t,r,a,e);return this.sign=i.sign,this.layer=i.layer,this.mag=i.mag,q.fromStringCache.maxSize>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),this}}let l=t.split("^");if(2===l.length){let t=parseFloat(l[0]),e=parseFloat(l[1]);if(isFinite(t)&&isFinite(e)){let r=q.pow(t,e);return this.sign=r.sign,this.layer=r.layer,this.mag=r.mag,q.fromStringCache.maxSize>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),this}}let u=(t=t.trim().toLowerCase()).split("pt");if(2===u.length||2===(u=t.split("p")).length){r=10;let t=!1;u[0].startsWith("-")&&(t=!0,u[0]=u[0].slice(1)),i=parseFloat(u[0]),u[1]=u[1].replace("(",""),u[1]=u[1].replace(")","");let a=parseFloat(u[1]);if(isFinite(a)||(a=1),isFinite(r)&&isFinite(i)){let o=q.tetrate(r,i,a,e);return this.sign=o.sign,this.layer=o.layer,this.mag=o.mag,q.fromStringCache.maxSize>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),t&&(this.sign*=-1),this}}if(2===(u=t.split("f")).length){r=10;let t=!1;u[0].startsWith("-")&&(t=!0,u[0]=u[0].slice(1)),u[0]=u[0].replace("(",""),u[0]=u[0].replace(")","");let a=parseFloat(u[0]);if(u[1]=u[1].replace("(",""),u[1]=u[1].replace(")",""),i=parseFloat(u[1]),isFinite(a)||(a=1),isFinite(r)&&isFinite(i)){let o=q.tetrate(r,i,a,e);return this.sign=o.sign,this.layer=o.layer,this.mag=o.mag,q.fromStringCache.maxSize>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),t&&(this.sign*=-1),this}}let h=t.split("e"),c=h.length-1;if(0===c){let e=parseFloat(t);if(isFinite(e))return this.fromNumber(e),q.fromStringCache.size>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),this}else if(1===c){let e=parseFloat(t);if(isFinite(e)&&0!==e)return this.fromNumber(e),q.fromStringCache.maxSize>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),this}let f=t.split("e^");if(2===f.length){this.sign=1,f[0].startsWith("-")&&(this.sign=-1);let t="";for(let r=0;r<f[1].length;++r){let i=f[1].charCodeAt(r);if(!(i>=43&&i<=57||101===i)){if(this.layer=parseFloat(t),this.mag=parseFloat(f[1].substr(r+1)),this.layer<0||this.layer%1!=0){let t=q.tetrate(10,this.layer,this.mag,e);this.sign=t.sign,this.layer=t.layer,this.mag=t.mag}return this.normalize(),q.fromStringCache.maxSize>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),this}t+=f[1].charAt(r)}}if(c<1)return this.sign=0,this.layer=0,this.mag=0,q.fromStringCache.maxSize>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),this;let m=parseFloat(h[0]);if(0===m)return this.sign=0,this.layer=0,this.mag=0,q.fromStringCache.maxSize>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),this;let d=parseFloat(h[h.length-1]);if(c>=2){let t=parseFloat(h[h.length-2]);isFinite(t)&&(d*=Math.sign(t),d+=P(t))}if(isFinite(m))if(1===c)this.sign=Math.sign(m),this.layer=1,this.mag=d+Math.log10(Math.abs(m));else{if(this.sign=Math.sign(m),this.layer=c,2===c){let t=q.mul(E(1,2,d),A(m));return this.sign=t.sign,this.layer=t.layer,this.mag=t.mag,q.fromStringCache.maxSize>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),this}this.mag=d}else this.sign="-"===h[0]?-1:1,this.layer=c,this.mag=d;return this.normalize(),q.fromStringCache.maxSize>=1&&q.fromStringCache.set(n,q.fromDecimal(this)),this}fromValue(t){return t instanceof q?this.fromDecimal(t):"number"==typeof t?this.fromNumber(t):"string"==typeof t?this.fromString(t):(this.sign=0,this.layer=0,this.mag=0,this)}toNumber(){return this.mag===Number.POSITIVE_INFINITY&&this.layer===Number.POSITIVE_INFINITY&&1===this.sign?Number.POSITIVE_INFINITY:this.mag===Number.POSITIVE_INFINITY&&this.layer===Number.POSITIVE_INFINITY&&-1===this.sign?Number.NEGATIVE_INFINITY:Number.isFinite(this.layer)?0===this.layer?this.sign*this.mag:1===this.layer?this.sign*Math.pow(10,this.mag):this.mag>0?this.sign>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:0:Number.NaN}mantissaWithDecimalPlaces(t){return isNaN(this.m)?Number.NaN:0===this.m?0:C(this.m,t)}magnitudeWithDecimalPlaces(t){return isNaN(this.mag)?Number.NaN:0===this.mag?0:C(this.mag,t)}toString(){return isNaN(this.layer)||isNaN(this.sign)||isNaN(this.mag)?"NaN":this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY?1===this.sign?"Infinity":"-Infinity":0===this.layer?this.mag<1e21&&this.mag>1e-7||0===this.mag?(this.sign*this.mag).toString():this.m+"e"+this.e:1===this.layer?this.m+"e"+this.e:this.layer<=5?(-1===this.sign?"-":"")+"e".repeat(this.layer)+this.mag:(-1===this.sign?"-":"")+"(e^"+this.layer+")"+this.mag}toExponential(t){return 0===this.layer?(this.sign*this.mag).toExponential(t):this.toStringWithDecimalPlaces(t)}toFixed(t){return 0===this.layer?(this.sign*this.mag).toFixed(t):this.toStringWithDecimalPlaces(t)}toPrecision(t){return this.e<=-7?this.toExponential(t-1):t>this.e?this.toFixed(t-this.exponent-1):this.toExponential(t-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(t){return 0===this.layer?this.mag<1e21&&this.mag>1e-7||0===this.mag?(this.sign*this.mag).toFixed(t):C(this.m,t)+"e"+C(this.e,t):1===this.layer?C(this.m,t)+"e"+C(this.e,t):this.layer<=5?(-1===this.sign?"-":"")+"e".repeat(this.layer)+C(this.mag,t):(-1===this.sign?"-":"")+"(e^"+this.layer+")"+C(this.mag,t)}abs(){return F(0===this.sign?0:1,this.layer,this.mag)}neg(){return F(-this.sign,this.layer,this.mag)}negate(){return this.neg()}negated(){return this.neg()}sgn(){return this.sign}round(){return this.mag<0?F(0,0,0):0===this.layer?E(this.sign,0,Math.round(this.mag)):new q(this)}floor(){return this.mag<0?-1===this.sign?F(-1,0,1):F(0,0,0):-1===this.sign?this.neg().ceil().neg():0===this.layer?E(this.sign,0,Math.floor(this.mag)):new q(this)}ceil(){return this.mag<0?1===this.sign?F(1,0,1):F(0,0,0):-1===this.sign?this.neg().floor().neg():0===this.layer?E(this.sign,0,Math.ceil(this.mag)):new q(this)}trunc(){return this.mag<0?F(0,0,0):0===this.layer?E(this.sign,0,Math.trunc(this.mag)):new q(this)}add(t){let e,r,i=A(t);if(this.eq(q.dInf)&&i.eq(q.dNegInf)||this.eq(q.dNegInf)&&i.eq(q.dInf))return F(Number.NaN,Number.NaN,Number.NaN);if(!Number.isFinite(this.layer))return new q(this);if(!Number.isFinite(i.layer)||0===this.sign)return new q(i);if(0===i.sign)return new q(this);if(this.sign===-i.sign&&this.layer===i.layer&&this.mag===i.mag)return F(0,0,0);if(this.layer>=2||i.layer>=2)return this.maxabs(i);if(q.cmpabs(this,i)>0?(e=new q(this),r=new q(i)):(e=new q(i),r=new q(this)),0===e.layer&&0===r.layer)return q.fromNumber(e.sign*e.mag+r.sign*r.mag);let n=e.layer*Math.sign(e.mag),a=r.layer*Math.sign(r.mag);if(n-a>=2)return e;if(0===n&&-1===a){if(Math.abs(r.mag-Math.log10(e.mag))>17)return e;{let t=Math.pow(10,Math.log10(e.mag)-r.mag),i=r.sign+e.sign*t;return E(Math.sign(i),1,r.mag+Math.log10(Math.abs(i)))}}if(1===n&&0===a){if(Math.abs(e.mag-Math.log10(r.mag))>17)return e;{let t=Math.pow(10,e.mag-Math.log10(r.mag)),i=r.sign+e.sign*t;return E(Math.sign(i),1,Math.log10(r.mag)+Math.log10(Math.abs(i)))}}if(Math.abs(e.mag-r.mag)>17)return e;{let t=Math.pow(10,e.mag-r.mag),i=r.sign+e.sign*t;return E(Math.sign(i),1,r.mag+Math.log10(Math.abs(i)))}}plus(t){return this.add(t)}sub(t){return this.add(A(t).neg())}subtract(t){return this.sub(t)}minus(t){return this.sub(t)}mul(t){let e,r,i=A(t);if(this.eq(q.dInf)&&i.eq(q.dNegInf)||this.eq(q.dNegInf)&&i.eq(q.dInf))return F(-1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);if(this.mag==Number.POSITIVE_INFINITY&&i.eq(q.dZero)||this.eq(q.dZero)&&this.mag==Number.POSITIVE_INFINITY)return F(Number.NaN,Number.NaN,Number.NaN);if(!Number.isFinite(this.layer))return new q(this);if(!Number.isFinite(i.layer))return new q(i);if(0===this.sign||0===i.sign)return F(0,0,0);if(this.layer===i.layer&&this.mag===-i.mag)return F(this.sign*i.sign,0,1);if(this.layer>i.layer||this.layer==i.layer&&Math.abs(this.mag)>Math.abs(i.mag)?(e=new q(this),r=new q(i)):(e=new q(i),r=new q(this)),0===e.layer&&0===r.layer)return q.fromNumber(e.sign*r.sign*e.mag*r.mag);if(e.layer>=3||e.layer-r.layer>=2)return E(e.sign*r.sign,e.layer,e.mag);if(1===e.layer&&0===r.layer)return E(e.sign*r.sign,1,e.mag+Math.log10(r.mag));if(1===e.layer&&1===r.layer)return E(e.sign*r.sign,1,e.mag+r.mag);if(2===e.layer&&1===r.layer||2===e.layer&&2===r.layer){let t=E(Math.sign(e.mag),e.layer-1,Math.abs(e.mag)).add(E(Math.sign(r.mag),r.layer-1,Math.abs(r.mag)));return E(e.sign*r.sign,t.layer+1,t.sign*t.mag)}throw Error("Bad arguments to mul: "+this+", "+t)}multiply(t){return this.mul(t)}times(t){return this.mul(t)}div(t){let e=A(t);return this.mul(e.recip())}divide(t){return this.div(t)}divideBy(t){return this.div(t)}dividedBy(t){return this.div(t)}recip(){return 0===this.mag?F(Number.NaN,Number.NaN,Number.NaN):this.mag===Number.POSITIVE_INFINITY?F(0,0,0):0===this.layer?E(this.sign,0,1/this.mag):E(this.sign,this.layer,-this.mag)}reciprocal(){return this.recip()}reciprocate(){return this.recip()}mod(t,e=!1){let r=A(t),i=r.abs();if(this.eq(q.dZero)||i.eq(q.dZero))return F(0,0,0);if(e){let t=this.abs().mod(i);return-1==this.sign!=(-1==r.sign)&&(t=r.abs().sub(t)),t.mul(r.sign)}let n=this.toNumber(),a=i.toNumber();return isFinite(n)&&isFinite(a)&&0!=n&&0!=a?new q(n%a):this.sub(i).eq(this)?F(0,0,0):i.sub(this).eq(i)?new q(this):-1==this.sign?this.abs().mod(i).neg():this.sub(this.div(i).floor().mul(i))}modulo(t,e=!1){return this.mod(t,e)}modular(t,e=!1){return this.mod(t,e)}cmp(t){let e=A(t);return this.sign>e.sign?1:this.sign<e.sign?-1:this.sign*this.cmpabs(t)}cmpabs(t){let e=A(t),r=this.mag>0?this.layer:-this.layer,i=e.mag>0?e.layer:-e.layer;return r>i?1:r<i?-1:this.mag>e.mag?1:this.mag<e.mag?-1:0}compare(t){return this.cmp(t)}isNan(){return isNaN(this.sign)||isNaN(this.layer)||isNaN(this.mag)}isFinite(){return isFinite(this.sign)&&isFinite(this.layer)&&isFinite(this.mag)}eq(t){let e=A(t);return this.sign===e.sign&&this.layer===e.layer&&this.mag===e.mag}equals(t){return this.eq(t)}neq(t){return!this.eq(t)}notEquals(t){return this.neq(t)}lt(t){return-1===this.cmp(t)}lte(t){return!this.gt(t)}gt(t){return 1===this.cmp(t)}gte(t){return!this.lt(t)}max(t){let e=A(t);return new q(this.lt(e)?e:this)}min(t){let e=A(t);return new q(this.gt(e)?e:this)}maxabs(t){let e=A(t);return new q(0>this.cmpabs(e)?e:this)}minabs(t){let e=A(t);return new q(this.cmpabs(e)>0?e:this)}clamp(t,e){return this.max(t).min(e)}clampMin(t){return this.max(t)}clampMax(t){return this.min(t)}cmp_tolerance(t,e){let r=A(t);return this.eq_tolerance(r,e)?0:this.cmp(r)}compare_tolerance(t,e){return this.cmp_tolerance(t,e)}eq_tolerance(t,e){let r=A(t);if(null==e&&(e=1e-7),this.sign!==r.sign||Math.abs(this.layer-r.layer)>1)return!1;let i=this.mag,n=r.mag;return this.layer>r.layer&&(n=P(n)),this.layer<r.layer&&(i=P(i)),Math.abs(i-n)<=e*Math.max(Math.abs(i),Math.abs(n))}equals_tolerance(t,e){return this.eq_tolerance(t,e)}neq_tolerance(t,e){return!this.eq_tolerance(t,e)}notEquals_tolerance(t,e){return this.neq_tolerance(t,e)}lt_tolerance(t,e){let r=A(t);return!this.eq_tolerance(r,e)&&this.lt(r)}lte_tolerance(t,e){let r=A(t);return this.eq_tolerance(r,e)||this.lt(r)}gt_tolerance(t,e){let r=A(t);return!this.eq_tolerance(r,e)&&this.gt(r)}gte_tolerance(t,e){let r=A(t);return this.eq_tolerance(r,e)||this.gt(r)}pLog10(){return this.lt(q.dZero)?F(0,0,0):this.log10()}absLog10(){return 0===this.sign?F(Number.NaN,Number.NaN,Number.NaN):this.layer>0?E(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):E(1,0,Math.log10(this.mag))}log10(){return this.sign<=0?F(Number.NaN,Number.NaN,Number.NaN):this.layer>0?E(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):E(this.sign,0,Math.log10(this.mag))}log(t){return t=A(t),this.sign<=0||t.sign<=0||1===t.sign&&0===t.layer&&1===t.mag?F(Number.NaN,Number.NaN,Number.NaN):0===this.layer&&0===t.layer?E(this.sign,0,Math.log(this.mag)/Math.log(t.mag)):q.div(this.log10(),t.log10())}log2(){return this.sign<=0?F(Number.NaN,Number.NaN,Number.NaN):0===this.layer?E(this.sign,0,Math.log2(this.mag)):1===this.layer?E(Math.sign(this.mag),0,3.321928094887362*Math.abs(this.mag)):2===this.layer?E(Math.sign(this.mag),1,Math.abs(this.mag)+.5213902276543247):E(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}ln(){return this.sign<=0?F(Number.NaN,Number.NaN,Number.NaN):0===this.layer?E(this.sign,0,Math.log(this.mag)):1===this.layer?E(Math.sign(this.mag),0,2.302585092994046*Math.abs(this.mag)):2===this.layer?E(Math.sign(this.mag),1,Math.abs(this.mag)+.36221568869946325):E(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}logarithm(t){return this.log(t)}pow(t){let e=A(t),r=new q(this),i=new q(e);if(0===r.sign)return i.eq(0)?F(1,0,1):r;if(1===r.sign&&0===r.layer&&1===r.mag)return r;if(0===i.sign)return F(1,0,1);if(1===i.sign&&0===i.layer&&1===i.mag)return r;let n=r.absLog10().mul(i).pow10();return-1===this.sign?Math.abs(i.toNumber()%2)%2==1?n.neg():Math.abs(i.toNumber()%2)%2==0?n:F(Number.NaN,Number.NaN,Number.NaN):n}pow10(){if(this.eq(q.dInf))return F(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);if(this.eq(q.dNegInf))return F(0,0,0);if(!Number.isFinite(this.layer)||!Number.isFinite(this.mag))return F(Number.NaN,Number.NaN,Number.NaN);let t=new q(this);if(0===t.layer){let e=Math.pow(10,t.sign*t.mag);if(Number.isFinite(e)&&Math.abs(e)>=.1)return E(1,0,e);if(0===t.sign)return F(1,0,1);t=F(t.sign,t.layer+1,Math.log10(t.mag))}return t.sign>0&&t.mag>=0?E(t.sign,t.layer+1,t.mag):t.sign<0&&t.mag>=0?E(-t.sign,t.layer+1,-t.mag):F(1,0,1)}pow_base(t){return A(t).pow(this)}root(t){let e=A(t);return this.pow(e.recip())}factorial(){return this.mag<0||0===this.layer?this.add(1).gamma():1===this.layer?q.exp(q.mul(this,q.ln(this).sub(1))):q.exp(this)}gamma(){if(this.mag<0)return this.recip();if(0===this.layer){let t;if(this.lt(F(1,0,24)))return q.fromNumber(function(t){let e;if(!isFinite(t))return t;if(t<-50)return t===Math.trunc(t)?Number.NEGATIVE_INFINITY:0;let r=1;for(;t<10;)r*=t,++t;e=.9189385332046727+(.5+(t-=1))*Math.log(t)-t;let i=t*t,n=t;return e+=1/(12*n),n*=i,e-=1/(360*n),n*=i,e+=1/(1260*n),n*=i,e-=1/(1680*n),n*=i,e+=1/(1188*n),n*=i,e-=691/(360360*n),n*=i,e+=7/(1092*n),n*=i,Math.exp(e-=3617/(122400*n))/r}(this.sign*this.mag));let e=this.mag-1;t=.9189385332046727+(e+.5)*Math.log(e)-e;let r=e*e,i=e,n=12*i,a=1/n,o=t+a;if(o===t||(t=o,i*=r,(o=t-(a=1/(n=360*i)))===t))return q.exp(t);t=o,i*=r;let s=1/(n=1260*i);return t+=s,i*=r,t-=s=1/(n=1680*i),q.exp(t)}return 1===this.layer?q.exp(q.mul(this,q.ln(this).sub(1))):q.exp(this)}lngamma(){return this.gamma().ln()}exp(){return this.mag<0?F(1,0,1):0===this.layer&&this.mag<=709.7?q.fromNumber(Math.exp(this.sign*this.mag)):0===this.layer?E(1,1,this.sign*Math.log10(Math.E)*this.mag):1===this.layer?E(1,2,this.sign*(Math.log10(.4342944819032518)+this.mag)):E(1,this.layer+1,this.sign*this.mag)}sqr(){return this.pow(2)}sqrt(){if(0===this.layer)return q.fromNumber(Math.sqrt(this.sign*this.mag));if(1===this.layer)return E(1,2,Math.log10(this.mag)-.3010299956639812);{let t=q.div(F(this.sign,this.layer-1,this.mag),F(1,0,2));return t.layer+=1,t.normalize(),t}}cube(){return this.pow(3)}cbrt(){return this.pow(1/3)}tetrate(t=2,e=F(1,0,1),r=!1){if(1===t)return q.pow(this,e);if(0===t)return new q(e);if(this.eq(q.dOne))return F(1,0,1);if(this.eq(-1))return q.pow(this,e);if(t===Number.POSITIVE_INFINITY){let t=this.toNumber();if(t<=1.444667861009766&&t>=.06598803584531254){let r=q.ln(this).neg(),i=r.lambertw().div(r);if(t<1)return i;let n=r.lambertw(!1).div(r);return t>1.444667861009099&&(i=n=q.fromNumber(Math.E)),(e=A(e)).eq(n)?n:e.lt(n)?i:F(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY)}return t>1.444667861009766?F(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY):F(Number.NaN,Number.NaN,Number.NaN)}if(this.eq(q.dZero)){let e=Math.abs((t+1)%2);return e>1&&(e=2-e),q.fromNumber(e)}if(t<0)return q.iteratedlog(e,this,-t,r);e=new q(e);let i=t,n=i-(t=Math.trunc(t));if(this.gt(q.dZero)&&(this.lt(1)||this.lte(1.444667861009766)&&e.lte(q.ln(this).neg().lambertw(!1).div(q.ln(this).neg())))&&(i>1e4||!r)){let r=Math.min(1e4,t);e=e.eq(q.dOne)?this.pow(n):this.lt(1)?e.pow(1-n).mul(this.pow(e).pow(n)):e.layeradd(n,this);for(let t=0;t<r;++t){let t=e;if(e=this.pow(e),t.eq(e))return e}return i>1e4&&Math.ceil(i)%2==1?this.pow(e):e}0!==n&&(e.eq(q.dOne)?this.gt(10)||r?e=this.pow(n):(e=q.fromNumber(q.tetrate_critical(this.toNumber(),n)),this.lt(2)&&(e=e.sub(1).mul(this.minus(1)).plus(1))):e=this.eq(10)?e.layeradd10(n,r):this.lt(1)?e.pow(1-n).mul(this.pow(e).pow(n)):e.layeradd(n,this,r));for(let r=0;r<t;++r){if(!isFinite((e=this.pow(e)).layer)||!isFinite(e.mag))return e.normalize();if(e.layer-this.layer>3)return F(e.sign,e.layer+(t-r-1),e.mag);if(r>1e4)break}return e}iteratedexp(t=2,e=F(1,0,1),r=!1){return this.tetrate(t,e,r)}iteratedlog(t=10,e=1,r=!1){if(e<0)return q.tetrate(t,-e,this,r);t=A(t);let i=q.fromDecimal(this),n=e-(e=Math.trunc(e));if(i.layer-t.layer>3){let r=Math.min(e,i.layer-t.layer-3);e-=r,i.layer-=r}for(let r=0;r<e;++r){if(!isFinite((i=i.log(t)).layer)||!isFinite(i.mag))return i.normalize();if(r>1e4)return i}return n>0&&n<1&&(i=t.eq(10)?i.layeradd10(-n,r):i.layeradd(-n,t,r)),i}slog(t=10,e=100,r=!1){let i=.001,n=!1,a=!1,o=this.slog_internal(t,r).toNumber();for(let s=1;s<e;++s){let e=new q(t).tetrate(o,q.dOne,r).gt(this);if(s>1&&a!=e&&(n=!0),a=e,n?i/=2:i*=2,o+=i=Math.abs(i)*(e?-1:1),0===i)break}return q.fromNumber(o)}slog_internal(t=10,e=!1){if((t=A(t)).lte(q.dZero)||t.eq(q.dOne))return F(Number.NaN,Number.NaN,Number.NaN);if(t.lt(q.dOne))return this.eq(q.dOne)?F(0,0,0):this.eq(q.dZero)?F(-1,0,1):F(Number.NaN,Number.NaN,Number.NaN);if(this.mag<0||this.eq(q.dZero))return F(-1,0,1);if(t.lt(1.444667861009766)){let e=q.ln(t).neg(),r=e.lambertw().div(e);if(this.eq(r))return F(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);if(this.gt(r))return F(Number.NaN,Number.NaN,Number.NaN)}let r=0,i=q.fromDecimal(this);if(i.layer-t.layer>3){let e=i.layer-t.layer-3;r+=e,i.layer-=e}for(let n=0;n<100;++n)if(i.lt(q.dZero))i=q.pow(t,i),r-=1;else{if(i.lte(q.dOne))return e?q.fromNumber(r+i.toNumber()-1):q.fromNumber(r+q.slog_critical(t.toNumber(),i.toNumber()));r+=1,i=q.log(i,t)}return q.fromNumber(r)}static slog_critical(t,e){return t>10?e-1:q.critical_section(t,e,x)}static tetrate_critical(t,e){return q.critical_section(t,e,O)}static critical_section(t,e,r,i=!1){(e*=10)<0&&(e=0),e>10&&(e=10),t<2&&(t=2),t>10&&(t=10);let n=0,a=0;for(let i=0;i<S.length;++i){if(S[i]==t){n=r[i][Math.floor(e)],a=r[i][Math.ceil(e)];break}if(S[i]<t&&S[i+1]>t){let o=(t-S[i])/(S[i+1]-S[i]);n=r[i][Math.floor(e)]*(1-o)+r[i+1][Math.floor(e)]*o,a=r[i][Math.ceil(e)]*(1-o)+r[i+1][Math.ceil(e)]*o;break}}let o=e-Math.floor(e);return n<=0||a<=0?n*(1-o)+a*o:Math.pow(t,Math.log(n)/Math.log(t)*(1-o)+Math.log(a)/Math.log(t)*o)}layeradd10(t,e=!1){t=q.fromValue_noAlloc(t).toNumber();let r=q.fromDecimal(this);if(t>=1){r.mag<0&&r.layer>0?(r.sign=0,r.mag=0,r.layer=0):-1===r.sign&&0==r.layer&&(r.sign=1,r.mag=-r.mag);let e=Math.trunc(t);t-=e,r.layer+=e}if(t<=-1){let e=Math.trunc(t);if(t-=e,r.layer+=e,r.layer<0)for(let t=0;t<100;++t){if(r.layer++,r.mag=Math.log10(r.mag),!isFinite(r.mag))return 0===r.sign&&(r.sign=1),r.layer<0&&(r.layer=0),r.normalize();if(r.layer>=0)break}}for(;r.layer<0;)r.layer++,r.mag=Math.log10(r.mag);return 0===r.sign&&(r.sign=1,0===r.mag&&r.layer>=1&&(r.layer-=1,r.mag=1)),r.normalize(),0!==t?r.layeradd(t,10,e):r}layeradd(t,e,r=!1){let i=A(e);if(i.gt(1)&&i.lte(1.444667861009766)){let n=q.excess_slog(this,e,r),a=n[0].toNumber(),o=n[1],s=a+t,l=q.ln(e).neg(),u=l.lambertw().div(l),h=l.lambertw(!1).div(l),c=q.dOne;1==o?c=u.mul(h).sqrt():2==o&&(c=h.mul(2));let f=i.pow(c),m=Math.floor(s),d=s-m,p=c.pow(1-d).mul(f.pow(d));return q.tetrate(i,m,p,r)}let n=this.slog(e,100,r).toNumber()+t;return n>=0?q.tetrate(e,n,q.dOne,r):Number.isFinite(n)?n>=-1?q.log(q.tetrate(e,n+1,q.dOne,r),e):q.log(q.log(q.tetrate(e,n+2,q.dOne,r),e),e):F(Number.NaN,Number.NaN,Number.NaN)}static excess_slog(t,e,r=!1){t=A(t);let i=e=A(e);if(1==(e=e.toNumber())||e<=0)return[F(Number.NaN,Number.NaN,Number.NaN),0];if(e>1.444667861009766)return[t.slog(e,100,r),0];let n=q.ln(e).neg(),a=n.lambertw().div(n),o=q.dInf;if(e>1&&(o=n.lambertw(!1).div(n)),e>1.444667861009099&&(a=o=q.fromNumber(Math.E)),t.lt(a))return[t.slog(e,100,r),0];if(t.eq(a))return[F(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),0];if(t.eq(o))return[F(1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),2];if(t.gt(o)){let n=o.mul(2),a=i.pow(n),s=0;if(t.gte(n)&&t.lt(a))s=0;else if(t.gte(a)){let n=a;for(s=1;n.lt(t);)if(n=i.pow(n),s+=1,n.layer>3){let e=Math.floor(t.layer-n.layer+1);n=i.iteratedexp(e,n,r),s+=e}n.gt(t)&&(n=n.log(e),s-=1)}else if(t.lt(n)){let r=n;for(s=0;r.gt(t);)r=r.log(e),s-=1}let l=0,u=0,h=.5,c=n,f=q.dZero;for(;h>1e-16;){if(u=l+h,c=n.pow(1-u).mul(a.pow(u)),(f=q.iteratedexp(e,s,c)).eq(t))return[new q(s+u),2];f.lt(t)&&(l+=h),h/=2}return f.neq_tolerance(t,1e-7)?[F(Number.NaN,Number.NaN,Number.NaN),0]:[new q(s+l),2]}if(t.lt(o)&&t.gt(a)){let r=a.mul(o).sqrt(),n=i.pow(r),s=0;if(t.lte(r)&&t.gt(n))s=0;else if(t.lte(n)){let r=n;for(s=1;r.gt(t);)r=i.pow(r),s+=1;r.lt(t)&&(r=r.log(e),s-=1)}else if(t.gt(r)){let i=r;for(s=0;i.lt(t);)i=i.log(e),s-=1}let l=0,u=0,h=.5,c=r,f=q.dZero;for(;h>1e-16;){if(u=l+h,c=r.pow(1-u).mul(n.pow(u)),(f=q.iteratedexp(e,s,c)).eq(t))return[new q(s+u),1];f.gt(t)&&(l+=h),h/=2}return f.neq_tolerance(t,1e-7)?[F(Number.NaN,Number.NaN,Number.NaN),0]:[new q(s+l),1]}throw Error("Unhandled behavior in excess_slog")}lambertw(t=!0){return this.lt(-.3678794411710499)?F(Number.NaN,Number.NaN,Number.NaN):t?this.abs().lt("1e-300")?new q(this):this.mag<0?q.fromNumber(k(this.toNumber())):0===this.layer?q.fromNumber(k(this.sign*this.mag)):this.lt("eee15")?L(this):this.ln():1===this.sign?F(Number.NaN,Number.NaN,Number.NaN):0===this.layer?q.fromNumber(k(this.sign*this.mag,1e-10,!1)):1==this.layer?L(this,1e-10,!1):this.neg().recip().lambertw().neg()}ssqrt(){return this.linear_sroot(2)}linear_sroot(t){if(1==t)return this;if(this.eq(q.dInf))return F(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);if(!this.isFinite())return F(Number.NaN,Number.NaN,Number.NaN);if(t>0&&t<1)return this.root(t);if(t>-2&&t<-1)return q.fromNumber(t).add(2).pow(this.recip());if(t<=0)return F(Number.NaN,Number.NaN,Number.NaN);if(t==Number.POSITIVE_INFINITY){let t=this.toNumber();return t<Math.E&&t>.36787944117144233?this.pow(this.recip()):F(Number.NaN,Number.NaN,Number.NaN)}if(this.eq(1))return F(1,0,1);if(this.lt(0))return F(Number.NaN,Number.NaN,Number.NaN);if(this.lte("1ee-16"))return t%2==1?new q(this):F(Number.NaN,Number.NaN,Number.NaN);if(this.gt(1)){let e=q.dTen;this.gte(q.tetrate(10,t,1,!0))&&(e=this.iteratedlog(10,t-1,!0)),t<=1&&(e=this.root(t));let r=q.dZero,i=e.layer,n=e.iteratedlog(10,i,!0),a=n,o=n.div(2),s=!0;for(;s;)o=r.add(n).div(2),q.iteratedexp(10,i,o,!0).tetrate(t,1,!0).gt(this)?n=o:r=o,o.eq(a)?s=!1:a=o;return q.iteratedexp(10,i,o,!0)}{let e=1,r=E(1,10,1),i=E(1,10,1),n=E(1,10,1),a=E(1,1,-16),o=q.dZero,s=E(1,10,1),l=a.pow10().recip(),u=q.dZero,h=l,c=l,f=Math.ceil(t)%2==0,m=0,d=E(1,10,1),p=!1,g=q.dZero,y=!1;for(;e<4;){if(2==e){if(f)break;n=E(1,10,1),a=r,e=3,s=E(1,10,1),d=E(1,10,1)}for(p=!1;a.neq(n);){if(g=a,a.pow10().recip().tetrate(t,1,!0).eq(1)&&a.pow10().recip().lt(.4))l=a.pow10().recip(),h=a.pow10().recip(),c=a.pow10().recip(),u=q.dZero,m=-1,3==e&&(d=a);else if(a.pow10().recip().tetrate(t,1,!0).eq(a.pow10().recip())&&!f&&a.pow10().recip().lt(.4))l=a.pow10().recip(),h=a.pow10().recip(),c=a.pow10().recip(),u=q.dZero,m=0;else if(a.pow10().recip().tetrate(t,1,!0).eq(a.pow10().recip().mul(2).tetrate(t,1,!0)))l=a.pow10().recip(),h=q.dZero,c=l.mul(2),u=l,m=f?-1:0;else{for(o=a.mul(12e-17),l=a.pow10().recip(),h=a.add(o).pow10().recip(),u=l.sub(h),c=l.add(u);h.tetrate(t,1,!0).eq(l.tetrate(t,1,!0))||c.tetrate(t,1,!0).eq(l.tetrate(t,1,!0))||h.gte(l)||c.lte(l);)o=o.mul(2),h=a.add(o).pow10().recip(),u=l.sub(h),c=l.add(u);if((1==e&&c.tetrate(t,1,!0).gt(l.tetrate(t,1,!0))&&h.tetrate(t,1,!0).gt(l.tetrate(t,1,!0))||3==e&&c.tetrate(t,1,!0).lt(l.tetrate(t,1,!0))&&h.tetrate(t,1,!0).lt(l.tetrate(t,1,!0)))&&(d=a),c.tetrate(t,1,!0).lt(l.tetrate(t,1,!0)))m=-1;else if(f)m=1;else if(3==e&&a.gt_tolerance(r,1e-8))m=0;else{for(;h.tetrate(t,1,!0).eq_tolerance(l.tetrate(t,1,!0),1e-8)||c.tetrate(t,1,!0).eq_tolerance(l.tetrate(t,1,!0),1e-8)||h.gte(l)||c.lte(l);)o=o.mul(2),h=a.add(o).pow10().recip(),u=l.sub(h),c=l.add(u);m=c.tetrate(t,1,!0).sub(l.tetrate(t,1,!0)).lt(l.tetrate(t,1,!0).sub(h.tetrate(t,1,!0)))?0:1}}if(-1==m&&(y=!0),1==e&&1==m||3==e&&0!=m)if(n.eq(E(1,10,1)))a=a.mul(2);else{let t=!1;if(p&&(1==m&&1==e||-1==m&&3==e)&&(t=!0),a=a.add(n).div(2),t)break}else if(n.eq(E(1,10,1)))n=a,a=a.div(2);else{let t=!1;if(p&&(1==m&&1==e||-1==m&&3==e)&&(t=!0),n=n.sub(s),a=a.sub(s),t)break}if(n.sub(a).div(2).abs().gt(s.mul(1.5))&&(p=!0),s=n.sub(a).div(2).abs(),a.gt("1e18")||a.eq(g))break}if(a.gt("1e18")||!y||d==E(1,10,1))break;1==e?r=d:3==e&&(i=d),e++}n=r;let N=a=E(1,1,-18),b=q.dZero,v=!0;for(;v;)if(b=n.eq(E(1,10,1))?a.mul(2):n.add(a).div(2),q.pow(10,b).recip().tetrate(t,1,!0).gt(this)?a=b:n=b,b.eq(N)?v=!1:N=b,a.gt("1e18"))return F(Number.NaN,Number.NaN,Number.NaN);if(!b.eq_tolerance(r,1e-15))return b.pow10().recip();if(i.eq(E(1,10,1)))return F(Number.NaN,Number.NaN,Number.NaN);for(n=E(1,10,1),N=a=i,b=q.dZero,v=!0;v;)if(b=n.eq(E(1,10,1))?a.mul(2):n.add(a).div(2),q.pow(10,b).recip().tetrate(t,1,!0).gt(this)?a=b:n=b,b.eq(N)?v=!1:N=b,a.gt("1e18"))return F(Number.NaN,Number.NaN,Number.NaN);return b.pow10().recip()}}static increasingInverse(t,e=!1,r=120,i=q.dLayerMax.neg(),n=q.dLayerMax,a=q.dLayerMax.neg(),o=q.dLayerMax){return function(s){let l;if(s=new q(s),i=new q(i),n=new q(n),a=new q(a),o=new q(o),s.isNan()||n.lt(i)||s.lt(a)||s.gt(o))return F(Number.NaN,Number.NaN,Number.NaN);let u=function(t){return new q(t)},h=!0;if(n.lt(0))h=!1;else if(i.gt(0))h=!0;else{let r=t(q.dZero);if(r.eq(s))return F(0,0,0);h=s.gt(r),e&&(h=!h)}let c=h;if(h){if(n.lt(I))h=!0;else if(i.gt(I))h=!1;else{let r=t(new q(I));h=s.lt(r),e&&(h=!h)}if(h){l=!0;let r=q.pow(10,9e15).recip();if(n.lt(r))h=!1;else if(i.gt(r))h=!0;else{let i=t(new q(r));h=s.gt(i),e&&(h=!h)}if(h)u=function(t){return q.pow(10,t).recip()};else{let r=q.tetrate(10,9e15);if(n.lt(r))h=!1;else if(i.gt(r))h=!0;else{let i=t(new q(r));h=s.gt(i),e&&(h=!h)}u=h?function(t){return q.tetrate(10,new q(t).toNumber()).recip()}:function(t){return new q(t).gt(Math.log10(Number.MAX_VALUE))?q.dZero:q.tetrate(10,q.pow(10,t).toNumber()).recip()}}}else{if(l=!1,n.lt(9e15))h=!0;else if(i.gt(9e15))h=!1;else{let r=t(new q(9e15));h=s.lt(r),e&&(h=!h)}if(h)u=function(t){return new q(t)};else{let r=q.pow(10,9e15);if(n.lt(r))h=!0;else if(i.gt(r))h=!1;else{let i=t(new q(r));h=s.lt(i),e&&(h=!h)}if(h)u=function(t){return q.pow(10,t)};else{let r=q.tetrate(10,9e15);if(n.lt(r))h=!0;else if(i.gt(r))h=!1;else{let i=t(new q(r));h=s.lt(i),e&&(h=!h)}u=h?function(t){return q.tetrate(10,new q(t).toNumber())}:function(t){return new q(t).gt(Math.log10(Number.MAX_VALUE))?q.dInf:q.tetrate(10,q.pow(10,t).toNumber())}}}}}else{if(l=!0,n.lt(-I))h=!1;else if(i.gt(-I))h=!0;else{let r=t(new q(-I));h=s.gt(r),e&&(h=!h)}if(h){let r=q.pow(10,9e15).recip().neg();if(n.lt(r))h=!0;else if(i.gt(r))h=!1;else{let i=t(new q(r));h=s.lt(i),e&&(h=!h)}if(h)u=function(t){return q.pow(10,t).recip().neg()};else{let r=q.tetrate(10,9e15).neg();if(n.lt(r))h=!0;else if(i.gt(r))h=!1;else{let i=t(new q(r));h=s.lt(i),e&&(h=!h)}u=h?function(t){return q.tetrate(10,new q(t).toNumber()).recip().neg()}:function(t){return new q(t).gt(Math.log10(Number.MAX_VALUE))?q.dZero:q.tetrate(10,q.pow(10,t).toNumber()).recip().neg()}}}else{if(l=!1,n.lt(-9e15))h=!1;else if(i.gt(-9e15))h=!0;else{let r=t(new q(-9e15));h=s.gt(r),e&&(h=!h)}if(h)u=function(t){return q.neg(t)};else{let r=q.pow(10,9e15).neg();if(n.lt(r))h=!1;else if(i.gt(r))h=!0;else{let i=t(new q(r));h=s.gt(i),e&&(h=!h)}if(h)u=function(t){return q.pow(10,t).neg()};else{let r=q.tetrate(10,9e15).neg();if(n.lt(r))h=!1;else if(i.gt(r))h=!0;else{let i=t(new q(r));h=s.gt(i),e&&(h=!h)}u=h?function(t){return q.tetrate(10,new q(t).toNumber()).neg()}:function(t){return new q(t).gt(Math.log10(Number.MAX_VALUE))?q.dNegInf:q.tetrate(10,q.pow(10,t).toNumber()).neg()}}}}}let f=c!=l!=e,m=f?function(t,e){return q.gt(t,e)}:function(t,e){return q.lt(t,e)},d=.001,p=!1,g=!1,y=1,N=q.dOne,b=0,v=!1;for(var w=1;w<r;++w){v=!1,b=y,(N=u(y)).gt(n)&&(N=n,v=!0),N.lt(i)&&(N=i,v=!0);let e=t(N);if(e.eq(s)&&!v)break;let r=m(e,s);if(w>1&&g!=r&&(p=!0),g=r,p?d/=2:d*=2,r!=f&&N.eq(n)||r==f&&N.eq(i))return F(Number.NaN,Number.NaN,Number.NaN);if(y+=d=Math.abs(d)*(r?-1:1),0===d||b==y)break}return u(y)}}pentate(t=2,e=F(1,0,1),r=!1){e=new q(e);let i=t,n=i-(t=Math.floor(t)),a=q.dZero,o=q.dZero;if(0!==n){if(!e.eq(q.dOne))return this.pentate(e.penta_log(this,void 0,r).plus(i).toNumber(),1,r);++t,e=q.fromNumber(n)}if(t>0)for(let i=0;i<t;){if(o=a,a=e,e=this.tetrate(e.toNumber(),q.dOne,r),++i,this.gt(0)&&this.lte(1)&&e.gt(0)&&e.lte(1))return this.tetrate(t-i,e,r);if(e.eq(a)||e.eq(o)&&i%2==t%2||!isFinite(e.layer)||!isFinite(e.mag))return e.normalize();if(i>1e4)break}else for(let i=0;i<-t;++i){if(a=e,(e=e.slog(this,void 0,r)).eq(a)||!isFinite(e.layer)||!isFinite(e.mag))return e.normalize();if(i>100)break}return e}penta_log(t=10,e=100,r=!1){if((t=new q(t)).lte(1))return F(Number.NaN,Number.NaN,Number.NaN);if(this.eq(1))return F(0,0,0);if(this.eq(q.dInf))return F(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);let i=new q(1),n=0,a=1;if(this.lt(-1)){if(this.lte(-2))return F(Number.NaN,Number.NaN,Number.NaN);let e=t.tetrate(this.toNumber(),1,r);if(this.eq(e))return F(-1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);if(this.gt(e))return F(Number.NaN,Number.NaN,Number.NaN)}if(this.gt(1)){for(;i.lt(this);)if(n++,i=q.tetrate(t,i.toNumber(),1,r),n>1e3)return F(Number.NaN,Number.NaN,Number.NaN)}else for(;i.gt(this);)if(n--,i=q.slog(i,t,r),n>100)return F(Number.NaN,Number.NaN,Number.NaN);for(var o=1;o<e;++o){let e=t.pentate(n,q.dOne,r);if(e.eq(this)||(n+=a=Math.abs(a)*(e.gt(this)?-1:1),0==(a/=2)))break}return q.fromNumber(n)}linear_penta_root(t){return 1==t?this:t<0?F(Number.NaN,Number.NaN,Number.NaN):this.eq(q.dInf)?F(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY):this.isFinite()?t>0&&t<1?this.root(t):this.eq(1)?F(1,0,1):this.lt(0)?F(Number.NaN,Number.NaN,Number.NaN):this.lt(1)?this.linear_sroot(t):q.increasingInverse((function(e){return q.pentate(e,t,1,!0)}))(this):F(Number.NaN,Number.NaN,Number.NaN)}sin(){return this.mag<0?new q(this):0===this.layer?q.fromNumber(Math.sin(this.sign*this.mag)):F(0,0,0)}cos(){return this.mag<0?F(1,0,1):0===this.layer?q.fromNumber(Math.cos(this.sign*this.mag)):F(0,0,0)}tan(){return this.mag<0?new q(this):0===this.layer?q.fromNumber(Math.tan(this.sign*this.mag)):F(0,0,0)}asin(){return this.mag<0?new q(this):0===this.layer?q.fromNumber(Math.asin(this.sign*this.mag)):F(Number.NaN,Number.NaN,Number.NaN)}acos(){return this.mag<0?q.fromNumber(Math.acos(this.toNumber())):0===this.layer?q.fromNumber(Math.acos(this.sign*this.mag)):F(Number.NaN,Number.NaN,Number.NaN)}atan(){return this.mag<0?new q(this):0===this.layer?q.fromNumber(Math.atan(this.sign*this.mag)):q.fromNumber(Math.atan(Infinity*this.sign))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return q.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return q.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?F(Number.NaN,Number.NaN,Number.NaN):q.ln(this.add(1).div(q.fromNumber(1).sub(this))).div(2)}ascensionPenalty(t){return 0===t?new q(this):this.root(q.pow(10,t))}egg(){return this.add(9)}lessThanOrEqualTo(t){return 1>this.cmp(t)}lessThan(t){return 0>this.cmp(t)}greaterThanOrEqualTo(t){return this.cmp(t)>-1}greaterThan(t){return this.cmp(t)>0}static smoothDamp(t,e,r,i){return new q(t).add(new q(e).minus(new q(t)).times(new q(r)).times(new q(i)))}clone(){return this}static clone(t){return q.fromComponents(t.sign,t.layer,t.mag)}softcap(t,e,r){let i=this.clone();return i.gte(t)&&([0,"pow"].includes(r)&&(i=i.div(t).pow(e).mul(t)),[1,"mul"].includes(r)&&(i=i.sub(t).div(e).add(t))),i}static softcap(t,e,r,i){return new q(t).softcap(e,r,i)}scale(t,e,r,i=!1){t=new q(t),e=new q(e);let n=this.clone();return n.gte(t)&&([0,"pow"].includes(r)&&(n=i?n.mul(t.pow(e.sub(1))).root(e):n.pow(e).div(t.pow(e.sub(1)))),[1,"exp"].includes(r)&&(n=i?n.div(t).max(1).log(e).add(t):q.pow(e,n.sub(t)).mul(t))),n}static scale(t,e,r,i,n=!1){return new q(t).scale(e,r,i,n)}format(t=2,e=9,r="mixed_sc"){return D.format(this.clone(),t,e,r)}static format(t,e=2,r=9,i="mixed_sc"){return D.format(new q(t),e,r,i)}formatST(t=2,e=9,r="st"){return D.format(this.clone(),t,e,r)}static formatST(t,e=2,r=9,i="st"){return D.format(new q(t),e,r,i)}formatGain(t,e="mixed_sc",r,i){return D.formatGain(this.clone(),t,e,r,i)}static formatGain(t,e,r="mixed_sc",i,n){return D.formatGain(new q(t),e,r,i,n)}toRoman(t=5e3){t=new q(t);let e=this.clone();if(e.gte(t)||e.lt(1))return e;let r=e.toNumber(),i={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},n="";for(let t of Object.keys(i)){let e=Math.floor(r/i[t]);r-=e*i[t],n+=t.repeat(e)}return n}static toRoman(t,e){return new q(t).toRoman(e)}static random(t=0,e=1){return t=new q(t),e=new q(e),t=t.lt(e)?t:e,e=e.gt(t)?e:t,new q(Math.random()).mul(e.sub(t)).add(t)}static randomProb(t){return new q(Math.random()).lt(t)}constructor(t){this.sign=0,this.mag=0,this.layer=0,t instanceof q?this.fromDecimal(t):"number"==typeof t?this.fromNumber(t):"string"==typeof t&&this.fromString(t)}}var j;q.dZero=F(0,0,0),q.dOne=F(1,0,1),q.dNegOne=F(-1,0,1),q.dTwo=F(1,0,2),q.dTen=F(1,0,10),q.dNaN=F(Number.NaN,Number.NaN,Number.NaN),q.dInf=F(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),q.dNegInf=F(-1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),q.dNumberMax=E(1,0,Number.MAX_VALUE),q.dNumberMin=E(1,0,Number.MIN_VALUE),q.dLayerSafeMax=E(1,Number.MAX_SAFE_INTEGER,8999999999999999),q.dLayerSafeMin=E(1,Number.MAX_SAFE_INTEGER,-8999999999999999),q.dLayerMax=E(1,Number.MAX_VALUE,8999999999999999),q.dLayerMin=E(1,Number.MAX_VALUE,-8999999999999999),q.fromStringCache=new N(1023),w([m()],q.prototype,"sign",void 0),w([m()],q.prototype,"mag",void 0),w([m()],q.prototype,"layer",void 0),q=w([(void 0===j&&(j={}),function(t,e){s.addExcludeMetadata({target:t instanceof Function?t:t.constructor,propertyName:e,options:j})}),M("design:type",Function),M("design:paramtypes",["undefined"==typeof DecimalSource?Object:DecimalSource])],q);let{formats:D}=function(t){let e={omega:{config:{greek:"βζλψΣΘΨω",infinity:"Ω"},format(r){r=new t(r);let n=t.floor(r.div(1e3)),a=t.floor(n.div(e.omega.config.greek.length)),o=e.omega.config.greek[n.toNumber()%e.omega.config.greek.length]+i(r.toNumber()%1e3);(void 0===e.omega.config.greek[n.toNumber()%e.omega.config.greek.length]||n.toNumber()>Number.MAX_SAFE_INTEGER)&&(o="ω");let s=t.log(r,8e3).toNumber();if(a.equals(0))return o;if(a.gt(0)&&a.lte(3)){let t=[];for(let e=0;e<a.toNumber();e++)t.push("ω");return`${t.join("^")}^${o}`}if(a.gt(3)&&a.lt(10))return`ω(${a.toFixed(0)})^${o}`;if(s<3)return`ω(${e.omega.format(a)})^${o}`;if(s<6)return`ω(${e.omega.format(a)})`;let l=t.pow(8e3,s%1);return`ω[${s<100?Math.floor(s).toFixed(0):e.omega.format(t.floor(s))}](${e.omega.format(l)})`}},omega_short:{config:{greek:"βζλψΣΘΨω",infinity:"Ω"},format(r){r=new t(r);let n=t.floor(r.div(1e3)),a=t.floor(n.div(e.omega_short.config.greek.length)),o=e.omega_short.config.greek[n.toNumber()%e.omega_short.config.greek.length]+i(r.toNumber()%1e3);(void 0===e.omega_short.config.greek[n.toNumber()%e.omega_short.config.greek.length]||n.toNumber()>Number.MAX_SAFE_INTEGER)&&(o="ω");let s=t.log(r,8e3).toNumber();if(a.equals(0))return o;if(a.gt(0)&&a.lte(2)){let t=[];for(let e=0;e<a.toNumber();e++)t.push("ω");return`${t.join("^")}^${o}`}if(a.gt(2)&&a.lt(10))return`ω(${a.toFixed(0)})^${o}`;let l=t.pow(8e3,s%1);return`ω[${s<100?Math.floor(s).toFixed(0):e.omega_short.format(t.floor(s))}](${e.omega_short.format(l)})`}},elemental:{config:{element_lists:[["H"],["He","Li","Be","B","C","N","O","F"],["Ne","Na","Mg","Al","Si","P","S","Cl"],["Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br"],["Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I"],["Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At"],["Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Nh","Fl","Mc","Lv","Ts"],["Og"]]},getOffset(t){if(1==t)return 1;let e=Math.floor(t/2),r=2*e*(e+1)*(2*e+1)/3-2;return t%2==1&&(r+=2*Math.pow(e+1,2)),r},getAbbreviation(t,r){let i=Math.floor(e.elemental.abbreviationLength(t)*r),n=i+e.elemental.getOffset(t);return n>118?e.elemental.beyondOg(n):e.elemental.config.element_lists[t-1][i]},beyondOg(t){let e=["n","u","b","t","q","p","h","s","o","e"],r="";for(let i=Math.floor(Math.log10(t));i>=0;i--){let n=Math.floor(t/Math.pow(10,i))%10;""==r?r=e[n].toUpperCase():r+=e[n]}return r},abbreviationLength:t=>1==t?1:2*Math.pow(Math.floor(t/2)+1,2),getAbbreviationAndValue(r){let i=r.log(118).toNumber(),n=Math.floor(i)+1,a=e.elemental.abbreviationLength(n),o=i-n+1,s=Math.floor(o*a);return[e.elemental.getAbbreviation(n,o),new t(118).pow(n+s/a-1)]},formatElementalPart:(t,e)=>e.eq(1)?t:`${e.toString()} ${t}`,format(r,i=2){if(r.gt(new t(118).pow(new t(118).pow(new t(118).pow(4)))))return"e"+e.elemental.format(r.log10(),i);let n=r.log(118),a=Math.max(4-2*n.log(118).log(118).toNumber(),1),o=[];for(;n.gte(1)&&o.length<a;){let[t,r]=e.elemental.getAbbreviationAndValue(n),i=n.div(r).floor();n=n.sub(i.mul(r)),o.unshift([t,i])}if(o.length>=a)return o.map((t=>e.elemental.formatElementalPart(t[0],t[1]))).join(" + ");let s=new t(118).pow(n).toFixed(1===o.length?3:i);return 0===o.length?s:1===o.length?`${s} × ${e.elemental.formatElementalPart(o[0][0],o[0][1])}`:`${s} × (${o.map((t=>e.elemental.formatElementalPart(t[0],t[1]))).join(" + ")})`}},old_sc:{format(r,i){let n=(r=new t(r)).log10().floor();if(n.lt(9))return n.lt(3)?r.toFixed(i):r.floor().toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");{if(r.gte("eeee10")){let i=r.slog();return(i.gte(1e9)?"":t.dTen.pow(i.sub(i.floor())).toFixed(4))+"F"+e.old_sc.format(i.floor(),0)}let i=r.div(t.dTen.pow(n));return(n.log10().gte(9)?"":i.toFixed(4))+"e"+e.old_sc.format(n,0)}}},eng:{format(r,i=2){let n=(r=new t(r)).log10().floor();if(n.lt(9))return n.lt(3)?r.toFixed(i):r.floor().toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");{if(r.gte("eeee10")){let i=r.slog();return(i.gte(1e9)?"":t.dTen.pow(i.sub(i.floor())).toFixed(4))+"F"+e.eng.format(i.floor(),0)}let i=r.div(new t(1e3).pow(n.div(3).floor()));return(n.log10().gte(9)?"":i.toFixed(new t(4).sub(n.sub(n.div(3).floor().mul(3))).toNumber()))+"e"+e.eng.format(n.div(3).floor().mul(3),0)}}},mixed_sc:{format(e,r,i=9){let a=(e=new t(e)).log10().floor();return a.lt(303)&&a.gte(i)?n(e,r,i,"st"):n(e,r,i,"sc")}},layer:{layers:["infinity","eternity","reality","equality","affinity","celerity","identity","vitality","immunity","atrocity"],format(i,a=2,o){let s=(i=new t(i)).max(1).log10().max(1).log(r.log10()).floor();if(s.lte(0))return n(i,a,o,"sc");i=t.dTen.pow(i.max(1).log10().div(r.log10().pow(s)).sub(s.gte(1)?1:0));let l=s.div(10).floor(),u=s.toNumber()%10-1;return n(i,Math.max(4,a),o,"sc")+" "+(l.gte(1)?"meta"+(l.gte(2)?"^"+n(l,0,o,"sc"):"")+"-":"")+(isNaN(u)?"nanity":e.layer.layers[u])}},standard:{tier1:t=>v[0][0][t%10]+v[0][1][Math.floor(t/10)%10]+v[0][2][Math.floor(t/100)],tier2(t){let e=t%10,r=Math.floor(t/10)%10,i=Math.floor(t/100)%10,n="";return t<10?v[1][0][t]:(n+=1==r&&0==e?"Vec":v[1][1][e]+v[1][2][r],n+=v[1][3][i])}},inf:{format(e,r,i){e=new t(e);let a=0,o=new t(Number.MAX_VALUE),s=["","∞","Ω","Ψ","ʊ"],l=["","","m","mm","mmm"];for(;e.gte(o);)e=e.log(o),a++;return 0==a?n(e,r,i,"sc"):e.gte(3)?l[a]+s[a]+"ω^"+n(e.sub(1),r,i,"sc"):e.gte(2)?l[a]+"ω"+s[a]+"-"+n(o.pow(e.sub(2)),r,i,"sc"):l[a]+s[a]+"-"+n(o.pow(e.sub(1)),r,i,"sc")}},alphabet:{config:{alphabet:"abcdefghijklmnopqrstuvwxyz"},getAbbreviation(r,i=new t(1e15),n=!1,a=9){if(r=new t(r),i=new t(i).div(1e3),r.lt(i.mul(1e3)))return"";let{alphabet:o}=e.alphabet.config,s=o.length,l=r.log(1e3).sub(i.log(1e3)).floor(),u=l.add(1).log(s+1).ceil(),h="",c=(t,e)=>{let r=t,i="";for(let t=0;t<e.toNumber();t++){let t=r.sub(1).mod(s).toNumber();if(t<0||t>=s)return"ω";i=o[t]+i,r=r.sub(1).div(s).floor()}return i};if(u.lt(a))h=c(l,u);else{let e=u.sub(a).add(1);h=`${c(l.div(t.pow(s+1,e.sub(1))).floor(),new t(a))}(${e.gt("1e9")?e.format():e.format(0)})`}return h},format(r,i=2,a=9,o="mixed_sc",s=new t(1e15),l=!1,u){if(r=new t(r),s=new t(s).div(1e3),r.lt(s.mul(1e3)))return n(r,i,a,o);let h=e.alphabet.getAbbreviation(r,s,l,u),c=r.div(t.pow(1e3,r.log(1e3).floor()));return`${h.length>(u??9)+2?"":c.toFixed(i)+" "}${h}`}}},r=t.dTwo.pow(1024);function i(t){return t.toFixed(0).split("").map((t=>"-"===t?"₋":"₀₁₂₃₄₅₆₇₈₉"[parseInt(t,10)])).join("")}function n(r,i=2,a=9,o="mixed_sc"){let s=(r=new t(r)).lt(0)?"-":"";if(r.mag==1/0)return s+"Infinity";if(Number.isNaN(r.mag))return s+"NaN";if(r.lt(0)&&(r=r.mul(-1)),r.eq(0))return r.toFixed(i);let l=r.log10().floor();switch(o){case"sc":case"scientific":if(r.log10().lt(Math.min(-i,0))&&i>1){let e=r.log10().ceil(),i=r.div(e.eq(-1)?new t(.1):t.dTen.pow(e));return s+(e.mul(-1).max(1).log10().gte(9)?"":i.toFixed(2))+"e"+n(e,0,a,"mixed_sc")}if(l.lt(a)){let t=Math.max(Math.min(i-l.toNumber(),i),0);return s+(t>0?r.toFixed(t):r.toFixed(t).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"))}{if(r.gte("eeee10")){let e=r.slog();return(e.gte(1e9)?"":t.dTen.pow(e.sub(e.floor())).toFixed(2))+"F"+n(e.floor(),0)}let e=r.div(t.dTen.pow(l));return s+(l.log10().gte(9)?"":e.toFixed(2))+"e"+n(l,0,a,"mixed_sc")}case"st":case"standard":{let o=r.log(1e3).floor();if(o.lt(1))return s+r.toFixed(Math.max(Math.min(i-l.toNumber(),i),0));let u=o.mul(3),h=o.log10().floor();if(h.gte(3e3))return"e"+n(l,i,a,"st");let c="";if(o.lt(4))c=["","K","M","B"][Math.round(o.toNumber())];else{let r=Math.floor(o.log(1e3).toNumber());for(r<100&&(r=Math.max(r-1,0)),o=o.sub(1).div(t.dTen.pow(3*r));o.gt(0);){let t=o.div(1e3).floor(),i=o.sub(t.mul(1e3)).floor().toNumber();i>0&&(1!=i||r||(c="U"),r&&(c=e.standard.tier2(r)+(c?"-"+c:"")),i>1&&(c=e.standard.tier1(i)+c)),o=t,r++}}let f=r.div(t.dTen.pow(u)),m=2===i?t.dTwo.sub(l.sub(u)).add(1).toNumber():i;return s+(h.gte(10)?"":f.toFixed(m)+" ")+c}default:return e[o]||console.error('Invalid format type "',o,'"'),s+e[o].format(r,i,a)}}function a(e,r=0){e=new t(e);let i=[{name:"K",altName:"Kilo"},{name:"M",altName:"Mega"},{name:"G",altName:"Giga"},{name:"T",altName:"Tera"},{name:"P",altName:"Peta"},{name:"Decimal",altName:"Exa"},{name:"Z",altName:"Zetta"},{name:"Y",altName:"Yotta"},{name:"R",altName:"Ronna"},{name:"Q",altName:"Quetta"}].map(((e,r)=>({name:e.name,altName:e.altName,value:t.pow(1e3,new t(r).add(1))}))),n="",a=e.lte(0)?0:t.min(t.log(e,1e3).sub(1),i.length-1).floor().toNumber(),o=i[a];switch(0===a&&(n=1===r?"":e.format()),r){case 1:n=o.name;break;case 2:n=e.divide(o.value).format();break;case 3:n=o.altName;break;default:n=`${e.divide(o.value).format()} ${o.name}`}return n}let o={...e,toSubscript:i,toSuperscript:function(t){return t.toFixed(0).split("").map((t=>"-"===t?"₋":"⁰¹²³⁴⁵⁶⁷⁸⁹"[parseInt(t,10)])).join("")},formatST:function(t,e=2,r=9,i="st"){return n(t,e,r,i)},format:n,formatGain:function(e,r,i="mixed_sc",a,o){e=new t(e),r=new t(r);let s=e.add(r).div(e);return s.gte(10)&&e.gte(1e100)?"(+"+n(s=s.log10().mul(20),a,o,i)+" OoMs/sec)":"(+"+n(r,a,o,i)+"/sec)"},formatTime:function e(r,i=2,a="s"){return(r=new t(r)).gte(86400)?n(r.div(86400).floor(),0,12,"sc")+":"+e(r.mod(86400),i,"d"):r.gte(3600)||"d"==a?(r.div(3600).gte(10)||"d"!=a?"":"0")+n(r.div(3600).floor(),0,12,"sc")+":"+e(r.mod(3600),i,"h"):r.gte(60)||"h"==a?(r.div(60).gte(10)||"h"!=a?"":"0")+n(r.div(60).floor(),0,12,"sc")+":"+e(r.mod(60),i,"m"):(r.gte(10)||"m"!=a?"":"0")+n(r,i,12,"sc")},formatTimeLong:function(e,r=!1,i=0,a=9,o="mixed_sc"){let s=t=>n(t,i,a,o),l=(e=new t(e)).mul(1e3).mod(1e3).floor(),u=e.mod(60).floor(),h=e.div(60).mod(60).floor(),c=e.div(3600).mod(24).floor(),f=e.div(86400).mod(365.2425).floor(),m=e.div(31556952).floor(),d=m.eq(1)?" year":" years",p=f.eq(1)?" day":" days",g=c.eq(1)?" hour":" hours",y=h.eq(1)?" minute":" minutes",N=u.eq(1)?" second":" seconds",b=l.eq(1)?" millisecond":" milliseconds";return`${m.gt(0)?s(m)+d+", ":""}${f.gt(0)?s(f)+p+", ":""}${c.gt(0)?s(c)+g+", ":""}${h.gt(0)?s(h)+y+", ":""}${u.gt(0)?s(u)+N+",":""}${r&&l.gt(0)?" "+s(l)+b:""}`.replace(/,([^,]*)$/,"$1").trim()},formatReduction:function(e){return e=new t(e),n(t.dOne.sub(e).mul(100))+"%"},formatPercent:function(e){return n((e=new t(e)).mul(100))+"%"},formatMult:function(e,r=2){return(e=new t(e)).gte(1)?"×"+e.format(r):"/"+e.pow(-1).format(r)},expMult:function(e,r,i=10){return t.gte(e,10)?t.pow(i,t.log(e,i).pow(r)):new t(e)},metric:a,ev:function(t,e=!1){return`${a(t,2)} ${a(t,1)}eV${e?"/c^2":""}`}};return{FORMATS:e,formats:o}}(q);q.formats=D;class R{get desc(){return this.description}get description(){return this.descriptionFn()}constructor(t){this.id=t.id,this.name=t.name??"",this.value=t.value,this.order=t.order??99,this.descriptionFn=t.description?"function"==typeof t.description?t.description:()=>t.description:()=>""}}class V{getBoosts(t,e){let r=[],i=[];for(let e=0;e<this.boostArray.length;e++)("string"==typeof t&&t===this.boostArray[e].id||t instanceof RegExp&&t.test(this.boostArray[e].id))&&(r.push(this.boostArray[e]),i.push(e));return e?[r,i]:r}getBoost(t){return this.getBoosts(t)[0]??null}removeBoost(t){for(let e=0;e<this.boostArray.length;e++)if(t===this.boostArray[e].id){this.boostArray.splice(e,1);break}}setBoost(t,e,r,i,n){if(t)if("string"==typeof t){let a=t,o=e??"",s=r??"",l=i??(t=>t),u=this.getBoosts(a,!0);u[0][0]?this.boostArray[u[1][0]]=new R({id:a,name:o,description:s,value:l,order:n}):this.boostArray.push(new R({id:a,name:o,description:s,value:l,order:n}))}else for(let e of t=Array.isArray(t)?t:[t]){let t=this.getBoosts(e.id,!0);t[0][0]?this.boostArray[t[1][0]]=new R(e):this.boostArray.push(new R(e))}}clearBoosts(){this.boostArray.length=0}calculate(t=this.baseEffect){let e=new q(t),r=this.boostArray;for(let t of r=r.sort(((t,e)=>t.order-e.order)))e=t.value(e);return e}constructor(t=1,e){this.addBoost=this.setBoost.bind(this),e=e?Array.isArray(e)?e:[e]:void 0,this.baseEffect=new q(t),this.boostArray=[],e&&e.forEach((t=>{this.boostArray.push(new R(t))}))}}function B(t,e,r="geometric"){switch(t=new q(t),e=new q(e),r){case"arithmetic":case 1:return t.add(e).div(2);case"geometric":case 2:default:return t.mul(e).sqrt();case"harmonic":case 3:return q.dTwo.div(t.reciprocal().add(e.reciprocal()));case"logarithmic":case 4:return q.pow(10,t.log10().mul(e.log10()).sqrt())}}function U(t,e,r={}){let{iterations:i,tolerance:n,lowerBound:a,upperBound:o,round:s,mode:l}=r;return Z(t,e,l,i,n,a,o,s)}function Z(t,e,r="geometric",i=30,n=.001,a=1,o=e,s=!1){if(a=new q(a),a=s?a.floor():a,o=new q(o),o=s?o.ceil():o,a.gt(o)&&([a,o]=[o,a]),t(o).eq(0))return{value:q.dZero,lowerBound:q.dZero,upperBound:q.dZero};if(t(a).gt(e))return console.warn("The interval does not contain the value. (f(lowerBound) > n)",{lowerBound:a,upperBound:o,n:e,"f(lowerBound)":t(a),"f(upperBound)":t(o)}),a.eq(0)?{value:o,lowerBound:o,upperBound:o}:Z(t,e,r,i,n,0,o,s);if(t(o).lt(e))return console.warn("The interval does not contain the value. (f(upperBound) < n)",{lowerBound:a,upperBound:o,n:e,"f(lowerBound)":t(a),"f(upperBound)":t(o)}),o.eq(e)?{value:o,lowerBound:o,upperBound:o}:Z(t,e,r,i,n,a,e,s);for(let n=0;n<i;n++){let i=B(a,o,r),n=t(i=s?i.floor():i);if(n.lt(e)?a=i:o=i,n.eq(e))return{value:i,lowerBound:i,upperBound:i};if(s&&o.sub(a).lte(5)){let r=o,i=t(o).sub(e).abs();for(let n=a;n.lte(o);n=n.add(1)){let a=t(n).sub(e).abs();a.lt(i)&&(r=new q(n),i=a)}return{value:r,lowerBound:a,upperBound:o}}}return{value:a,lowerBound:a,upperBound:o}}function Y(t,e,r=0,i,n){return r=new q(r),(e=new q(e)).sub(r).lte(30)?function(t,e,r=0,i=.001){let n=new q,a=new q(e);for(;a.gte(r);a=a.sub(1)){let e=n,r=t(a);n=n.add(r);let o=e.div(n);if(o.lte(1)&&o.gt(q.dOne.sub(i)))break}return n}(t,e,r,i):function(t,e,r=0,i=20){r=new q(r),e=new q(e);let n=q.dZero,a=e.sub(r).div(i);for(let e=i-1;e>=0;e--)n=n.add(t(r.add(a.mul(e))));return n.mul(a)}(t,e,r,n)}function $(t,e,r,i){var n,a=arguments.length,o=a<3?e:i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(o=(a<3?n(o):a>3?n(e,r,o):n(e,r))||o);return a>3&&o&&Object.defineProperty(e,r,o),o}class z{constructor(t){t=t??{},this.id=t.id,this.level=t.level?new q(t.level):q.dOne}}$([m(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",e)}(0,String)],z.prototype,"id",void 0),$([d((()=>q))],z.prototype,"level",void 0);class G{get data(){return this.dataPointerFn()}get description(){return this.descriptionFn(this.level,this,this.currencyPointerFn())}set description(t){this.descriptionFn="function"==typeof t?t:()=>t}get level(){return((this??{data:{level:q.dOne}}).data??{level:q.dOne}).level}set level(t){this.data.level=new q(t)}constructor(t,e,r,i){let n="function"==typeof e?e():e;this.dataPointerFn="function"==typeof e?e:()=>n,this.currencyPointerFn="function"==typeof r?r:()=>r,this.cache=new N(i??G.cacheSize),this.id=t.id,this.name=t.name??t.id,this.descriptionFn=t.description?"function"==typeof t.description?t.description:()=>t.description:()=>"",this.cost=t.cost,this.costBulk=t.costBulk,this.maxLevel=t.maxLevel,this.effect=t.effect,this.el=t.el,this.defaultLevel=t.level??q.dOne,this.bounds=t.bounds}}function H(t,e,r,i){var n,a=arguments.length,o=a<3?e:i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(o=(a<3?n(o):a>3?n(e,r,o):n(e,r))||o);return a>3&&o&&Object.defineProperty(e,r,o),o}G.cacheSize=15;class K{get data(){return this.dataPointerFn()}get description(){return this.descriptionFn(this.amount,this,this.currencyPointerFn())}set description(t){this.descriptionFn="function"==typeof t?t:()=>t}get amount(){return((this??{data:{amount:q.dOne}}).data??{amount:q.dOne}).amount}set amount(t){this.data.amount=new q(t)}constructor(t,e,r){this.defaultAmount=q.dZero;let i="function"==typeof e?e():e;this.dataPointerFn="function"==typeof e?e:()=>i,this.currencyPointerFn="function"==typeof r?r:()=>r,this.id=t.id,this.name=t.name??t.id,this.cost=t.cost,this.effect=t.effect,this.descriptionFn=t.description?"function"==typeof t.description?t.description:()=>t.description:()=>"",this.defaultAmount=t.amount??q.dZero}}class X{constructor(t){t=t??{},this.id=t.id,this.amount=t.amount??q.dZero}}function W(t,e,r,i){var n,a=arguments.length,o=a<3?e:i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(o=(a<3?n(o):a>3?n(e,r,o):n(e,r))||o);return a>3&&o&&Object.defineProperty(e,r,o),o}function J(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}H([m(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",e)}(0,String)],X.prototype,"id",void 0),H([d((()=>q))],X.prototype,"amount",void 0);class Q{constructor(){this.value=q.dZero,this.upgrades={},this.items={}}}W([d((()=>q)),J("design:type",void 0===q?Object:q)],Q.prototype,"value",void 0),W([d((()=>z)),J("design:type","undefined"==typeof Record?Object:Record)],Q.prototype,"upgrades",void 0),W([d((()=>X)),J("design:type","undefined"==typeof Record?Object:Record)],Q.prototype,"items",void 0);class tt{get pointer(){return this.pointerFn()}get value(){return this.pointer.value}set value(t){this.pointer.value=t}onLoadData(){for(let t of Object.values(this.upgrades))this.runUpgradeEffect(t)}reset(t,e,r){let i={resetCurrency:!0,resetUpgradeLevels:!0,resetItemAmounts:!0,runUpgradeEffect:!0};if("object"==typeof t?Object.assign(i,t):Object.assign(i,{resetCurrency:t,resetUpgradeLevels:e,runUpgradeEffect:r}),i.resetCurrency&&(this.value=this.defaultVal),i.resetUpgradeLevels)for(let t of Object.values(this.upgrades))t.level=new q(t.defaultLevel),i.runUpgradeEffect&&this.runUpgradeEffect(t);if(i.resetItemAmounts)for(let t of Object.values(this.items))t.amount=new q(t.defaultAmount),i.runUpgradeEffect&&this.runItemEffect(t)}gain(t=1e3){let e=this.boost.calculate().mul(new q(t).div(1e3));return this.pointer.value=this.pointer.value.add(e),e}pointerAddUpgrade(t){let e=new z(t);return this.pointer.upgrades[e.id]=e,e}pointerGetUpgrade(t){return this.pointer.upgrades[t]??null}getUpgrade(t){return this.upgrades[t]??null}queryUpgrade(t){let e=Object.keys(this.upgrades);if(t instanceof RegExp){let r=t;return e.filter((t=>r.test(t))).map((t=>this.upgrades[t]))}return"string"==typeof t&&(t=[t]),e.filter((e=>t.includes(e))).map((t=>this.upgrades[t]))}addUpgrade(t,e=!0){Array.isArray(t)||(t=[t]);let r=[];for(let i of t){this.pointerAddUpgrade(i);let t=new G(i,(()=>this.pointerGetUpgrade(i.id)),(()=>this));e&&this.runUpgradeEffect(t),this.upgrades[i.id]=t,r.push(t)}return r}updateUpgrade(t,e){let r=this.getUpgrade(t);null!==r&&Object.assign(r,e)}runUpgradeEffect(t){t.effect?.(t.level,t,this)}runItemEffect(t,e=q.dOne){e=new q(e),t.effect?.(t.amount,e,t,this)}calculateUpgrade(t,e=1/0,r,i){let n=this.getUpgrade(t);return null===n?(console.warn(`eMath.js: Upgrade "${t}" not found.`),[q.dZero,q.dZero]):(e=n.level.add(e),void 0!==n.maxLevel&&(e=q.min(e,n.maxLevel)),function(t,e,r,i=q.dInf,n,a,o=!1){t=new q(t),r=new q(r??e.level);let s=(i=new q(i)).sub(r);if(s.lt(0))return console.warn("eMath.js: Invalid target for calculateItem: ",s),[q.dZero,q.dZero];if(o=("function"==typeof e.el?e.el():e.el)??o,s.eq(1)){let r=e.cost(e.level),i=t.gte(r),n=[q.dZero,q.dZero];return o?(n[0]=i?q.dOne:q.dZero,n):n=[i?q.dOne:q.dZero,i?r:q.dZero]}if(e.costBulk){let[r,i]=e.costBulk(t,e.level,s),n=t.gte(i);return[n?r:q.dZero,n&&!o?i:q.dZero]}if(o)return[q.min(i,U((t=>e.cost(t.add(r))),t,{mode:n,iterations:a}).value.floor()),q.dZero];let l=U((t=>Y(e.cost,t,r)),t,{mode:n,iterations:a}).value.floor().min(r.add(s).sub(1)),u=Y(e.cost,l,r);return[l.sub(r).add(1).max(0),u]}(this.value,n,n.level,e,r,i))}getNextCost(t,e=1,r,i){let n=this.getUpgrade(t);if(null===n)return console.warn(`eMath.js: Upgrade "${t}" not found.`),q.dZero;let a=this.calculateUpgrade(t,e,r,i)[0];return n.cost(n.level.add(a))}getNextCostMax(t,e=1,r,i){let n=this.getUpgrade(t);if(null===n)return console.warn(`eMath.js: Upgrade "${t}" not found.`),q.dZero;let a=this.calculateUpgrade(t,e,r,i);return n.cost(n.level.add(a[0])).add(a[1])}buyUpgrade(t,e,r,i){let n=this.getUpgrade(t);if(null===n)return console.warn(`eMath.js: Upgrade "${t}" not found.`),!1;let[a,o]=this.calculateUpgrade(t,e,r,i);return!a.lte(0)&&(this.pointer.value=this.pointer.value.sub(o),n.level=n.level.add(a),this.runUpgradeEffect(n),!0)}pointerAddItem(t){let e=new X(t);return this.pointer.items[t.id]=e,e}pointerGetItem(t){return this.pointer.items[t]??null}addItem(t,e=!0){for(let r of(Array.isArray(t)||(t=[t]),t)){this.pointerAddItem(r);let t=new K(r,(()=>this.pointerGetItem(r.id)),(()=>this));e&&this.runItemEffect(t),this.items[r.id]=t}}getItem(t){return this.items[t]??null}calculateItem(t,e,r){let i=this.getItem(t);return null===i?(console.warn(`eMath.js: Item "${t}" not found.`),[q.dZero,q.dZero]):function(t,e,r=q.dOne,i=q.dInf){if(t=new q(t),r=new q(r),(i=new q(i)).lt(0))return console.warn("eMath.js: Invalid target for calculateItem: ",i),[q.dZero,q.dZero];if(i.eq(1)){let i=e.cost(r);return[t.gte(i)?q.dOne:q.dZero,t.gte(i)?i:q.dZero]}let n=t.div(e.cost(r)).floor().min(i);return[n,e.cost(r).mul(n)]}(this.value,i,e,r)}buyItem(t,e,r){let i=this.getItem(t);if(null===i)return console.warn(`eMath.js: Item "${t}" not found.`),!1;let[n,a]=this.calculateItem(t,e,r);return!n.lte(0)&&(this.pointer.value=this.pointer.value.sub(a),i.amount=i.amount.add(n),this.runItemEffect(i,e),!0)}constructor(t=new Q,e,r,i={defaultVal:q.dZero,defaultBoost:q.dOne}){this.defaultVal=i.defaultVal,this.defaultBoost=i.defaultBoost,this.pointerFn="function"==typeof t?t:()=>t,this.boost=new V(this.defaultBoost),this.pointer.value=this.defaultVal,this.upgrades={},e&&this.addUpgrade(e),this.items={},r&&this.addItem(r)}}class et{constructor(t=0){this.value=new q(t)}}!function(t,e,r,i){var n,a=arguments.length,o=a<3?e:i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(o=(a<3?n(o):a>3?n(e,r,o):n(e,r))||o);a>3&&o&&Object.defineProperty(e,r,o)}([d((()=>q)),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",e)}(0,void 0===q?Object:q)],et.prototype,"value",void 0);class rt{get pointer(){return this.pointerFn()}update(){console.warn("eMath.js: AttributeStatic.update is deprecated and will be removed in the future. The value is automatically updated when accessed."),this.boost&&(this.pointer.value=this.boost.calculate())}get value(){return this.boost&&(this.pointer.value=this.boost.calculate()),this.pointer.value}set value(t){if(this.boost)throw Error("Cannot set value of attributeStatic when boost is enabled.");this.pointer.value=t}constructor(t,e=!0,r=0){this.initial=new q(r),t??(t=new et(this.initial)),this.pointerFn="function"==typeof t?t:()=>t,this.boost=e?new V(this.initial):null}}class it{parse(t){return void 0===t?this.configOptionTemplate:function t(e,r){for(let i in r)void 0===e[i]?e[i]=r[i]:"object"!=typeof e[i]||"object"!=typeof r[i]||Array.isArray(e[i])||Array.isArray(r[i])||(e[i]=t(e[i],r[i]));return e}(t,this.configOptionTemplate)}get options(){return this.configOptionTemplate}constructor(t){this.configOptionTemplate=t}}let nt="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890 ".split("").concat(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"]);class at{changeFps(t){this.config.fps=t,this.tickerInterval&&(clearInterval(this.tickerInterval),this.tickerInterval=setInterval((()=>{for(let e of this.tickers)e(1e3/t)}),1e3/t))}logKey(t,e){let r=t.key;e&&!this.keysPressed.includes(r)?this.keysPressed.push(r):!e&&this.keysPressed.includes(r)&&this.keysPressed.splice(this.keysPressed.indexOf(r),1)}onAll(t,e){for(let r of this.binds)if(r.key===e)switch(t){case"down":r.onDown?.();break;case"press":default:r.onPress?.();break;case"up":r.onUp?.()}}isPressing(t){for(let e of this.binds)if(e.id===t)return this.keysPressed.includes(e.key);return!1}getBind(t){return this.binds.find((e=>e.id===t))}addKey(t,e,r){for(let i of t=Array.isArray(t="string"==typeof t?{id:t,name:t,key:e??"",fn:r}:t)?t:[t]){i.id=i.id??i.name;let t=this.getBind(i.id);t?Object.assign(t,i):this.binds.push(i)}}constructor(t){if(this.addKeys=this.addKey.bind(this),this.keysPressed=[],this.binds=[],this.tickers=[],this.config=at.configManager.parse(t),this.config.autoAddInterval){let t=this.config.fps?this.config.fps:30;this.tickerInterval=setInterval((()=>{for(let e of this.tickers)e(1e3/t)}),1e3/t)}"undefined"!=typeof document&&(this.tickers.push((t=>{for(let e of this.binds)(void 0!==e.onDownContinuous||void 0!==e.fn)&&this.isPressing(e.id)&&(e.onDownContinuous?.(t),e.fn?.(t))})),document.addEventListener("keydown",(t=>{this.logKey(t,!0),this.onAll("down",t.key)})),document.addEventListener("keyup",(t=>{this.logKey(t,!1),this.onAll("up",t.key)})),document.addEventListener("keypress",(t=>{this.onAll("press",t.key)})))}}at.configManager=new it({autoAddInterval:!0,fps:30});var ot,st=((ot=st||{}).interval="interval",ot.timeout="timeout",ot);class lt{on(t,e){this.callbackEvents[t]||(this.callbackEvents[t]=[]),this.callbackEvents[t].push({type:t,callback:e})}dispatch(t){if(this.callbackEvents[t])for(let e of this.callbackEvents[t])e.callback()}tickerFunction(){let t=Date.now();for(let e of Object.values(this.events))switch(e.type){case"interval":if(t-e.intervalLast>=e.delay){let r=t-e.intervalLast;e.callback(r),e.intervalLast=t}break;case"timeout":if(t-e.timeCreated>=e.delay){let r=t-e.timeCreated;e.callback(r),delete this.events[e.name]}}}changeFps(t){this.config.fps=t,this.tickerInterval&&(clearInterval(this.tickerInterval),this.tickerInterval=setInterval((()=>{this.tickerFunction()}),1e3/t))}timeWarp(t){for(let e of Object.values(this.events))switch(e.type){case"interval":e.intervalLast-=t;break;case"timeout":e.timeCreated-=t}}setEvent(t,e,r,i){let n={type:"timeout",delay:0,..."string"!=typeof t?t:{name:t,type:e,delay:r,callback:i},timeCreated:Date.now(),intervalLast:"interval"===e?Date.now():0};this.events[n.name]=n}removeEvent(t){delete this.events[t]}constructor(t,e){if(this.addEvent=this.setEvent.bind(this),this.config=lt.configManager.parse(t),this.events={},this.callbackEvents={},e)for(let t of e)this.callbackEvents[t]=[];if(this.config.autoAddInterval){let t=this.config.fps??30;this.tickerInterval=setInterval((()=>{this.tickerFunction()}),1e3/t)}}}lt.configManager=new it({autoAddInterval:!0,fps:30});var ut,ht={exports:{}};var ct=(ut||(ut=1,function(t){var e=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function n(t,e){if(!i[t]){i[t]={};for(var r=0;r<t.length;r++)i[t][t.charAt(r)]=r}return i[t][e]}var a={compressToBase64:function(t){if(null==t)return"";var r=a._compress(t,6,(function(t){return e.charAt(t)}));switch(r.length%4){default:case 0:return r;case 1:return r+"===";case 2:return r+"==";case 3:return r+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:a._decompress(t.length,32,(function(r){return n(e,t.charAt(r))}))},compressToUTF16:function(e){return null==e?"":a._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:a._decompress(t.length,16384,(function(e){return t.charCodeAt(e)-32}))},compressToUint8Array:function(t){for(var e=a.compress(t),r=new Uint8Array(2*e.length),i=0,n=e.length;i<n;i++){var o=e.charCodeAt(i);r[2*i]=o>>>8,r[2*i+1]=o%256}return r},decompressFromUint8Array:function(e){if(null==e)return a.decompress(e);for(var r=Array(e.length/2),i=0,n=r.length;i<n;i++)r[i]=256*e[2*i]+e[2*i+1];var o=[];return r.forEach((function(e){o.push(t(e))})),a.decompress(o.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":a._compress(t,6,(function(t){return r.charAt(t)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),a._decompress(t.length,32,(function(e){return n(r,t.charAt(e))})))},compress:function(e){return a._compress(e,16,(function(e){return t(e)}))},_compress:function(t,e,r){if(null==t)return"";var i,n,a,o={},s={},l="",u="",h="",c=2,f=3,m=2,d=[],p=0,g=0;for(a=0;a<t.length;a+=1)if(l=t.charAt(a),Object.prototype.hasOwnProperty.call(o,l)||(o[l]=f++,s[l]=!0),u=h+l,Object.prototype.hasOwnProperty.call(o,u))h=u;else{if(Object.prototype.hasOwnProperty.call(s,h)){if(256>h.charCodeAt(0)){for(i=0;i<m;i++)p<<=1,g==e-1?(g=0,d.push(r(p)),p=0):g++;for(i=0,n=h.charCodeAt(0);i<8;i++)p=p<<1|1&n,g==e-1?(g=0,d.push(r(p)),p=0):g++,n>>=1}else{for(i=0,n=1;i<m;i++)p=p<<1|n,g==e-1?(g=0,d.push(r(p)),p=0):g++,n=0;for(i=0,n=h.charCodeAt(0);i<16;i++)p=p<<1|1&n,g==e-1?(g=0,d.push(r(p)),p=0):g++,n>>=1}0==--c&&(c=Math.pow(2,m),m++),delete s[h]}else for(i=0,n=o[h];i<m;i++)p=p<<1|1&n,g==e-1?(g=0,d.push(r(p)),p=0):g++,n>>=1;0==--c&&(c=Math.pow(2,m),m++),o[u]=f++,h=String(l)}if(""!==h){if(Object.prototype.hasOwnProperty.call(s,h)){if(256>h.charCodeAt(0)){for(i=0;i<m;i++)p<<=1,g==e-1?(g=0,d.push(r(p)),p=0):g++;for(i=0,n=h.charCodeAt(0);i<8;i++)p=p<<1|1&n,g==e-1?(g=0,d.push(r(p)),p=0):g++,n>>=1}else{for(i=0,n=1;i<m;i++)p=p<<1|n,g==e-1?(g=0,d.push(r(p)),p=0):g++,n=0;for(i=0,n=h.charCodeAt(0);i<16;i++)p=p<<1|1&n,g==e-1?(g=0,d.push(r(p)),p=0):g++,n>>=1}0==--c&&(c=Math.pow(2,m),m++),delete s[h]}else for(i=0,n=o[h];i<m;i++)p=p<<1|1&n,g==e-1?(g=0,d.push(r(p)),p=0):g++,n>>=1;0==--c&&(c=Math.pow(2,m),m++)}for(i=0,n=2;i<m;i++)p=p<<1|1&n,g==e-1?(g=0,d.push(r(p)),p=0):g++,n>>=1;for(;;){if(p<<=1,g==e-1){d.push(r(p));break}g++}return d.join("")},decompress:function(t){return null==t?"":""==t?null:a._decompress(t.length,32768,(function(e){return t.charCodeAt(e)}))},_decompress:function(e,r,i){var n,a,o,s,l,u,h,c=[],f=4,m=4,d=3,p="",g=[],y={val:i(0),position:r,index:1};for(n=0;n<3;n+=1)c[n]=n;for(o=0,l=4,u=1;u!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),o|=(s>0?1:0)*u,u<<=1;switch(o){case 0:for(o=0,l=256,u=1;u!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),o|=(s>0?1:0)*u,u<<=1;h=t(o);break;case 1:for(o=0,l=65536,u=1;u!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),o|=(s>0?1:0)*u,u<<=1;h=t(o);break;case 2:return""}for(c[3]=h,a=h,g.push(h);;){if(y.index>e)return"";for(o=0,l=Math.pow(2,d),u=1;u!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),o|=(s>0?1:0)*u,u<<=1;switch(h=o){case 0:for(o=0,l=256,u=1;u!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),o|=(s>0?1:0)*u,u<<=1;c[m++]=t(o),h=m-1,f--;break;case 1:for(o=0,l=65536,u=1;u!=l;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=i(y.index++)),o|=(s>0?1:0)*u,u<<=1;c[m++]=t(o),h=m-1,f--;break;case 2:return g.join("")}if(0==f&&(f=Math.pow(2,d),d++),c[h])p=c[h];else{if(h!==m)return null;p=a+a.charAt(0)}g.push(p),c[m++]=a+p.charAt(0),a=p,0==--f&&(f=Math.pow(2,d),d++)}}};return a}();null!=t?t.exports=e:"undefined"!=typeof angular&&null!=angular&&angular.module("LZString",[]).factory("LZString",(function(){return e}))}(ht)),ht.exports);let ft={version:(()=>{try{return"9.6.0"}catch(t){return"9.5.0"}})(),"break_eternity.js":{version:"2.1.0"}};var mt,dt,pt,gt,yt,Nt,bt={exports:{}},vt={exports:{}};function wt(){return mt||(mt=1,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&e.rotl(t,8)|4278255360&e.rotl(t,24);for(var r=0;r<t.length;r++)t[r]=e.endian(t[r]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],r=0,i=0;r<t.length;r++,i+=8)e[i>>>5]|=t[r]<<24-i%32;return e},wordsToBytes:function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},bytesToHex:function(t){for(var e=[],r=0;r<t.length;r++)e.push((t[r]>>>4).toString(16)),e.push((15&t[r]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substr(r,2),16));return e},bytesToBase64:function(e){for(var r=[],i=0;i<e.length;i+=3)for(var n=e[i]<<16|e[i+1]<<8|e[i+2],a=0;a<4;a++)8*i+6*a<=8*e.length?r.push(t.charAt(n>>>6*(3-a)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],i=0,n=0;i<e.length;n=++i%4)0!=n&&r.push((t.indexOf(e.charAt(i-1))&Math.pow(2,-2*n+8)-1)<<2*n|t.indexOf(e.charAt(i))>>>6-2*n);return r}},vt.exports=e),vt.exports;var t,e}function Mt(){if(pt)return dt;pt=1;var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}}};return dt=t}var _t=function(){return Nt||(Nt=1,t=wt(),e=Mt().utf8,r=function(){if(yt)return gt;function t(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}return yt=1,gt=function(e){return null!=e&&(t(e)||"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))||!!e._isBuffer)}}(),i=Mt().bin,(n=function(a,o){a.constructor==String?a=o&&"binary"===o.encoding?i.stringToBytes(a):e.stringToBytes(a):r(a)?a=Array.prototype.slice.call(a,0):Array.isArray(a)||a.constructor===Uint8Array||(a=a.toString());for(var s=t.bytesToWords(a),l=8*a.length,u=1732584193,h=-271733879,c=-1732584194,f=271733878,m=0;m<s.length;m++)s[m]=16711935&(s[m]<<8|s[m]>>>24)|4278255360&(s[m]<<24|s[m]>>>8);s[l>>>5]|=128<<l%32,s[14+(l+64>>>9<<4)]=l;var d=n._ff,p=n._gg,g=n._hh,y=n._ii;for(m=0;m<s.length;m+=16){var N=u,b=h,v=c,w=f;u=d(u,h,c,f,s[m+0],7,-680876936),f=d(f,u,h,c,s[m+1],12,-389564586),c=d(c,f,u,h,s[m+2],17,606105819),h=d(h,c,f,u,s[m+3],22,-1044525330),u=d(u,h,c,f,s[m+4],7,-176418897),f=d(f,u,h,c,s[m+5],12,1200080426),c=d(c,f,u,h,s[m+6],17,-1473231341),h=d(h,c,f,u,s[m+7],22,-45705983),u=d(u,h,c,f,s[m+8],7,1770035416),f=d(f,u,h,c,s[m+9],12,-1958414417),c=d(c,f,u,h,s[m+10],17,-42063),h=d(h,c,f,u,s[m+11],22,-1990404162),u=d(u,h,c,f,s[m+12],7,1804603682),f=d(f,u,h,c,s[m+13],12,-40341101),c=d(c,f,u,h,s[m+14],17,-1502002290),u=p(u,h=d(h,c,f,u,s[m+15],22,1236535329),c,f,s[m+1],5,-165796510),f=p(f,u,h,c,s[m+6],9,-1069501632),c=p(c,f,u,h,s[m+11],14,643717713),h=p(h,c,f,u,s[m+0],20,-373897302),u=p(u,h,c,f,s[m+5],5,-701558691),f=p(f,u,h,c,s[m+10],9,38016083),c=p(c,f,u,h,s[m+15],14,-660478335),h=p(h,c,f,u,s[m+4],20,-405537848),u=p(u,h,c,f,s[m+9],5,568446438),f=p(f,u,h,c,s[m+14],9,-1019803690),c=p(c,f,u,h,s[m+3],14,-187363961),h=p(h,c,f,u,s[m+8],20,1163531501),u=p(u,h,c,f,s[m+13],5,-1444681467),f=p(f,u,h,c,s[m+2],9,-51403784),c=p(c,f,u,h,s[m+7],14,1735328473),u=g(u,h=p(h,c,f,u,s[m+12],20,-1926607734),c,f,s[m+5],4,-378558),f=g(f,u,h,c,s[m+8],11,-2022574463),c=g(c,f,u,h,s[m+11],16,1839030562),h=g(h,c,f,u,s[m+14],23,-35309556),u=g(u,h,c,f,s[m+1],4,-1530992060),f=g(f,u,h,c,s[m+4],11,1272893353),c=g(c,f,u,h,s[m+7],16,-155497632),h=g(h,c,f,u,s[m+10],23,-1094730640),u=g(u,h,c,f,s[m+13],4,681279174),f=g(f,u,h,c,s[m+0],11,-358537222),c=g(c,f,u,h,s[m+3],16,-722521979),h=g(h,c,f,u,s[m+6],23,76029189),u=g(u,h,c,f,s[m+9],4,-640364487),f=g(f,u,h,c,s[m+12],11,-421815835),c=g(c,f,u,h,s[m+15],16,530742520),u=y(u,h=g(h,c,f,u,s[m+2],23,-995338651),c,f,s[m+0],6,-198630844),f=y(f,u,h,c,s[m+7],10,1126891415),c=y(c,f,u,h,s[m+14],15,-1416354905),h=y(h,c,f,u,s[m+5],21,-57434055),u=y(u,h,c,f,s[m+12],6,1700485571),f=y(f,u,h,c,s[m+3],10,-1894986606),c=y(c,f,u,h,s[m+10],15,-1051523),h=y(h,c,f,u,s[m+1],21,-2054922799),u=y(u,h,c,f,s[m+8],6,1873313359),f=y(f,u,h,c,s[m+15],10,-30611744),c=y(c,f,u,h,s[m+6],15,-1560198380),h=y(h,c,f,u,s[m+13],21,1309151649),u=y(u,h,c,f,s[m+4],6,-145523070),f=y(f,u,h,c,s[m+11],10,-1120210379),c=y(c,f,u,h,s[m+2],15,718787259),h=y(h,c,f,u,s[m+9],21,-343485551),u=u+N>>>0,h=h+b>>>0,c=c+v>>>0,f=f+w>>>0}return t.endian([u,h,c,f])})._ff=function(t,e,r,i,n,a,o){var s=t+(e&r|~e&i)+(n>>>0)+o;return(s<<a|s>>>32-a)+e},n._gg=function(t,e,r,i,n,a,o){var s=t+(e&i|r&~i)+(n>>>0)+o;return(s<<a|s>>>32-a)+e},n._hh=function(t,e,r,i,n,a,o){var s=t+(e^r^i)+(n>>>0)+o;return(s<<a|s>>>32-a)+e},n._ii=function(t,e,r,i,n,a,o){var s=t+(r^(e|~i))+(n>>>0)+o;return(s<<a|s>>>32-a)+e},n._blocksize=16,n._digestsize=16,bt.exports=function(e,r){if(null==e)throw Error("Illegal argument "+e);var a=t.wordsToBytes(n(e,r));return r&&r.asBytes?a:r&&r.asString?i.bytesToString(a):t.bytesToHex(a)}),bt.exports;var t,e,r,i,n}(),It=r(_t);function Tt(t){return"object"==typeof t&&t?.constructor===Object}let St=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),Ot=Object.getOwnPropertyNames(new z({id:"",level:q.dZero})),xt=Object.getOwnPropertyNames(new X({id:"",amount:q.dZero}));class At{addEventOnLoad(t){this.eventsOnLoad.push(t)}setData(t,e){void 0===this.data[t]&&this.normalData&&console.warn("eMath.js: After initializing data, you should not add new properties to data."),this.data[t]=e;let r=()=>this.data;return{get value(){return r()[t]},set value(e){r()[t]=e},setValue(e){r()[t]=e}}}getData(t){return this.data[t]}setStatic(t,e){return console.warn("eMath.js: setStatic: Static data is basically useless and should not be used. Use variables in local scope instead."),void 0===this.static[t]&&this.normalData&&console.warn("eMath.js: After initializing data, you should not add new properties to staticData."),this.static[t]=e,this.static[t]}getStatic(t){return console.warn("eMath.js: Static data is basically useless and should not be used. Use variables in local scope instead."),this.static[t]}init(){this.normalData=this.data,this.normalDataPlain=g(this.data)}compileDataRaw(t=this.data){this.gameRef.eventManager.dispatch("beforeCompileData");let e=g(t);return[{hash:It(`${this.gameRef.config.name.id}/${JSON.stringify(e)}`),game:{title:this.gameRef.config.name.title,id:this.gameRef.config.name.id,version:this.gameRef.config.name.version},...ft},e]}compileData(t=this.data){return ct.compressToBase64(JSON.stringify(this.compileDataRaw(t)))}decompileData(t){if(!t){if(!this.localStorage)return console.warn("eMath.js: Local storage is not supported. Methods that rely on local storage will not work: decompileData() requires the data to be passed as an argument."),null;t=this.localStorage.getItem(`${this.gameRef.config.name.id}-data`)}if(!t)return null;try{return JSON.parse(ct.decompressFromBase64(t))}catch(e){if(!(e instanceof SyntaxError))throw e;return console.error(`Failed to decompile data (corrupted) "${t}":`,e),null}}validateData(t){let[e,r]=t;return"string"==typeof e?It(`${this.gameRef.config.name.id}/${JSON.stringify(r)}`)===e:e.hash===It(`${this.gameRef.config.name.id}/${JSON.stringify(r)}`)}resetData(t=!1){if(!this.normalData)throw Error("dataManager.resetData(): You must call init() before writing to data.");this.data=this.normalData,this.saveData(),t&&window.location.reload()}saveData(t=this.compileData()){if(this.gameRef.eventManager.dispatch("beforeSaveData"),!t)throw Error("dataManager.saveData(): Data to save is empty.");if(!this.localStorage)throw Error("dataManager.saveData(): Local storage is not supported. You can use compileData() instead to implement a custom save system.");this.localStorage.setItem(`${this.gameRef.config.name.id}-data`,t),this.gameRef.eventManager.dispatch("saveData")}exportData(){if("undefined"==typeof document)return void console.warn("eMath.js: exportData(): Document is not defined. You can use compileData() instead to implement a custom save system.");let t=this.compileData();if(null!=prompt("Download save data?:",t)){let e=new Blob([t],{type:"text/plain"}),r=document.createElement("a");r.href=URL.createObjectURL(e),r.download=`${this.gameRef.config.name.id}-data.txt`,r.textContent=`Download ${this.gameRef.config.name.id}-data.txt file`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}}parseData(t=this.decompileData(),e=!0){if((!this.normalData||!this.normalDataPlain)&&e)throw Error("dataManager.parseData(): You must call init() before writing to data.");if(!t)return null;let[,r]=t,i=e?function t(e,r,i){if(!e||!r||!i)return console.warn("eMath.js: dataManager.deepMerge(): Missing arguments:",e,r,i),i??{};for(let n in e)if(St(e,n)&&!St(i,n)&&(i[n]=e[n]),r[n]instanceof Q){let t=e[n],r=i[n];if(Array.isArray(r.upgrades)){let t=r.upgrades;for(let e of(r.upgrades={},t))r.upgrades[e.id]=e}r.upgrades={...t.upgrades,...r.upgrades},i[n]=r,r.items={...t.items,...r.items}}else Tt(e[n])&&Tt(i[n])&&(i[n]=t(e[n],r[n],i[n]));return i}(this.normalDataPlain,this.normalData,r):r;return function t(e,r){if(!e||!r)throw Error("dataManager.plainToInstanceRecursive(): Missing arguments.");for(let i in e){if(void 0===r[i]){console.warn(`eMath.js: Missing property "${i}" in loaded data.`);continue}if(!Tt(r[i]))continue;let n=e[i].constructor;n!==Object?r[i]=function(t,e){let r=y(t,e);if(r instanceof Q){for(let t in r.upgrades){let e=r.upgrades[t];e&&Ot.every((t=>Object.getOwnPropertyNames(e).includes(t)))?r.upgrades[t]=y(z,e):delete r.upgrades[t]}for(let t in r.items){let e=r.items[t];e&&xt.every((t=>Object.getOwnPropertyNames(e).includes(t)))?r.items[t]=y(X,e):delete r.items[t]}}if(!r)throw Error(`Failed to convert ${t.name} to class instance.`);return r}(n,r[i]):r[i]=t(e[i],r[i])}return r}(this.normalData,i)}loadData(t=this.decompileData()){if(!(t="string"==typeof t?this.decompileData(t):t))return null;let e=this.validateData([t[0],g(t[1])]),r=this.parseData(t);if(!r)return null;for(let t of(this.data=r,this.eventsOnLoad))t();return this.gameRef.eventManager.dispatch("loadData"),e}constructor(t,e){this.data={},this.static={},this.eventsOnLoad=[],this.gameRef="function"==typeof t?t():t,this.localStorage=e??("undefined"==typeof window?(console.warn("eMath.js: Local storage is not supported. Methods that rely on local storage will not work. You can use compileData() and decompileData() instead to implement a custom save system."),null):window.localStorage)}}class Et extends tt{get data(){return this.pointer}get static(){return this}constructor(t,e,r){if("function"==typeof t)throw Error("GameCurrency constructor does not accept a function as the first parameter. Use the <Game>.addCurrency method instead.");super(...t),this.game=e,this.name=r,this.game.dataManager.addEventOnLoad((()=>{this.static.onLoadData()}))}}class Ft extends rt{get data(){return this.pointer}get static(){return this}constructor(t,e){if("function"==typeof t)throw Error("GameAttribute constructor does not accept a function as the first parameter. Use the <Game>.addAttribute method instead.");super(...t),this.game=e}}class Ct{static fromObject(t){return new Ct(t.currenciesToReset,t.extender,t.onReset,t.condition)}reset(t=!1,e=!0,r=new Set){if(t||("function"==typeof this.condition?!this.condition(this):!this.condition)&&void 0!==this.condition)return;let i=()=>{this.onReset?.(this),this.currenciesToReset.forEach((t=>{t.static.reset()}))};0!==this.extender.length?(this.extender.forEach((i=>{r.has(i.id)||(r.add(i.id),i.reset(e||t,e,r))})),i()):i()}constructor(t,e,r,i){this.currenciesToReset=Array.isArray(t)?t:[t],e=e??[],this.extender=Array.isArray(e)?e:[e],this.onReset=r,this.condition=i,this.id=Symbol()}}let Pt={mode:"production",name:{title:"",id:"",version:"0.0.0"},settings:{framerate:30},initIntervalBasedManagers:!0,localStorage:void 0};class kt{init(){this.dataManager.init()}changeFps(t){this.keyManager.changeFps(t),this.eventManager.changeFps(t)}addCurrency(t,e=[],r=[]){return this.dataManager.setData(t,{currency:new Q}),new Et([()=>this.dataManager.getData(t).currency,e,r],this,t)}addAttribute(t,e=!0,r=0){return this.dataManager.setData(t,new et(r)),new Ft([this.dataManager.getData(t),e,r],this)}addReset(...t){return console.warn("eMath.js: Game.addReset is deprecated. Use the GameReset class instead."),new Ct(...t)}addResetFromObject(t){return console.warn("eMath.js: Game.addResetFromObject is deprecated. Use the GameReset.fromObject static method instead."),Ct.fromObject(t)}constructor(t){this.config=kt.configManager.parse(t),this.dataManager=new At(this,this.config.localStorage),this.keyManager=new at({autoAddInterval:this.config.initIntervalBasedManagers,fps:this.config.settings.framerate}),this.eventManager=new lt({autoAddInterval:this.config.initIntervalBasedManagers,fps:this.config.settings.framerate}),this.tickers=[]}}kt.configManager=new it(Pt),t.ConfigManager=it,t.DataManager=At,t.EventManager=lt,t.EventTypes=st,t.Game=kt,t.GameAttribute=Ft,t.GameCurrency=Et,t.GameReset=Ct,t.KeyManager=at,t.gameDefaultConfig=Pt,t.keys=nt}));
